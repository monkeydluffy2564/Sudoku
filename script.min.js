const _0x4f3d9d=_0x19c8;(function(_0xe51cd0,_0x377a48){const _0xaffb0f=_0x19c8,_0x23666b=_0xe51cd0();while(!![]){try{const _0x538b4f=parseInt(_0xaffb0f(0x162))/0x1+-parseInt(_0xaffb0f(0x15d))/0x2*(-parseInt(_0xaffb0f(0xf8))/0x3)+parseInt(_0xaffb0f(0x110))/0x4*(-parseInt(_0xaffb0f(0xf4))/0x5)+parseInt(_0xaffb0f(0x16e))/0x6*(parseInt(_0xaffb0f(0x1af))/0x7)+parseInt(_0xaffb0f(0x1c3))/0x8+parseInt(_0xaffb0f(0xed))/0x9*(-parseInt(_0xaffb0f(0x10b))/0xa)+parseInt(_0xaffb0f(0x1a8))/0xb*(-parseInt(_0xaffb0f(0xe3))/0xc);if(_0x538b4f===_0x377a48)break;else _0x23666b['push'](_0x23666b['shift']());}catch(_0x13d4e2){_0x23666b['push'](_0x23666b['shift']());}}}(_0x386a,0xddae7));import{initializeApp}from'https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js';import{getAuth,signInAnonymously,onAuthStateChanged}from'https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js';import{getFirestore,doc,getDoc,setDoc,updateDoc,onSnapshot,serverTimestamp,runTransaction,deleteDoc,deleteField,increment,collection}from'https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js';const firebaseConfig={'apiKey':_0x4f3d9d(0x1bf),'authDomain':'game24-69666.firebaseapp.com','projectId':_0x4f3d9d(0x135),'storageBucket':_0x4f3d9d(0xeb),'messagingSenderId':_0x4f3d9d(0x155),'appId':'1:989271279576:web:43115bbaeeae31160954ad','measurementId':'G-B1ZTE90SGG'},$=_0x366507=>document[_0x4f3d9d(0xe1)](_0x366507),$$=_0x3b5ba6=>Array[_0x4f3d9d(0x114)](document[_0x4f3d9d(0x185)](_0x3b5ba6)),playerJoinView=$(_0x4f3d9d(0x10c)),playerWaitView=$(_0x4f3d9d(0x189)),adminLobbyView=$(_0x4f3d9d(0x160)),gameView=$(_0x4f3d9d(0x17f)),adminLoginModal=$('#admin-login-modal'),adminSettingsModal=$(_0x4f3d9d(0x193)),gameOverView=$(_0x4f3d9d(0x163)),sudokuEl=$(_0x4f3d9d(0x187)),pickerEl=$(_0x4f3d9d(0x175)),playerList=$('#player-list'),lobbyPlayerNameList=$(_0x4f3d9d(0x13c)),lobbyPlayerCount=$(_0x4f3d9d(0xf3)),hostControls=$('#host-controls'),toastEl=$('#toast'),gameCodeDisplay=$('#game-code-display'),gameTimerEl=$(_0x4f3d9d(0x174)),puzzleProgressEl=$(_0x4f3d9d(0xff)),playerScoreDisplay=$(_0x4f3d9d(0x119)),gameBoard=$('#game-board'),playerFinishedView=$(_0x4f3d9d(0x184)),podiumContainer=$(_0x4f3d9d(0x1c2)),otherRankingsList=$(_0x4f3d9d(0x1bb)),otherRankingsContainer=$(_0x4f3d9d(0xef)),targetNumberDisplay=$(_0x4f3d9d(0x158));let db,auth,userId,currentPlayerName,isHost=![],currentGameId=null,unsubscribeGameListener=null,unsubscribePlayerStateListener=null,timerInterval=null,previousGameStatus=null,isPracticeMode=![],practicePuzzles=null,currentPracticeLevel=null,given=new Array(0x10)[_0x4f3d9d(0x126)](0x0),board=new Array(0x10)[_0x4f3d9d(0x126)](0x0),solution=new Array(0x10)[_0x4f3d9d(0x126)](0x0),selectedIdx=-0x1,hasMistake=![],gameSettings={'timeLimit':0x3c,'resultDisplayMode':_0x4f3d9d(0x138),'difficulty':_0x4f3d9d(0xf6),'numQuestions':0x1};function toast(_0x10b33a,_0xb22c0a=0x7d0){const _0x5edb68=_0x4f3d9d;toastEl['textContent']=_0x10b33a,toastEl[_0x5edb68(0x172)][_0x5edb68(0x17d)](_0x5edb68(0x12a)),setTimeout(()=>toastEl[_0x5edb68(0x172)]['remove']('show'),_0xb22c0a);}const rnd=(_0x536d8a,_0x581f60)=>Math[_0x4f3d9d(0x143)](Math['random']()*(_0x581f60-_0x536d8a+0x1))+_0x536d8a,themeKey=_0x4f3d9d(0x12d),themeSelect=$(_0x4f3d9d(0x1bd));function applyTheme(_0xa5fc05){const _0x22befa=_0x4f3d9d;document[_0x22befa(0x159)]['setAttribute'](_0x22befa(0x150),_0xa5fc05),localStorage['setItem'](themeKey,_0xa5fc05);}const savedTheme=localStorage[_0x4f3d9d(0xfd)](themeKey),initialTheme=savedTheme||_0x4f3d9d(0x18c);applyTheme(initialTheme);themeSelect&&themeSelect[_0x4f3d9d(0x19c)](_0x4f3d9d(0x15e),()=>applyTheme(themeSelect[_0x4f3d9d(0x124)]));function baseSolved(){return[0x1,0x2,0x3,0x4,0x3,0x4,0x1,0x2,0x2,0x1,0x4,0x3,0x4,0x3,0x2,0x1];}function shuffle(_0x6d7808){const _0x556599=_0x4f3d9d;for(let _0x4d6987=_0x6d7808[_0x556599(0x1b9)]-0x1;_0x4d6987>0x0;_0x4d6987--){const _0x24ac6c=Math['floor'](Math['random']()*(_0x4d6987+0x1));[_0x6d7808[_0x4d6987],_0x6d7808[_0x24ac6c]]=[_0x6d7808[_0x24ac6c],_0x6d7808[_0x4d6987]];}return _0x6d7808;}function applyPermutations(_0x1f88a3){const _0x27335e=_0x4f3d9d;let _0x39882f=_0x1f88a3['slice']();const _0xb8ba6f=(_0x1a255d,_0xd6a139)=>{for(let _0x10d3f2=0x0;_0x10d3f2<0x4;_0x10d3f2++){const _0x4b617a=_0x1a255d*0x4+_0x10d3f2,_0x25e4ac=_0xd6a139*0x4+_0x10d3f2;[_0x39882f[_0x4b617a],_0x39882f[_0x25e4ac]]=[_0x39882f[_0x25e4ac],_0x39882f[_0x4b617a]];}},_0x1dc3bb=(_0x10774e,_0x432ddb)=>{for(let _0x11affd=0x0;_0x11affd<0x4;_0x11affd++){const _0x4303cc=_0x11affd*0x4+_0x10774e,_0x31c0e7=_0x11affd*0x4+_0x432ddb;[_0x39882f[_0x4303cc],_0x39882f[_0x31c0e7]]=[_0x39882f[_0x31c0e7],_0x39882f[_0x4303cc]];}};if(Math['random']()<0.5)_0xb8ba6f(0x0,0x1);if(Math[_0x27335e(0x1a0)]()<0.5)_0xb8ba6f(0x2,0x3);if(Math[_0x27335e(0x1a0)]()<0.5)_0x1dc3bb(0x0,0x1);if(Math[_0x27335e(0x1a0)]()<0.5)_0x1dc3bb(0x2,0x3);if(Math[_0x27335e(0x1a0)]()<0.5)for(let _0x113e27=0x0;_0x113e27<0x4;_0x113e27++){const _0x302ea3=0x0*0x4+_0x113e27,_0x2f7a72=0x2*0x4+_0x113e27;[_0x39882f[_0x302ea3],_0x39882f[_0x2f7a72]]=[_0x39882f[_0x2f7a72],_0x39882f[_0x302ea3]];const _0xbba0dd=0x1*0x4+_0x113e27,_0x7d3e0f=0x3*0x4+_0x113e27;[_0x39882f[_0xbba0dd],_0x39882f[_0x7d3e0f]]=[_0x39882f[_0x7d3e0f],_0x39882f[_0xbba0dd]];}if(Math[_0x27335e(0x1a0)]()<0.5)for(let _0x253890=0x0;_0x253890<0x4;_0x253890++){const _0x5a8f4f=_0x253890*0x4+0x0,_0xb88e73=_0x253890*0x4+0x2;[_0x39882f[_0x5a8f4f],_0x39882f[_0xb88e73]]=[_0x39882f[_0xb88e73],_0x39882f[_0x5a8f4f]];const _0x681c6e=_0x253890*0x4+0x1,_0x573cec=_0x253890*0x4+0x3;[_0x39882f[_0x681c6e],_0x39882f[_0x573cec]]=[_0x39882f[_0x573cec],_0x39882f[_0x681c6e]];}const _0x4b95bd=[0x0,...shuffle([0x1,0x2,0x3,0x4])];for(let _0x4ef2b1=0x0;_0x4ef2b1<0x10;_0x4ef2b1++)_0x39882f[_0x4ef2b1]=_0x4b95bd[_0x39882f[_0x4ef2b1]];return _0x39882f;}function countSolutions(_0x594ec6){const _0x59fd65=_0x4f3d9d;let _0x1aabda=_0x594ec6[_0x59fd65(0x141)](),_0x8feef6=0x0;function _0x44f3cc(_0x1e8fe9,_0x3d8813){const _0x7f880b=_0x59fd65,_0x486d3b=Math[_0x7f880b(0x143)](_0x1e8fe9/0x4),_0x10704a=_0x1e8fe9%0x4;for(let _0x4650a5=0x0;_0x4650a5<0x4;_0x4650a5++){if(_0x1aabda[_0x486d3b*0x4+_0x4650a5]===_0x3d8813&&_0x4650a5!==_0x10704a)return![];if(_0x1aabda[_0x4650a5*0x4+_0x10704a]===_0x3d8813&&_0x4650a5!==_0x486d3b)return![];}const _0x27c288=Math['floor'](_0x486d3b/0x2)*0x2,_0x4af6d6=Math[_0x7f880b(0x143)](_0x10704a/0x2)*0x2;for(let _0x43cd48=_0x27c288;_0x43cd48<_0x27c288+0x2;_0x43cd48++)for(let _0x5bc8d9=_0x4af6d6;_0x5bc8d9<_0x4af6d6+0x2;_0x5bc8d9++){const _0x536a0b=_0x43cd48*0x4+_0x5bc8d9;if(_0x536a0b!==_0x1e8fe9&&_0x1aabda[_0x536a0b]===_0x3d8813)return![];}return!![];}function _0x1353d6(_0x1736ef=0x0){while(_0x1736ef<0x10&&_0x1aabda[_0x1736ef]!==0x0)_0x1736ef++;if(_0x1736ef===0x10)return _0x8feef6++,_0x8feef6;for(let _0x326875=0x1;_0x326875<=0x4;_0x326875++){if(_0x44f3cc(_0x1736ef,_0x326875)){_0x1aabda[_0x1736ef]=_0x326875,_0x1353d6(_0x1736ef+0x1);if(_0x8feef6>0x1)return _0x8feef6;_0x1aabda[_0x1736ef]=0x0;}}return _0x8feef6;}return _0x1353d6(0x0);}function makePuzzleByClues(_0x4db7b2,_0x21eaf1){const _0x5666d9=_0x4f3d9d;let _0x3b9af=_0x4db7b2['slice']();const _0x2eb8ff=shuffle([...Array(0x10)[_0x5666d9(0x129)]()]);let _0x11d98f=0x0;for(const _0x27c574 of _0x2eb8ff){if(0x10-_0x11d98f<=_0x21eaf1)break;const _0x5f1ea0=_0x3b9af[_0x27c574];_0x3b9af[_0x27c574]=0x0,countSolutions(_0x3b9af)!==0x1?_0x3b9af[_0x27c574]=_0x5f1ea0:_0x11d98f++;}return _0x3b9af;}function _0x19c8(_0x365d50,_0x2d510b){const _0x386a0e=_0x386a();return _0x19c8=function(_0x19c87,_0x4994a5){_0x19c87=_0x19c87-0xde;let _0x52be8e=_0x386a0e[_0x19c87];return _0x52be8e;},_0x19c8(_0x365d50,_0x2d510b);}function generateSudoku(_0x52e09a){const _0x2aa248=applyPermutations(baseSolved());let _0x3b531b={'easy':[0x9,0xa],'medium':[0x7,0x8],'hard':[0x5,0x6]}[_0x52e09a]||[0x7,0x8];const _0xcc273e=rnd(_0x3b531b[0x0],_0x3b531b[0x1]);let _0x27649e=makePuzzleByClues(_0x2aa248,_0xcc273e);if(countSolutions(_0x27649e)!==0x1)return generateSudoku(_0x52e09a);return{'solution':_0x2aa248,'puzzle':_0x27649e};}function cellClasses(_0x17b010){const _0xef70b1=_0x4f3d9d,_0x215e8c=Math[_0xef70b1(0x143)](_0x17b010/0x4),_0x47322f=_0x17b010%0x4,_0x1d6b3d=[];if(_0x47322f===0x1)_0x1d6b3d[_0xef70b1(0x144)]('bR');if(_0x215e8c===0x1)_0x1d6b3d['push']('bB');return _0x1d6b3d[_0xef70b1(0x14f)]('\x20');}function renderSudoku(){const _0x1ce3d7=_0x4f3d9d;sudokuEl[_0x1ce3d7(0x132)]='';for(let _0x55a0ef=0x0;_0x55a0ef<0x10;_0x55a0ef++){const _0x1dfa09=board[_0x55a0ef],_0x47e628=document[_0x1ce3d7(0x127)](_0x1ce3d7(0x15c));_0x47e628[_0x1ce3d7(0x107)]=_0x1ce3d7(0x111)+cellClasses(_0x55a0ef)+'\x20'+(given[_0x55a0ef]?_0x1ce3d7(0x120):''),_0x47e628['dataset'][_0x1ce3d7(0x1ac)]=_0x55a0ef,_0x47e628[_0x1ce3d7(0x192)]=_0x1dfa09?_0x1dfa09:'',!given[_0x55a0ef]&&_0x47e628['addEventListener'](_0x1ce3d7(0xe4),()=>selectCell(_0x55a0ef)),sudokuEl[_0x1ce3d7(0x10d)](_0x47e628);}if(selectedIdx>=0x0)highlightRelatives(selectedIdx);markConflictsAll(),updateProgressText();}function selectCell(_0x7c41d3){const _0x5a56de=_0x4f3d9d;selectedIdx=_0x7c41d3,$$(_0x5a56de(0x154))[_0x5a56de(0xf7)](_0x98c772=>_0x98c772[_0x5a56de(0x172)][_0x5a56de(0x102)](_0x5a56de(0x1c4),'hl'));const _0x1cbce0=$$(_0x5a56de(0x154))[_0x7c41d3];_0x1cbce0[_0x5a56de(0x172)][_0x5a56de(0x17d)]('selected'),highlightRelatives(_0x7c41d3);}function highlightRelatives(_0x1a5a41){const _0x3463ff=_0x4f3d9d,_0x2b0933=Math[_0x3463ff(0x143)](_0x1a5a41/0x4),_0x4240d6=_0x1a5a41%0x4;$$(_0x3463ff(0x154))[_0x3463ff(0xf7)]((_0xfc844,_0x5946ec)=>{const _0x6d61bd=_0x3463ff,_0x32791c=Math[_0x6d61bd(0x143)](_0x5946ec/0x4),_0x3f9779=_0x5946ec%0x4;(_0x32791c===_0x2b0933||_0x3f9779===_0x4240d6||Math[_0x6d61bd(0x143)](_0x32791c/0x2)===Math['floor'](_0x2b0933/0x2)&&Math[_0x6d61bd(0x143)](_0x3f9779/0x2)===Math[_0x6d61bd(0x143)](_0x4240d6/0x2))&&_0xfc844['classList'][_0x6d61bd(0x17d)]('hl');});}function setNumber(_0x1a4789){const _0x27a684=_0x4f3d9d;if(selectedIdx<0x0||given[selectedIdx])return;const _0x37e637=$$(_0x27a684(0x154))[selectedIdx];_0x37e637[_0x27a684(0x192)]=_0x1a4789?_0x1a4789:'',board[selectedIdx]=_0x1a4789;_0x1a4789!==0x0&&causesConflict(selectedIdx)&&(hasMistake=!![]);markConflictsAll(),updateProgressText(),scheduleBoardSync();if(isSolved())tryFinish();}function markConflictsAll(){const _0x3fbb4d=_0x4f3d9d;$$(_0x3fbb4d(0x154))[_0x3fbb4d(0xf7)](_0x2dbe8b=>_0x2dbe8b[_0x3fbb4d(0x172)][_0x3fbb4d(0x102)](_0x3fbb4d(0xfa),'ok'));for(let _0x3787f5=0x0;_0x3787f5<0x10;_0x3787f5++){if(board[_0x3787f5]!==0x0&&causesConflict(_0x3787f5))$$('.cell')[_0x3787f5]['classList']['add'](_0x3fbb4d(0xfa));else board[_0x3787f5]!==0x0&&$$(_0x3fbb4d(0x154))[_0x3787f5][_0x3fbb4d(0x172)][_0x3fbb4d(0x17d)]('ok');}}function causesConflict(_0x3aa727){const _0x3f4a99=_0x4f3d9d,_0x353b4b=board[_0x3aa727];if(_0x353b4b===0x0)return![];const _0x576b47=Math['floor'](_0x3aa727/0x4),_0x49d7a2=_0x3aa727%0x4;for(let _0x3f7f36=0x0;_0x3f7f36<0x4;_0x3f7f36++){if(_0x3f7f36!==_0x49d7a2&&board[_0x576b47*0x4+_0x3f7f36]===_0x353b4b)return!![];if(_0x3f7f36!==_0x576b47&&board[_0x3f7f36*0x4+_0x49d7a2]===_0x353b4b)return!![];}const _0x3c7c20=Math[_0x3f4a99(0x143)](_0x576b47/0x2)*0x2,_0x3c0cd0=Math[_0x3f4a99(0x143)](_0x49d7a2/0x2)*0x2;for(let _0x278b05=_0x3c7c20;_0x278b05<_0x3c7c20+0x2;_0x278b05++)for(let _0xbcfbce=_0x3c0cd0;_0xbcfbce<_0x3c0cd0+0x2;_0xbcfbce++){const _0x36c229=_0x278b05*0x4+_0xbcfbce;if(_0x36c229!==_0x3aa727&&board[_0x36c229]===_0x353b4b)return!![];}return![];}function isSolved(){for(let _0x1b43d0=0x0;_0x1b43d0<0x10;_0x1b43d0++)if(board[_0x1b43d0]!==solution[_0x1b43d0])return![];return!![];}function updateProgressText(){const _0x379693=_0x4f3d9d,_0x5e2010=board[_0x379693(0x136)](_0x264bdd=>_0x264bdd!==0x0)[_0x379693(0x1b9)];puzzleProgressEl['textContent']=_0x379693(0x182)+_0x5e2010+_0x379693(0x186);}pickerEl['addEventListener'](_0x4f3d9d(0xe4),_0x479d78=>{const _0xeff117=_0x4f3d9d,_0x1459f6=_0x479d78['target'][_0xeff117(0x17b)](_0xeff117(0xec));if(!_0x1459f6)return;setNumber(parseInt(_0x1459f6['dataset']['n'],0xa));}),document['addEventListener'](_0x4f3d9d(0x117),_0x310213=>{const _0x218bf8=_0x4f3d9d;if(selectedIdx<0x0)return;_0x310213[_0x218bf8(0x14c)]>='1'&&_0x310213['key']<='4'&&setNumber(parseInt(_0x310213[_0x218bf8(0x14c)],0xa));(_0x310213[_0x218bf8(0x14c)]===_0x218bf8(0x18f)||_0x310213[_0x218bf8(0x14c)]===_0x218bf8(0x1c0)||_0x310213[_0x218bf8(0x14c)]==='0')&&setNumber(0x0);const _0x53552c=Math[_0x218bf8(0x143)](selectedIdx/0x4),_0xacf339=selectedIdx%0x4;if(_0x310213['key']==='ArrowRight')selectCell(_0x53552c*0x4+Math[_0x218bf8(0x123)](_0xacf339+0x1,0x3));if(_0x310213[_0x218bf8(0x14c)]===_0x218bf8(0x19b))selectCell(_0x53552c*0x4+Math['max'](_0xacf339-0x1,0x0));if(_0x310213[_0x218bf8(0x14c)]===_0x218bf8(0x151))selectCell(Math[_0x218bf8(0x123)]((_0x53552c+0x1)*0x4+_0xacf339,0xf));if(_0x310213[_0x218bf8(0x14c)]===_0x218bf8(0x169))selectCell(Math['max']((_0x53552c-0x1)*0x4+_0xacf339,0x0));});async function initialize(){const _0x38ecff=_0x4f3d9d;try{const _0x246b08=initializeApp(firebaseConfig);db=getFirestore(_0x246b08),auth=getAuth(_0x246b08),onAuthStateChanged(auth,async _0x5f28bd=>{!_0x5f28bd&&await signInAnonymously(auth);});}catch(_0x23e980){console[_0x38ecff(0x104)](_0x38ecff(0x1ab),_0x23e980),toast('การเชื่อมต่อล้มเหลว');}}function showView(_0x24e861){const _0x4329b6=_0x4f3d9d;[playerJoinView,playerWaitView,adminLoginModal,adminLobbyView,gameView,gameOverView,adminSettingsModal][_0x4329b6(0xf7)](_0x420714=>_0x420714['classList'][_0x4329b6(0x17d)](_0x4329b6(0xf5)));const _0xb95e83=$('#admin-icon-btn');if(_0x24e861===_0x4329b6(0xe8)||_0x24e861===_0x4329b6(0x171))_0xb95e83['classList'][_0x4329b6(0x102)]('hidden');else isHost?_0xb95e83[_0x4329b6(0x172)]['remove'](_0x4329b6(0xf5)):_0xb95e83[_0x4329b6(0x172)][_0x4329b6(0x17d)](_0x4329b6(0xf5));if(_0x24e861==='player-join')playerJoinView['classList'][_0x4329b6(0x102)](_0x4329b6(0xf5));else{if(_0x24e861===_0x4329b6(0x13d))playerWaitView[_0x4329b6(0x172)][_0x4329b6(0x102)](_0x4329b6(0xf5));else{if(_0x24e861===_0x4329b6(0x171))adminLoginModal[_0x4329b6(0x172)][_0x4329b6(0x102)](_0x4329b6(0xf5));else{if(_0x24e861===_0x4329b6(0x10f))adminLobbyView[_0x4329b6(0x172)]['remove'](_0x4329b6(0xf5));else{if(_0x24e861===_0x4329b6(0x18e))adminSettingsModal[_0x4329b6(0x172)][_0x4329b6(0x102)](_0x4329b6(0xf5));else{if(_0x24e861===_0x4329b6(0x179))gameView['classList']['remove'](_0x4329b6(0xf5));else{if(_0x24e861===_0x4329b6(0x18b))gameOverView[_0x4329b6(0x172)]['remove'](_0x4329b6(0xf5));}}}}}}}async function createGameRoom(){const _0x1797be=_0x4f3d9d;isHost=!![],document[_0x1797be(0x17c)]['classList'][_0x1797be(0x102)](_0x1797be(0x1a1)),showView('admin-lobby'),gameCodeDisplay[_0x1797be(0x192)]=_0x1797be(0x1b7);const _0x4362df=rnd(0xa,0x63)[_0x1797be(0x130)]();currentGameId=_0x4362df;const _0x256074={'hostId':auth[_0x1797be(0x1ae)][_0x1797be(0x157)],'status':_0x1797be(0x161),'players':{},'createdAt':serverTimestamp()};await setDoc(doc(db,'games',currentGameId),_0x256074),gameCodeDisplay[_0x1797be(0x192)]=currentGameId,listenForGameUpdates(currentGameId);}async function handleStartGame(){const _0x2dc906=_0x4f3d9d;if(!isHost||!currentGameId)return;gameSettings[_0x2dc906(0x12c)]=document[_0x2dc906(0xe1)](_0x2dc906(0x1b2))[_0x2dc906(0x124)],gameSettings[_0x2dc906(0x180)]=Math[_0x2dc906(0x18a)](0xa,parseInt($('#time-limit-input')['value']||'60',0xa)),gameSettings[_0x2dc906(0x13f)]=$(_0x2dc906(0x166))['value'];const _0x5ef82b=doc(db,_0x2dc906(0x1c1),currentGameId);try{await runTransaction(db,async _0x48078a=>{const _0x3b075f=_0x2dc906,_0x4f0ec4=await _0x48078a[_0x3b075f(0x1b3)](_0x5ef82b);if(!_0x4f0ec4[_0x3b075f(0x188)]())throw'Game\x20does\x20not\x20exist!';const _0xf78631=_0x4f0ec4[_0x3b075f(0x1c6)]()['players']||{},_0x5468bb={'status':_0x3b075f(0x167),'startTime':serverTimestamp(),'gameMode':gameSettings};if(gameSettings[_0x3b075f(0x13f)]===_0x3b075f(0x11e)){gameSettings[_0x3b075f(0x11c)]=0x3;const _0x975fc4=generateSudoku('easy'),_0x391744=generateSudoku(_0x3b075f(0xf6)),_0x25c1f0=generateSudoku(_0x3b075f(0x1aa));_0x5468bb[_0x3b075f(0x1a7)]={'easy':_0x975fc4,'medium':_0x391744,'hard':_0x25c1f0};}else gameSettings[_0x3b075f(0x11c)]=0x1,_0x5468bb[_0x3b075f(0x1b4)]=generateSudoku(gameSettings[_0x3b075f(0x13f)]);for(const _0x265f1c in _0xf78631){_0x5468bb[_0x3b075f(0xe9)+_0x265f1c+_0x3b075f(0x11a)]=0x0,_0x5468bb[_0x3b075f(0xe9)+_0x265f1c+_0x3b075f(0x19e)]=null,_0x5468bb[_0x3b075f(0xe9)+_0x265f1c+_0x3b075f(0x137)]=0x0;const _0x101e43=doc(db,_0x3b075f(0x1c1),currentGameId,_0x3b075f(0xe0),_0x265f1c);let _0x1b6fd2,_0x3bf8b8;gameSettings[_0x3b075f(0x13f)]==='mixed'?(_0x1b6fd2=_0x5468bb['puzzles']['easy']['puzzle'],_0x5468bb[_0x3b075f(0xe9)+_0x265f1c+_0x3b075f(0x131)]='easy'):_0x1b6fd2=_0x5468bb[_0x3b075f(0x1b4)]['puzzle'];_0x3bf8b8=_0x1b6fd2[_0x3b075f(0x136)](_0x4c24ff=>_0x4c24ff!==0x0)[_0x3b075f(0x1b9)],_0x5468bb['players.'+_0x265f1c+_0x3b075f(0x137)]=_0x3bf8b8;const _0x530cc2={'board':_0x1b6fd2[_0x3b075f(0x14f)](''),'hasMistake':![]};_0x48078a[_0x3b075f(0x1a3)](_0x101e43,_0x530cc2);}_0x48078a['update'](_0x5ef82b,_0x5468bb);}),showView(_0x2dc906(0x179));}catch(_0x4c740b){console[_0x2dc906(0x104)]('Error\x20starting\x20game:',_0x4c740b),toast(_0x2dc906(0x17a));}}function startPracticeGame(){const _0x561976=_0x4f3d9d;isPracticeMode=!![],gameSettings[_0x561976(0x180)]=Math[_0x561976(0x18a)](0xa,parseInt($('#time-limit-input')['value']||'60',0xa)),gameSettings[_0x561976(0x13f)]=$(_0x561976(0x166))['value'],document[_0x561976(0x17c)][_0x561976(0x172)][_0x561976(0x17d)](_0x561976(0x1a1)),hostControls[_0x561976(0x172)][_0x561976(0x17d)](_0x561976(0xf5)),playerScoreDisplay['classList'][_0x561976(0x17d)]('hidden'),$(_0x561976(0x178))['classList'][_0x561976(0x17d)]('hidden');if(gameSettings['difficulty']===_0x561976(0x11e))practicePuzzles={'easy':generateSudoku('easy'),'medium':generateSudoku(_0x561976(0xf6)),'hard':generateSudoku(_0x561976(0x1aa))},currentPracticeLevel=_0x561976(0x198),loadPracticePuzzle(currentPracticeLevel);else{practicePuzzles=null,currentPracticeLevel=gameSettings['difficulty'];const _0x504269=generateSudoku(gameSettings[_0x561976(0x13f)]);given=_0x504269['puzzle'][_0x561976(0x141)](),board=_0x504269['puzzle'][_0x561976(0x141)](),solution=_0x504269[_0x561976(0x145)][_0x561976(0x141)](),targetNumberDisplay[_0x561976(0x192)]=_0x561976(0x14b)+gameSettings[_0x561976(0x13f)];}hasMistake=![],selectedIdx=board[_0x561976(0x10a)]((_0x5b6b8d,_0x338deb)=>!given[_0x338deb]);if(selectedIdx<0x0)selectedIdx=0x0;showView('game'),gameBoard[_0x561976(0x172)][_0x561976(0x102)](_0x561976(0xf5)),playerFinishedView[_0x561976(0x172)][_0x561976(0x17d)](_0x561976(0xf5)),pickerEl['classList'][_0x561976(0x102)](_0x561976(0xf5)),$(_0x561976(0x115))['classList']['remove'](_0x561976(0xf5)),$(_0x561976(0x168))[_0x561976(0x172)][_0x561976(0x102)](_0x561976(0xf5)),renderSudoku(),startPracticeTimer();}function loadPracticePuzzle(_0x18ef54){const _0x595180=_0x4f3d9d,_0x4bff92=practicePuzzles[_0x18ef54];given=_0x4bff92[_0x595180(0x140)][_0x595180(0x141)](),board=_0x4bff92[_0x595180(0x140)][_0x595180(0x141)](),solution=_0x4bff92[_0x595180(0x145)]['slice'](),hasMistake=![],selectedIdx=board[_0x595180(0x10a)]((_0x46f8c6,_0x38d648)=>!given[_0x38d648]);if(selectedIdx<0x0)selectedIdx=0x0;targetNumberDisplay[_0x595180(0x192)]=_0x595180(0x14b)+_0x18ef54,renderSudoku();}function startPracticeTimer(){const _0x2a3567=_0x4f3d9d;if(timerInterval)clearInterval(timerInterval);let _0x1c55b0=gameSettings[_0x2a3567(0x180)];const _0x44d5d8=()=>{const _0x4dbf55=_0x2a3567,_0x1546c9=String(Math['floor'](_0x1c55b0/0x3c))[_0x4dbf55(0xfc)](0x2,'0'),_0x4d81bf=String(_0x1c55b0%0x3c)['padStart'](0x2,'0');gameTimerEl[_0x4dbf55(0x192)]=_0x4dbf55(0x148)+_0x1546c9+':'+_0x4d81bf;};_0x44d5d8(),timerInterval=setInterval(()=>{const _0x5ccb60=_0x2a3567;_0x1c55b0--,_0x44d5d8(),_0x1c55b0<=0x0&&(clearInterval(timerInterval),gameBoard[_0x5ccb60(0x172)][_0x5ccb60(0x17d)](_0x5ccb60(0xf5)),playerFinishedView[_0x5ccb60(0x172)][_0x5ccb60(0x102)](_0x5ccb60(0xf5)),$(_0x5ccb60(0x15b))[_0x5ccb60(0x192)]='หมดเวลา!',$(_0x5ccb60(0x113))[_0x5ccb60(0x192)]=_0x5ccb60(0x181));},0x3e8);}async function forceEndGame(){const _0x954154=_0x4f3d9d;if(!isHost||!currentGameId)return;const _0x2fb74f=doc(db,_0x954154(0x1c1),currentGameId),_0x316f58=await getDoc(_0x2fb74f);_0x316f58[_0x954154(0x188)]()&&_0x316f58['data']()[_0x954154(0x18d)]===_0x954154(0x167)&&await updateDoc(_0x2fb74f,{'status':_0x954154(0xee),'winner':null});}async function returnToLobby(){const _0x87fe5=_0x4f3d9d;if(!isHost||!currentGameId)return;const _0x257320=doc(db,_0x87fe5(0x1c1),currentGameId);try{await updateDoc(_0x257320,{'status':_0x87fe5(0x161),'players':{},'winner':deleteField(),'sudoku':deleteField(),'puzzles':deleteField(),'startTime':deleteField(),'gameMode':deleteField()}),showView(_0x87fe5(0x10f));}catch(_0x1d5658){console['error'](_0x87fe5(0x1ba),_0x1d5658),toast(_0x87fe5(0x165));}}async function handleJoinGame(){const _0x7e1879=_0x4f3d9d,_0xfffdd9=$('#game-code-input')[_0x7e1879(0x124)],_0x267614=$(_0x7e1879(0x1a2))[_0x7e1879(0x124)][_0x7e1879(0x183)]();if(!_0xfffdd9||!_0x267614)return toast(_0x7e1879(0xe6));currentGameId=_0xfffdd9,currentPlayerName=_0x267614;const _0xb8e740=doc(db,_0x7e1879(0x1c1),currentGameId);try{await runTransaction(db,async _0x4d1027=>{const _0x446249=_0x7e1879,_0x27d390=await _0x4d1027[_0x446249(0x1b3)](_0xb8e740);if(!_0x27d390[_0x446249(0x188)]())throw new Error(_0x446249(0x177));const _0x2bc06e=_0x27d390[_0x446249(0x1c6)]();if(_0x2bc06e[_0x446249(0x18d)]!==_0x446249(0x161))throw new Error('ไม่สามารถเข้าร่วมได้\x20เกมเริ่มไปแล้ว');let _0x50e7c1=_0x267614;_0x2bc06e[_0x446249(0x109)]&&_0x2bc06e[_0x446249(0x109)][_0x50e7c1]&&(_0x50e7c1=''+_0x267614+rnd(0xa,0x63),toast('ชื่อซ้ำ,\x20เปลี่ยนเป็น\x20'+_0x50e7c1+_0x446249(0x153))),currentPlayerName=_0x50e7c1,_0x4d1027[_0x446249(0x190)](_0xb8e740,{['players.'+_0x50e7c1]:{'joined':!![]}});}),isHost=![],document[_0x7e1879(0x17c)][_0x7e1879(0x172)][_0x7e1879(0x17d)](_0x7e1879(0x1a1)),toast(_0x7e1879(0x11f)),listenForGameUpdates(currentGameId);}catch(_0x387993){console[_0x7e1879(0x104)]('Error\x20joining\x20game:',_0x387993),toast(_0x387993[_0x7e1879(0x106)]);}}function listenForGameUpdates(_0x8fe39d){if(unsubscribeGameListener)unsubscribeGameListener();const _0xe14a6c=doc(db,'games',_0x8fe39d);unsubscribeGameListener=onSnapshot(_0xe14a6c,_0x902fae=>{const _0x4be711=_0x19c8;if(!_0x902fae[_0x4be711(0x188)]()){toast(_0x4be711(0x16b));if(unsubscribeGameListener)unsubscribeGameListener();if(unsubscribePlayerStateListener)unsubscribePlayerStateListener();timerInterval&&(clearInterval(timerInterval),timerInterval=null);isHost=![],document[_0x4be711(0x17c)][_0x4be711(0x172)][_0x4be711(0x102)]('player-view'),showView(_0x4be711(0xe8));return;}const _0x15de2a=_0x902fae['data'](),_0x2b243b=_0x15de2a[_0x4be711(0x18d)];if(!isHost&&previousGameStatus===_0x4be711(0xee)&&_0x2b243b===_0x4be711(0x161)){if(unsubscribeGameListener)unsubscribeGameListener();if(unsubscribePlayerStateListener)unsubscribePlayerStateListener();if(timerInterval)clearInterval(timerInterval);currentGameId=null,currentPlayerName=null,toast(_0x4be711(0x14a)),document[_0x4be711(0x17c)][_0x4be711(0x172)][_0x4be711(0x102)](_0x4be711(0x1a1)),showView(_0x4be711(0xe8)),previousGameStatus=null;return;}previousGameStatus=_0x2b243b;if(_0x2b243b===_0x4be711(0x161)){timerInterval&&(clearInterval(timerInterval),timerInterval=null);if(unsubscribePlayerStateListener)unsubscribePlayerStateListener();if(isHost)showView(_0x4be711(0x10f)),renderLobbyPlayers(_0x15de2a[_0x4be711(0x109)]);else showView(_0x4be711(0x13d));}else{if(_0x2b243b===_0x4be711(0x167)){startOrUpdateTimer(_0x15de2a),showView(_0x4be711(0x179));if(isHost){renderAdminGameView(_0x15de2a);if(_0x15de2a[_0x4be711(0x19a)][_0x4be711(0x12c)]===_0x4be711(0x15f)){const _0x2c6324=Object[_0x4be711(0x19d)](_0x15de2a[_0x4be711(0x109)]||{});_0x2c6324['length']>0x0&&_0x2c6324[_0x4be711(0x12e)](_0x34ee18=>_0x34ee18[_0x4be711(0x1bc)])&&forceEndGame();}}else renderPlayerGameView(_0x15de2a),listenForPlayerState(_0x8fe39d,currentPlayerName);}else{if(_0x2b243b===_0x4be711(0xee)){timerInterval&&(clearInterval(timerInterval),timerInterval=null);if(unsubscribePlayerStateListener)unsubscribePlayerStateListener();renderGameOverView(_0x15de2a);}}}});}function listenForPlayerState(_0x23f700,_0x4b479a){const _0x3be0bf=_0x4f3d9d;if(unsubscribePlayerStateListener)return;const _0x20d539=doc(db,'games',_0x23f700,_0x3be0bf(0xe0),_0x4b479a);unsubscribePlayerStateListener=onSnapshot(_0x20d539,_0x39cd0a=>{const _0x5a869e=_0x3be0bf;if(_0x39cd0a[_0x5a869e(0x188)]()){const _0x421cf8=_0x39cd0a['data']();board=(_0x421cf8[_0x5a869e(0x112)]||'')[_0x5a869e(0x1b1)]('')[_0x5a869e(0x197)](_0xc2a6ec=>parseInt(_0xc2a6ec,0xa)||0x0),hasMistake=!!_0x421cf8['hasMistake'],renderSudoku();}});}function renderLobbyPlayers(_0x9f302){const _0x4bc9da=_0x4f3d9d,_0x154390=Object[_0x4bc9da(0x129)](_0x9f302||{});lobbyPlayerCount['textContent']=_0x154390[_0x4bc9da(0x1b9)],lobbyPlayerNameList['innerHTML']=_0x154390['length']===0x0?_0x4bc9da(0x173):_0x154390['map'](_0x8d0349=>_0x4bc9da(0x11d)+_0x8d0349+'</div>')['join']('');}function startOrUpdateTimer(_0x11b222){const _0x3e66e3=_0x4f3d9d;if(timerInterval)clearInterval(timerInterval);const _0x1406bd=_0x11b222[_0x3e66e3(0x19a)]||gameSettings,_0x56718e=_0x11b222[_0x3e66e3(0xfe)][_0x3e66e3(0x1c5)]();timerInterval=setInterval(()=>{const _0x1b0709=_0x3e66e3,_0x14e169=Math[_0x1b0709(0x143)]((Date[_0x1b0709(0xf1)]()-_0x56718e)/0x3e8),_0x56a12d=_0x1406bd[_0x1b0709(0x180)]-_0x14e169;if(_0x56a12d<=0x0){clearInterval(timerInterval),gameTimerEl[_0x1b0709(0x192)]='เวลา:\x2000:00';if(isHost)forceEndGame();}else{const _0x4a5860=String(Math['floor'](_0x56a12d/0x3c))[_0x1b0709(0xfc)](0x2,'0'),_0xcda1e3=String(_0x56a12d%0x3c)[_0x1b0709(0xfc)](0x2,'0');gameTimerEl['textContent']=_0x1b0709(0x148)+_0x4a5860+':'+_0xcda1e3;}},0x1f4);}function _0x386a(){const _0x4235c7=['#game-view','timeLimit','ลองใหม่อีกครั้งนะ','เติมแล้ว\x20','trim','#player-finished-view','querySelectorAll','/16','#sudoku','exists','#player-wait-view','max','game-over','contrast','status','admin-settings','Backspace','update','currentLevel','textContent','#admin-settings-modal','filled','<i\x20class=\x22fas\x20fa-crown\x22></i>','#back-to-lobby-btn','map','easy','เสร็จแล้ว!','gameMode','ArrowLeft','addEventListener','values','.finishTime','sort','random','player-view','#player-name-input','set','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22player-score\x22>','entries','log','puzzles','925573vJsOSQ','รอผลการแข่งขันสักครู่...','hard','Firebase\x20init\x20failed:','idx','\x20คะแนน</span></li>','currentUser','2291086FXcBOL','pointerEvents','split','input[name=\x22resultDisplayMode\x22]:checked','get','sudoku','includes','คุณไขปริศนาสำเร็จ','...','indexOf','length','Error\x20returning\x20to\x20lobby:','#other-rankings-list','finishTime','#themeSelect','#admin-login-btn','AIzaSyAJsk4l8I8uCYpJY8jZLAlRW1w2qLWN-2o','Delete','games','#podium-container','1131616ZEnjGs','selected','toMillis','data','</strong></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>เวลาที่ใช้:\x20<strong\x20class=\x22text-xl\x22\x20style=\x22color:\x20var(--accent);\x22>','#competition-settings','playerStates','querySelector','#join-game-btn','180kZTDbG','click','<i\x20class=\x22fas\x20fa-trophy\x20mr-2\x22></i>หมดเวลา!','กรุณากรอกข้อมูลให้ครบถ้วน','#results-header','player-join','players.','beforeunload','game24-69666.firebasestorage.app','.pick','1183464MHEpBw','finished','#other-rankings-container','\x20คะแนน\x20(','now','#start-game-btn','#lobby-player-count','140VdeYtI','hidden','medium','forEach','3cXGaqa','replace','conflict','เยี่ยมมาก!','padStart','getItem','startTime','#puzzle-progress','</div>','podium-stand\x20podium-','remove','#start-practice-btn','error','warn','message','className','<li><span>','players','findIndex','10asahvi','#player-join-view','appendChild','Sudoku\x204x4','admin-lobby','167380aHrEvk','cell\x20','board','#player-finished-view\x20p','from','#reset-btn','board\x20sync\x20failed','keydown','none','#player-score-display','.score','#sudoku\x20.cell','numQuestions','<div\x20class=\x22lobby-player-tag\x22>','mixed','เข้าร่วมสำเร็จ!\x20รอสักครู่...','given','<i\x20class=\x22fas\x20fa-play\x20mr-2\x22></i>เริ่มฝึกซ้อม','</span><span\x20class=\x22player-progress\x22>','min','value','Transaction\x20aborted,\x20likely\x20because\x20another\x20player\x20finished\x20first.','fill','createElement','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22text-lg\x20mt-4\x22>คะแนนรอบนี้:</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22text-4xl\x20font-bold\x22\x20style=\x22color:\x20var(--accent);\x22>','keys','show','#admin-icon-btn','resultDisplayMode','g24_theme_mp','every','<i\x20class=\x22fas\x20fa-play\x20mr-2\x22></i>เริ่มแข่งขัน','toString','.currentLevel','innerHTML','target','รหัสผ่านไม่ถูกต้อง','game24-69666','filter','.filled','immediate','#end-game-btn','ด่าน\x20','#time-limit-input','#lobby-player-name-list','player-wait','#open-settings-btn','difficulty','puzzle','slice','single','floor','push','solution','เสร็จแล้ว','<div\x20class=\x22player-row\x22><span\x20class=\x22player-name\x22>','เวลา:\x20','score','แอดมินได้สร้างห้องใหม่แล้ว','ฝึกซ้อม:\x20','key','#admin-password-input','sidebar-hidden','join','data-theme','ArrowDown','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22player-name\x22>','\x20แทน','.cell','989271279576','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','uid','#target-number-display','documentElement','.app','#player-finished-view\x20h2','div','3124822SsaBoJ','change','wait','#admin-lobby-view','lobby','1442147zlhJTC','#game-over-view','สุดยอด!\x20ด่านต่อไป:\x20ยาก','เกิดข้อผิดพลาดในการกลับสู่ล็อบบี้','#difficulty-select','playing','#home-btn','ArrowUp','กลับไปหน้าแรก','ห้องเกมถูกปิดแล้ว','winner','เกมจบแล้ว\x20มีผู้ชนะแล้ว!','6nucnOX','Finish\x20attempt\x20failed:','onclick','admin-login','classList','<p\x20class=\x22text-gray-500\x20text-center\x20w-full\x22>ยังไม่มีใครเข้าร่วม...</p>','#game-timer','#picker','คะแนน:\x20','ไม่พบห้องเกมนี้','#toggle-sidebar-btn','game','เกิดข้อผิดพลาดในการเริ่มเกม','closest','body','add','aborted'];_0x386a=function(){return _0x4235c7;};return _0x386a();}function renderAdminGameView(_0x2ee0b2){const _0x5f3126=_0x4f3d9d;$(_0x5f3126(0x178))[_0x5f3126(0x172)]['remove'](_0x5f3126(0xf5)),hostControls[_0x5f3126(0x172)]['remove'](_0x5f3126(0xf5));const _0x5e8184=_0x2ee0b2['players']||{},_0x4d6d59=Object['entries'](_0x5e8184)[_0x5f3126(0x19f)]((_0x338d9a,_0x2358b5)=>{const _0x5f2988=_0x5f3126,_0x1761ba=_0x338d9a[0x1],_0x3b524a=_0x2358b5[0x1];if((_0x1761ba['finishTime']?0x1:0x0)!==(_0x3b524a[_0x5f2988(0x1bc)]?0x1:0x0))return(_0x3b524a[_0x5f2988(0x1bc)]?0x1:0x0)-(_0x1761ba[_0x5f2988(0x1bc)]?0x1:0x0);if((_0x1761ba[_0x5f2988(0x149)]||0x0)!==(_0x3b524a[_0x5f2988(0x149)]||0x0))return(_0x3b524a[_0x5f2988(0x149)]||0x0)-(_0x1761ba[_0x5f2988(0x149)]||0x0);return(_0x3b524a[_0x5f2988(0x194)]||0x0)-(_0x1761ba[_0x5f2988(0x194)]||0x0);});playerList[_0x5f3126(0x132)]=_0x4d6d59[_0x5f3126(0x197)](([_0xf7dc59,_0x15792a])=>{const _0xaf3328=_0x5f3126;let _0x15767f=(_0x15792a[_0xaf3328(0x194)]||0x0)+_0xaf3328(0x186);if(_0x15792a[_0xaf3328(0x1bc)])_0x15767f=_0xaf3328(0x146);else _0x2ee0b2[_0xaf3328(0x19a)][_0xaf3328(0x13f)]==='mixed'&&(_0x15767f=_0xaf3328(0x13a)+(_0x15792a[_0xaf3328(0x191)]||'easy')+'\x20('+(_0x15792a[_0xaf3328(0x194)]||0x0)+'/16)');return _0xaf3328(0x147)+_0xf7dc59+_0xaf3328(0x122)+(_0x15792a[_0xaf3328(0x149)]||0x0)+_0xaf3328(0xf0)+_0x15767f+')</span></div>';})[_0x5f3126(0x14f)]('');let _0x28b912;if(_0x2ee0b2[_0x5f3126(0x19a)]['difficulty']===_0x5f3126(0x11e)){const _0x4caf56=[_0x5f3126(0x198),_0x5f3126(0xf6),_0x5f3126(0x1aa)];let _0x2da96e=_0x5f3126(0x198);const _0x15f2df=Object[_0x5f3126(0x19d)](_0x5e8184);for(const _0x10a5e7 of _0x15f2df){if(_0x10a5e7[_0x5f3126(0x1bc)])continue;const _0x1d3d95=_0x10a5e7[_0x5f3126(0x191)]||_0x5f3126(0x198);_0x4caf56[_0x5f3126(0x1b8)](_0x1d3d95)>_0x4caf56[_0x5f3126(0x1b8)](_0x2da96e)&&(_0x2da96e=_0x1d3d95);}_0x28b912=_0x2ee0b2[_0x5f3126(0x1a7)]?_0x2ee0b2[_0x5f3126(0x1a7)][_0x2da96e]:null;}else _0x28b912=_0x2ee0b2['sudoku'];if(!_0x28b912)return;const _0x4aa43f=_0x28b912[_0x5f3126(0x140)]||[];given=_0x4aa43f[_0x5f3126(0x141)](),board=_0x4aa43f[_0x5f3126(0x141)](),solution=_0x28b912['solution']||[],selectedIdx=-0x1,renderSudoku(),$$(_0x5f3126(0x11b))['forEach'](_0x16c2d0=>_0x16c2d0['style'][_0x5f3126(0x1b0)]=_0x5f3126(0x118)),pickerEl[_0x5f3126(0x172)][_0x5f3126(0x17d)](_0x5f3126(0xf5)),$('#reset-btn')[_0x5f3126(0x172)][_0x5f3126(0x17d)](_0x5f3126(0xf5)),$('#home-btn')[_0x5f3126(0x172)][_0x5f3126(0x17d)](_0x5f3126(0xf5));}function renderPlayerGameView(_0x4ef580){const _0x2b04e4=_0x4f3d9d;$(_0x2b04e4(0x178))[_0x2b04e4(0x172)]['add'](_0x2b04e4(0xf5));const _0x323d80=(_0x4ef580[_0x2b04e4(0x109)]||{})[currentPlayerName];if(!_0x323d80)return;playerScoreDisplay['textContent']=_0x2b04e4(0x176)+(_0x323d80[_0x2b04e4(0x149)]||0x0),playerScoreDisplay[_0x2b04e4(0x172)][_0x2b04e4(0x102)](_0x2b04e4(0xf5));let _0xf6b828;if(_0x4ef580[_0x2b04e4(0x19a)][_0x2b04e4(0x13f)]===_0x2b04e4(0x11e)){const _0x4ea102=_0x323d80['currentLevel']||'easy';_0xf6b828=_0x4ef580[_0x2b04e4(0x1a7)][_0x4ea102],targetNumberDisplay[_0x2b04e4(0x192)]=_0x2b04e4(0x13a)+_0x4ea102;}else _0xf6b828=_0x4ef580['sudoku'],targetNumberDisplay['textContent']=_0x2b04e4(0x10e);if(!_0xf6b828)return;given=(_0xf6b828[_0x2b04e4(0x140)]||[])['slice'](),solution=(_0xf6b828['solution']||[])[_0x2b04e4(0x141)](),selectedIdx=board[_0x2b04e4(0x10a)]((_0x135fc7,_0xfd63f9)=>!given[_0xfd63f9]);if(selectedIdx<0x0)selectedIdx=0x0;_0x323d80[_0x2b04e4(0x1bc)]?(gameBoard[_0x2b04e4(0x172)][_0x2b04e4(0x17d)](_0x2b04e4(0xf5)),playerFinishedView[_0x2b04e4(0x172)]['remove'](_0x2b04e4(0xf5))):(gameBoard[_0x2b04e4(0x172)][_0x2b04e4(0x102)]('hidden'),playerFinishedView[_0x2b04e4(0x172)][_0x2b04e4(0x17d)]('hidden'));}function renderGameOverView(_0x448569){const _0x36ce56=_0x4f3d9d,_0x2bb580=_0x448569['winner'],_0x457148=$(_0x36ce56(0xe7));_0x2bb580?_0x457148['innerHTML']='<i\x20class=\x22fas\x20fa-crown\x20mr-2\x22></i>ผู้ชนะคือ\x20'+_0x2bb580+'!':_0x457148[_0x36ce56(0x132)]=_0x36ce56(0xe5);const _0x350fdc=_0x448569[_0x36ce56(0x109)]||{},_0x509b77=Object[_0x36ce56(0x1a5)](_0x350fdc)[_0x36ce56(0x19f)](([,_0x31c99a],[,_0x1f2829])=>{const _0x2a8224=_0x36ce56;if((_0x31c99a[_0x2a8224(0x149)]||0x0)!==(_0x1f2829[_0x2a8224(0x149)]||0x0))return(_0x1f2829[_0x2a8224(0x149)]||0x0)-(_0x31c99a[_0x2a8224(0x149)]||0x0);if(_0x1f2829['finishTime']&&_0x31c99a[_0x2a8224(0x1bc)])return _0x31c99a[_0x2a8224(0x1bc)]['toMillis']()-_0x1f2829['finishTime'][_0x2a8224(0x1c5)]();if(_0x1f2829[_0x2a8224(0x1bc)])return 0x1;if(_0x31c99a[_0x2a8224(0x1bc)])return-0x1;return(_0x1f2829[_0x2a8224(0x194)]||0x0)-(_0x31c99a[_0x2a8224(0x194)]||0x0);});podiumContainer[_0x36ce56(0x132)]='',otherRankingsList[_0x36ce56(0x132)]='';const _0x2e8b87=_0x509b77['slice'](0x0,0x3),_0x248c4a=_0x509b77[_0x36ce56(0x141)](0x3);_0x2e8b87[_0x36ce56(0xf7)](([_0x2dd6db,_0x4dc5cc],_0x2ce189)=>{const _0x4d1762=_0x36ce56,_0x3e2381=_0x2ce189+0x1,_0x184876=document['createElement'](_0x4d1762(0x15c));_0x184876[_0x4d1762(0x107)]=_0x4d1762(0x101)+_0x3e2381,_0x184876[_0x4d1762(0x132)]=(_0x3e2381===0x1&&_0x2bb580?_0x4d1762(0x195):'')+_0x4d1762(0x152)+_0x2dd6db+_0x4d1762(0x1a4)+(_0x4dc5cc[_0x4d1762(0x149)]||0x0)+'\x20คะแนน</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22rank\x22>'+_0x3e2381+_0x4d1762(0x100),podiumContainer['appendChild'](_0x184876);});for(let _0x798735=_0x509b77['length'];_0x798735<0x3;_0x798735++){const _0x251e66=_0x798735+0x1,_0x44f327=document['createElement'](_0x36ce56(0x15c));_0x44f327[_0x36ce56(0x107)]=_0x36ce56(0x101)+_0x251e66,podiumContainer[_0x36ce56(0x10d)](_0x44f327);}if(_0x248c4a['length']>0x0)otherRankingsContainer[_0x36ce56(0x172)][_0x36ce56(0x102)](_0x36ce56(0xf5)),otherRankingsList['innerHTML']=_0x248c4a['map'](([_0x4cc140,_0x141446],_0x783ca8)=>_0x36ce56(0x108)+(_0x783ca8+0x4)+'.\x20'+_0x4cc140+'</span><span>'+(_0x141446[_0x36ce56(0x149)]||0x0)+_0x36ce56(0x1ad))['join']('');else otherRankingsContainer['classList'][_0x36ce56(0x17d)]('hidden');if(isHost)$(_0x36ce56(0x196))[_0x36ce56(0x172)][_0x36ce56(0x102)](_0x36ce56(0xf5));else $(_0x36ce56(0x196))[_0x36ce56(0x172)][_0x36ce56(0x17d)](_0x36ce56(0xf5));showView(_0x36ce56(0x18b));}function renderPracticeGameOverView(){const _0x6e9bf4=_0x4f3d9d,_0x32ea6f=gameTimerEl['textContent'][_0x6e9bf4(0xf9)](_0x6e9bf4(0x148),''),_0x2e902c=_0x32ea6f[_0x6e9bf4(0x1b1)](':'),_0x3ab3df=parseInt(_0x2e902c[0x0],0xa)*0x3c+parseInt(_0x2e902c[0x1],0xa),_0x573f53=gameSettings[_0x6e9bf4(0x180)]-_0x3ab3df,_0x30f9be=String(Math[_0x6e9bf4(0x143)](_0x573f53/0x3c))[_0x6e9bf4(0xfc)](0x2,'0'),_0xf9dd35=String(_0x573f53%0x3c)[_0x6e9bf4(0xfc)](0x2,'0'),_0x57fa63=_0x30f9be+':'+_0xf9dd35;resultsHeader[_0x6e9bf4(0x132)]='<i\x20class=\x22fas\x20fa-check-circle\x20mr-2\x22></i>ฝึกซ้อมสำเร็จ!',podiumContainer['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22text-center\x20text-lg\x20space-y-4\x20my-8\x20p-6\x20rounded-lg\x22\x20style=\x22background:\x20var(--card-bg);\x20border:\x202px\x20solid\x20var(--card-border);\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>ความยาก:\x20<strong\x20class=\x22text-xl\x22\x20style=\x22color:\x20var(--accent);\x22>'+gameSettings['difficulty']+_0x6e9bf4(0xde)+_0x57fa63+'</strong></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',otherRankingsContainer[_0x6e9bf4(0x172)]['add'](_0x6e9bf4(0xf5));const _0x56a9ae=$(_0x6e9bf4(0x196));_0x56a9ae[_0x6e9bf4(0x192)]=_0x6e9bf4(0x16a),_0x56a9ae[_0x6e9bf4(0x172)]['remove'](_0x6e9bf4(0xf5)),_0x56a9ae[_0x6e9bf4(0x170)]=()=>$('#home-btn')[_0x6e9bf4(0xe4)](),showView(_0x6e9bf4(0x18b));}let syncTimer=null;function scheduleBoardSync(){if(isPracticeMode||!currentGameId||!currentPlayerName)return;if(syncTimer)clearTimeout(syncTimer);syncTimer=setTimeout(async()=>{const _0x4c9cab=_0x19c8;try{const _0x3a431a=board[_0x4c9cab(0x136)](_0x3d3b98=>_0x3d3b98!==0x0)[_0x4c9cab(0x1b9)],_0x48121b=doc(db,_0x4c9cab(0x1c1),currentGameId,'playerStates',currentPlayerName);await updateDoc(_0x48121b,{'board':board[_0x4c9cab(0x14f)](''),'hasMistake':hasMistake});const _0x38b785=doc(db,_0x4c9cab(0x1c1),currentGameId);await updateDoc(_0x38b785,{[_0x4c9cab(0xe9)+currentPlayerName+_0x4c9cab(0x137)]:_0x3a431a});}catch(_0x246b2e){console[_0x4c9cab(0x105)](_0x4c9cab(0x116),_0x246b2e);}},0xc8);}async function tryFinish(){const _0xf29229=_0x4f3d9d;if(isPracticeMode){if(!isSolved())return;const _0x43577d=gameTimerEl[_0xf29229(0x192)][_0xf29229(0xf9)](_0xf29229(0x148),''),_0x453994=_0x43577d[_0xf29229(0x1b1)](':'),_0x546e7e=parseInt(_0x453994[0x0],0xa)*0x3c+parseInt(_0x453994[0x1],0xa),_0x8be273=0x64+_0x546e7e+(hasMistake?0x0:0x32);if(gameSettings[_0xf29229(0x13f)]===_0xf29229(0x11e)){if(currentPracticeLevel==='easy'){currentPracticeLevel=_0xf29229(0xf6),toast('เยี่ยม!\x20ด่านต่อไป:\x20ปานกลาง',0x9c4),loadPracticePuzzle(_0xf29229(0xf6));return;}else{if(currentPracticeLevel===_0xf29229(0xf6)){currentPracticeLevel=_0xf29229(0x1aa),toast(_0xf29229(0x164),0x9c4),loadPracticePuzzle(_0xf29229(0x1aa));return;}}}if(timerInterval)clearInterval(timerInterval);gameBoard['classList']['add'](_0xf29229(0xf5)),playerFinishedView[_0xf29229(0x172)][_0xf29229(0x102)](_0xf29229(0xf5)),$(_0xf29229(0x15b))[_0xf29229(0x192)]=_0xf29229(0xfb),$(_0xf29229(0x113))[_0xf29229(0x192)]=_0xf29229(0x1b6),$('#practice-score-display')[_0xf29229(0x132)]=_0xf29229(0x128)+_0x8be273+_0xf29229(0x156),setTimeout(()=>{renderPracticeGameOverView();},0x7d0);return;}if(syncTimer)clearTimeout(syncTimer);const _0x276584=doc(db,_0xf29229(0x1c1),currentGameId);try{await runTransaction(db,async _0x420612=>{const _0x164128=_0xf29229,_0x12000c=await _0x420612['get'](_0x276584);if(!_0x12000c['exists']())throw new Error('Game\x20not\x20found');const _0x2b7e57=_0x12000c[_0x164128(0x1c6)]();if(_0x2b7e57[_0x164128(0x18d)]!==_0x164128(0x167))return;const _0xd6b75a=(_0x2b7e57[_0x164128(0x109)]||{})[currentPlayerName];if(!_0xd6b75a)throw new Error('Player\x20not\x20found\x20in\x20game');if(_0xd6b75a['finishTime'])return;const _0x552ce0=board;let _0x597a21,_0x3c60ba=_0x164128(0x142);_0x2b7e57[_0x164128(0x19a)][_0x164128(0x13f)]===_0x164128(0x11e)?(_0x3c60ba=_0xd6b75a[_0x164128(0x191)]||'easy',_0x597a21=_0x2b7e57[_0x164128(0x1a7)][_0x3c60ba]['solution']):_0x597a21=_0x2b7e57[_0x164128(0x1b4)]['solution'];for(let _0x18fdbd=0x0;_0x18fdbd<0x10;_0x18fdbd++){if(_0x552ce0[_0x18fdbd]!==_0x597a21[_0x18fdbd])return;}const _0x5105a0=_0x2b7e57[_0x164128(0xfe)][_0x164128(0x1c5)](),_0x19e03e=Math['floor']((Date[_0x164128(0xf1)]()-_0x5105a0)/0x3e8),_0x580956=Math[_0x164128(0x18a)](0x0,_0x2b7e57['gameMode'][_0x164128(0x180)]-_0x19e03e),_0x38b5dc=0x64+_0x580956+(hasMistake?0x0:0x32),_0x4af822={};if(_0x2b7e57[_0x164128(0x19a)]['difficulty']===_0x164128(0x11e)){const _0x55929d=doc(db,_0x164128(0x1c1),currentGameId,_0x164128(0xe0),currentPlayerName);if(_0x3c60ba===_0x164128(0x198))_0x4af822['players.'+currentPlayerName+_0x164128(0x131)]=_0x164128(0xf6),_0x4af822['players.'+currentPlayerName+'.score']=increment(_0x38b5dc),_0x420612['set'](_0x55929d,{'board':_0x2b7e57[_0x164128(0x1a7)][_0x164128(0xf6)][_0x164128(0x140)][_0x164128(0x14f)](''),'hasMistake':![]});else _0x3c60ba===_0x164128(0xf6)?(_0x4af822[_0x164128(0xe9)+currentPlayerName+_0x164128(0x131)]=_0x164128(0x1aa),_0x4af822[_0x164128(0xe9)+currentPlayerName+_0x164128(0x11a)]=increment(_0x38b5dc),_0x420612[_0x164128(0x1a3)](_0x55929d,{'board':_0x2b7e57['puzzles'][_0x164128(0x1aa)][_0x164128(0x140)][_0x164128(0x14f)](''),'hasMistake':![]})):(_0x4af822[_0x164128(0xe9)+currentPlayerName+_0x164128(0x11a)]=increment(_0x38b5dc),_0x4af822[_0x164128(0xe9)+currentPlayerName+_0x164128(0x19e)]=serverTimestamp(),_0x2b7e57[_0x164128(0x19a)][_0x164128(0x12c)]===_0x164128(0x138)&&(_0x4af822[_0x164128(0x18d)]='finished',_0x4af822['winner']=currentPlayerName));}else _0x4af822[_0x164128(0xe9)+currentPlayerName+'.score']=increment(_0x38b5dc),_0x4af822[_0x164128(0xe9)+currentPlayerName+_0x164128(0x19e)]=serverTimestamp(),_0x2b7e57[_0x164128(0x19a)][_0x164128(0x12c)]===_0x164128(0x138)&&(_0x4af822['status']=_0x164128(0xee),_0x4af822[_0x164128(0x16c)]=currentPlayerName);_0x420612['update'](_0x276584,_0x4af822);});}catch(_0x14012a){_0x14012a[_0xf29229(0x106)][_0xf29229(0x1b5)](_0xf29229(0x17e))?(console[_0xf29229(0x1a6)](_0xf29229(0x125)),toast(_0xf29229(0x16d))):(console[_0xf29229(0x104)](_0xf29229(0x16f),_0x14012a),toast('เกิดข้อผิดพลาดในการจบเกม'));}}$(_0x4f3d9d(0x12b))[_0x4f3d9d(0x19c)]('click',()=>showView(_0x4f3d9d(0x171))),$('#admin-back-btn')['addEventListener']('click',()=>showView('player-join')),$(_0x4f3d9d(0x1be))[_0x4f3d9d(0x19c)](_0x4f3d9d(0xe4),async()=>{const _0x4963a2=_0x4f3d9d;if($(_0x4963a2(0x14d))[_0x4963a2(0x124)]==='')await createGameRoom();else toast(_0x4963a2(0x134));}),$(_0x4f3d9d(0xe2))['addEventListener'](_0x4f3d9d(0xe4),handleJoinGame),$(_0x4f3d9d(0x103))[_0x4f3d9d(0x19c)](_0x4f3d9d(0xe4),()=>{const _0x458390=_0x4f3d9d;isPracticeMode=!![],isHost=!![],showView(_0x458390(0x18e)),$(_0x458390(0xdf))['classList'][_0x458390(0x17d)](_0x458390(0xf5)),$(_0x458390(0xf2))['innerHTML']=_0x458390(0x121);}),$(_0x4f3d9d(0x13e))[_0x4f3d9d(0x19c)]('click',()=>{const _0x4fdf1a=_0x4f3d9d;isPracticeMode=![],showView('admin-settings'),$('#competition-settings')['classList'][_0x4fdf1a(0x102)](_0x4fdf1a(0xf5)),$(_0x4fdf1a(0xf2))[_0x4fdf1a(0x132)]=_0x4fdf1a(0x12f);}),$('#cancel-settings-btn')[_0x4f3d9d(0x19c)](_0x4f3d9d(0xe4),()=>{const _0x4ffc1e=_0x4f3d9d;isHost&&!currentGameId&&isPracticeMode?(isPracticeMode=![],isHost=![],showView(_0x4ffc1e(0xe8))):showView(_0x4ffc1e(0x10f));}),$(_0x4f3d9d(0xf2))[_0x4f3d9d(0x19c)](_0x4f3d9d(0xe4),()=>{isPracticeMode?startPracticeGame():handleStartGame();}),$(_0x4f3d9d(0x139))[_0x4f3d9d(0x19c)](_0x4f3d9d(0xe4),forceEndGame),$('#back-to-lobby-btn')['addEventListener']('click',returnToLobby),$(_0x4f3d9d(0x168))[_0x4f3d9d(0x19c)](_0x4f3d9d(0xe4),()=>{const _0x14f88f=_0x4f3d9d;if(unsubscribeGameListener)unsubscribeGameListener();unsubscribePlayerStateListener&&(unsubscribePlayerStateListener(),unsubscribePlayerStateListener=null);if(timerInterval)clearInterval(timerInterval);currentGameId=null,currentPlayerName=null,isHost=![],isPracticeMode=![],practicePuzzles=null,currentPracticeLevel=null,document[_0x14f88f(0x17c)][_0x14f88f(0x172)][_0x14f88f(0x102)](_0x14f88f(0x1a1)),showView(_0x14f88f(0xe8)),$(_0x14f88f(0x15b))['textContent']=_0x14f88f(0x199),$(_0x14f88f(0x113))['textContent']=_0x14f88f(0x1a9);}),$(_0x4f3d9d(0x115))[_0x4f3d9d(0x19c)](_0x4f3d9d(0xe4),()=>{for(let _0x7c5e0c=0x0;_0x7c5e0c<0x10;_0x7c5e0c++)board[_0x7c5e0c]=given[_0x7c5e0c];hasMistake=![],renderSudoku(),scheduleBoardSync();}),sudokuEl[_0x4f3d9d(0x19c)]('click',_0x3e48a7=>{const _0x21d06d=_0x4f3d9d,_0x3cf945=_0x3e48a7[_0x21d06d(0x133)][_0x21d06d(0x17b)]('.cell');if(!_0x3cf945)return;const _0x58a977=parseInt(_0x3cf945['dataset'][_0x21d06d(0x1ac)],0xa);if(!given[_0x58a977])selectCell(_0x58a977);}),$(_0x4f3d9d(0x178))[_0x4f3d9d(0x19c)]('click',()=>{const _0x4a0617=_0x4f3d9d;$(_0x4a0617(0x15a))[_0x4a0617(0x172)]['toggle'](_0x4a0617(0x14e));}),$(_0x4f3d9d(0x166))[_0x4f3d9d(0x19c)](_0x4f3d9d(0x15e),_0x300bde=>{const _0x411acf=_0x4f3d9d,_0x31c554=$(_0x411acf(0x13b));switch(_0x300bde[_0x411acf(0x133)][_0x411acf(0x124)]){case _0x411acf(0x198):_0x31c554[_0x411acf(0x124)]=0x1e;break;case _0x411acf(0xf6):_0x31c554[_0x411acf(0x124)]=0x3c;break;case _0x411acf(0x1aa):_0x31c554[_0x411acf(0x124)]=0x78;break;case'mixed':_0x31c554[_0x411acf(0x124)]=0xd2;break;}}),window[_0x4f3d9d(0x19c)](_0x4f3d9d(0xea),()=>{isHost&&currentGameId&&deleteDoc(doc(db,'games',currentGameId));}),initialize(),showView('player-join');
