const _0x163127=_0x2df9;(function(_0x6bb641,_0xb9efc2){const _0x5bf5ae=_0x2df9,_0xb826de=_0x6bb641();while(!![]){try{const _0xce1f5a=parseInt(_0x5bf5ae(0x155))/0x1*(-parseInt(_0x5bf5ae(0x175))/0x2)+parseInt(_0x5bf5ae(0x13a))/0x3+-parseInt(_0x5bf5ae(0x1e8))/0x4*(parseInt(_0x5bf5ae(0x11d))/0x5)+-parseInt(_0x5bf5ae(0x1a0))/0x6*(parseInt(_0x5bf5ae(0x1df))/0x7)+-parseInt(_0x5bf5ae(0x1bd))/0x8+-parseInt(_0x5bf5ae(0x1eb))/0x9+parseInt(_0x5bf5ae(0x12a))/0xa;if(_0xce1f5a===_0xb9efc2)break;else _0xb826de['push'](_0xb826de['shift']());}catch(_0x18794c){_0xb826de['push'](_0xb826de['shift']());}}}(_0x5434,0x4428e));import{initializeApp}from'https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js';import{getAuth,signInAnonymously,onAuthStateChanged}from'https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js';import{getFirestore,doc,getDoc,setDoc,updateDoc,onSnapshot,serverTimestamp,runTransaction,deleteDoc,deleteField,increment,collection}from'https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js';const firebaseConfig={'apiKey':_0x163127(0x135),'authDomain':_0x163127(0x14c),'projectId':_0x163127(0x174),'storageBucket':_0x163127(0x166),'messagingSenderId':'989271279576','appId':_0x163127(0x113),'measurementId':_0x163127(0x131)},$=_0x5eef1a=>document['querySelector'](_0x5eef1a),$$=_0x5e69e3=>Array[_0x163127(0x115)](document['querySelectorAll'](_0x5e69e3)),playerJoinView=$(_0x163127(0x179)),playerWaitView=$(_0x163127(0x1cb)),adminLobbyView=$(_0x163127(0x18c)),gameView=$(_0x163127(0x170)),adminLoginModal=$(_0x163127(0x116)),adminSettingsModal=$('#admin-settings-modal'),gameOverView=$(_0x163127(0x1c1)),sudokuEl=$('#sudoku'),pickerEl=$('#picker'),playerList=$(_0x163127(0x163)),lobbyPlayerNameList=$(_0x163127(0x121)),lobbyPlayerCount=$(_0x163127(0x193)),hostControls=$('#host-controls'),toastEl=$(_0x163127(0x1e6)),gameCodeDisplay=$(_0x163127(0x11f)),gameTimerEl=$(_0x163127(0x1e9)),puzzleProgressEl=$(_0x163127(0x191)),playerScoreDisplay=$(_0x163127(0x1a5)),gameBoard=$(_0x163127(0x1d5)),playerFinishedView=$(_0x163127(0x171)),podiumContainer=$(_0x163127(0x18a)),otherRankingsList=$('#other-rankings-list'),otherRankingsContainer=$(_0x163127(0x1f5)),targetNumberDisplay=$(_0x163127(0x1ed));let db,auth,userId,currentPlayerName,isHost=![],currentGameId=null,unsubscribeGameListener=null,unsubscribePlayerStateListener=null,timerInterval=null,previousGameStatus=null,isPracticeMode=![],practicePuzzles=null,currentPracticeLevel=null,given=new Array(0x10)[_0x163127(0x1ac)](0x0),board=new Array(0x10)[_0x163127(0x1ac)](0x0),solution=new Array(0x10)[_0x163127(0x1ac)](0x0),selectedIdx=-0x1,hasMistake=![],gameSettings={'timeLimit':0x3c,'resultDisplayMode':'immediate','difficulty':'medium','numQuestions':0x1};function toast(_0x48b172,_0x2383c0=0x7d0){const _0x17b798=_0x163127;toastEl[_0x17b798(0x1e7)]=_0x48b172,toastEl['classList']['add'](_0x17b798(0x18e)),setTimeout(()=>toastEl[_0x17b798(0x17a)][_0x17b798(0x153)](_0x17b798(0x18e)),_0x2383c0);}const rnd=(_0x336597,_0x3f280e)=>Math['floor'](Math[_0x163127(0x1e2)]()*(_0x3f280e-_0x336597+0x1))+_0x336597,themeKey=_0x163127(0x161),themeSelect=$(_0x163127(0x1d7));function applyTheme(_0x1b3843){const _0x230966=_0x163127;document[_0x230966(0x17f)][_0x230966(0x1ab)](_0x230966(0x13f),_0x1b3843),localStorage[_0x230966(0x156)](themeKey,_0x1b3843);}const savedTheme=localStorage['getItem'](themeKey),initialTheme=savedTheme||'contrast';applyTheme(initialTheme);themeSelect&&themeSelect['addEventListener']('change',()=>applyTheme(themeSelect['value']));function baseSolved(){return[0x1,0x2,0x3,0x4,0x3,0x4,0x1,0x2,0x2,0x1,0x4,0x3,0x4,0x3,0x2,0x1];}function shuffle(_0x327a86){const _0x28ada5=_0x163127;for(let _0x46dbca=_0x327a86['length']-0x1;_0x46dbca>0x0;_0x46dbca--){const _0x54a343=Math[_0x28ada5(0x12d)](Math[_0x28ada5(0x1e2)]()*(_0x46dbca+0x1));[_0x327a86[_0x46dbca],_0x327a86[_0x54a343]]=[_0x327a86[_0x54a343],_0x327a86[_0x46dbca]];}return _0x327a86;}function applyPermutations(_0x49e070){const _0xf6c81a=_0x163127;let _0x4a2002=_0x49e070[_0xf6c81a(0x16a)]();const _0x127359=(_0x480611,_0x3cfa3a)=>{for(let _0x149bec=0x0;_0x149bec<0x4;_0x149bec++){const _0x457037=_0x480611*0x4+_0x149bec,_0x3ee660=_0x3cfa3a*0x4+_0x149bec;[_0x4a2002[_0x457037],_0x4a2002[_0x3ee660]]=[_0x4a2002[_0x3ee660],_0x4a2002[_0x457037]];}},_0x2eff39=(_0x44465b,_0x58f8eb)=>{for(let _0x49c363=0x0;_0x49c363<0x4;_0x49c363++){const _0x13aca5=_0x49c363*0x4+_0x44465b,_0x3b8ab3=_0x49c363*0x4+_0x58f8eb;[_0x4a2002[_0x13aca5],_0x4a2002[_0x3b8ab3]]=[_0x4a2002[_0x3b8ab3],_0x4a2002[_0x13aca5]];}};if(Math['random']()<0.5)_0x127359(0x0,0x1);if(Math[_0xf6c81a(0x1e2)]()<0.5)_0x127359(0x2,0x3);if(Math['random']()<0.5)_0x2eff39(0x0,0x1);if(Math[_0xf6c81a(0x1e2)]()<0.5)_0x2eff39(0x2,0x3);if(Math[_0xf6c81a(0x1e2)]()<0.5)for(let _0x52cf89=0x0;_0x52cf89<0x4;_0x52cf89++){const _0x269bde=0x0*0x4+_0x52cf89,_0x5b269=0x2*0x4+_0x52cf89;[_0x4a2002[_0x269bde],_0x4a2002[_0x5b269]]=[_0x4a2002[_0x5b269],_0x4a2002[_0x269bde]];const _0x57f135=0x1*0x4+_0x52cf89,_0x3e50e7=0x3*0x4+_0x52cf89;[_0x4a2002[_0x57f135],_0x4a2002[_0x3e50e7]]=[_0x4a2002[_0x3e50e7],_0x4a2002[_0x57f135]];}if(Math['random']()<0.5)for(let _0x1c0efb=0x0;_0x1c0efb<0x4;_0x1c0efb++){const _0x47d07d=_0x1c0efb*0x4+0x0,_0x19d4af=_0x1c0efb*0x4+0x2;[_0x4a2002[_0x47d07d],_0x4a2002[_0x19d4af]]=[_0x4a2002[_0x19d4af],_0x4a2002[_0x47d07d]];const _0x5caaa0=_0x1c0efb*0x4+0x1,_0x58db37=_0x1c0efb*0x4+0x3;[_0x4a2002[_0x5caaa0],_0x4a2002[_0x58db37]]=[_0x4a2002[_0x58db37],_0x4a2002[_0x5caaa0]];}const _0x2802db=[0x0,...shuffle([0x1,0x2,0x3,0x4])];for(let _0x160839=0x0;_0x160839<0x10;_0x160839++)_0x4a2002[_0x160839]=_0x2802db[_0x4a2002[_0x160839]];return _0x4a2002;}function countSolutions(_0x102ea7){let _0x1f3684=_0x102ea7['slice'](),_0x1f37a9=0x0;function _0x34908c(_0x542c7f,_0x387450){const _0xfcdd69=_0x2df9,_0xff5f62=Math[_0xfcdd69(0x12d)](_0x542c7f/0x4),_0x281584=_0x542c7f%0x4;for(let _0x83414c=0x0;_0x83414c<0x4;_0x83414c++){if(_0x1f3684[_0xff5f62*0x4+_0x83414c]===_0x387450&&_0x83414c!==_0x281584)return![];if(_0x1f3684[_0x83414c*0x4+_0x281584]===_0x387450&&_0x83414c!==_0xff5f62)return![];}const _0x59fae5=Math[_0xfcdd69(0x12d)](_0xff5f62/0x2)*0x2,_0x15a462=Math[_0xfcdd69(0x12d)](_0x281584/0x2)*0x2;for(let _0x5146dd=_0x59fae5;_0x5146dd<_0x59fae5+0x2;_0x5146dd++)for(let _0x2ec664=_0x15a462;_0x2ec664<_0x15a462+0x2;_0x2ec664++){const _0x51d063=_0x5146dd*0x4+_0x2ec664;if(_0x51d063!==_0x542c7f&&_0x1f3684[_0x51d063]===_0x387450)return![];}return!![];}function _0x1ece0d(_0x5a76ed=0x0){while(_0x5a76ed<0x10&&_0x1f3684[_0x5a76ed]!==0x0)_0x5a76ed++;if(_0x5a76ed===0x10)return _0x1f37a9++,_0x1f37a9;for(let _0x268282=0x1;_0x268282<=0x4;_0x268282++){if(_0x34908c(_0x5a76ed,_0x268282)){_0x1f3684[_0x5a76ed]=_0x268282,_0x1ece0d(_0x5a76ed+0x1);if(_0x1f37a9>0x1)return _0x1f37a9;_0x1f3684[_0x5a76ed]=0x0;}}return _0x1f37a9;}return _0x1ece0d(0x0);}function makePuzzleByClues(_0x5c8440,_0x11e004){const _0x1b7ab0=_0x163127;let _0x3fae26=_0x5c8440[_0x1b7ab0(0x16a)]();const _0x104634=shuffle([...Array(0x10)[_0x1b7ab0(0x144)]()]);let _0x3ac45=0x0;for(const _0x1669f7 of _0x104634){if(0x10-_0x3ac45<=_0x11e004)break;const _0x5bbda9=_0x3fae26[_0x1669f7];_0x3fae26[_0x1669f7]=0x0,countSolutions(_0x3fae26)!==0x1?_0x3fae26[_0x1669f7]=_0x5bbda9:_0x3ac45++;}return _0x3fae26;}function generateSudoku(_0x42cead){const _0x4ac493=applyPermutations(baseSolved());let _0x43e030={'easy':[0x9,0xa],'medium':[0x7,0x8],'hard':[0x5,0x6]}[_0x42cead]||[0x7,0x8];const _0x3213c0=rnd(_0x43e030[0x0],_0x43e030[0x1]);let _0x1642ba=makePuzzleByClues(_0x4ac493,_0x3213c0);if(countSolutions(_0x1642ba)!==0x1)return generateSudoku(_0x42cead);return{'solution':_0x4ac493,'puzzle':_0x1642ba};}function _0x2df9(_0xd476d1,_0x193cb7){const _0x5434bc=_0x5434();return _0x2df9=function(_0x2df9da,_0x4089b0){_0x2df9da=_0x2df9da-0x10c;let _0x47349c=_0x5434bc[_0x2df9da];return _0x47349c;},_0x2df9(_0xd476d1,_0x193cb7);}function cellClasses(_0x1a69c4){const _0x5a76d4=_0x163127,_0x302ca2=Math[_0x5a76d4(0x12d)](_0x1a69c4/0x4),_0x451452=_0x1a69c4%0x4,_0x238b04=[];if(_0x451452===0x1)_0x238b04[_0x5a76d4(0x1f4)]('bR');if(_0x302ca2===0x1)_0x238b04['push']('bB');return _0x238b04['join']('\x20');}function renderSudoku(){const _0x41b2aa=_0x163127;sudokuEl[_0x41b2aa(0x183)]='';for(let _0x15a527=0x0;_0x15a527<0x10;_0x15a527++){const _0x1715f1=board[_0x15a527],_0x5938a9=document[_0x41b2aa(0x1d9)]('div');_0x5938a9[_0x41b2aa(0x1b1)]='cell\x20'+cellClasses(_0x15a527)+'\x20'+(given[_0x15a527]?_0x41b2aa(0x1a3):''),_0x5938a9[_0x41b2aa(0x137)]['idx']=_0x15a527,_0x5938a9[_0x41b2aa(0x1e7)]=_0x1715f1?_0x1715f1:'',!given[_0x15a527]&&_0x5938a9[_0x41b2aa(0x13e)]('click',()=>selectCell(_0x15a527)),sudokuEl[_0x41b2aa(0x18f)](_0x5938a9);}if(selectedIdx>=0x0)highlightRelatives(selectedIdx);markConflictsAll(),updateProgressText();}function selectCell(_0x2fad91){const _0x4eb9e1=_0x163127;selectedIdx=_0x2fad91,$$(_0x4eb9e1(0x142))[_0x4eb9e1(0x19e)](_0x933e77=>_0x933e77[_0x4eb9e1(0x17a)][_0x4eb9e1(0x153)](_0x4eb9e1(0x1dc),'hl'));const _0x145cd4=$$(_0x4eb9e1(0x142))[_0x2fad91];_0x145cd4[_0x4eb9e1(0x17a)][_0x4eb9e1(0x1e4)]('selected'),highlightRelatives(_0x2fad91);}function highlightRelatives(_0x366ca6){const _0x13c498=_0x163127,_0x3f5f18=Math['floor'](_0x366ca6/0x4),_0x1660db=_0x366ca6%0x4;$$(_0x13c498(0x142))['forEach']((_0x24d23e,_0x570335)=>{const _0x14b3c9=_0x13c498,_0x1e4bac=Math[_0x14b3c9(0x12d)](_0x570335/0x4),_0x735caa=_0x570335%0x4;(_0x1e4bac===_0x3f5f18||_0x735caa===_0x1660db||Math[_0x14b3c9(0x12d)](_0x1e4bac/0x2)===Math[_0x14b3c9(0x12d)](_0x3f5f18/0x2)&&Math[_0x14b3c9(0x12d)](_0x735caa/0x2)===Math[_0x14b3c9(0x12d)](_0x1660db/0x2))&&_0x24d23e[_0x14b3c9(0x17a)][_0x14b3c9(0x1e4)]('hl');});}function setNumber(_0x1922f2){const _0x4d90dc=_0x163127;if(selectedIdx<0x0||given[selectedIdx])return;const _0x521abd=$$('.cell')[selectedIdx];_0x521abd[_0x4d90dc(0x1e7)]=_0x1922f2?_0x1922f2:'',board[selectedIdx]=_0x1922f2;_0x1922f2!==0x0&&causesConflict(selectedIdx)&&(hasMistake=!![]);markConflictsAll(),updateProgressText(),scheduleBoardSync();if(isSolved())tryFinish();}function markConflictsAll(){const _0x58681f=_0x163127;$$(_0x58681f(0x142))[_0x58681f(0x19e)](_0x2ef6c6=>_0x2ef6c6[_0x58681f(0x17a)][_0x58681f(0x153)](_0x58681f(0x14d),'ok'));for(let _0xb80683=0x0;_0xb80683<0x10;_0xb80683++){if(board[_0xb80683]!==0x0&&causesConflict(_0xb80683))$$('.cell')[_0xb80683][_0x58681f(0x17a)][_0x58681f(0x1e4)]('conflict');else board[_0xb80683]!==0x0&&$$(_0x58681f(0x142))[_0xb80683][_0x58681f(0x17a)]['add']('ok');}}function causesConflict(_0x34f8c5){const _0x2237ea=_0x163127,_0x20064f=board[_0x34f8c5];if(_0x20064f===0x0)return![];const _0x1ee556=Math[_0x2237ea(0x12d)](_0x34f8c5/0x4),_0x49bd66=_0x34f8c5%0x4;for(let _0x328d44=0x0;_0x328d44<0x4;_0x328d44++){if(_0x328d44!==_0x49bd66&&board[_0x1ee556*0x4+_0x328d44]===_0x20064f)return!![];if(_0x328d44!==_0x1ee556&&board[_0x328d44*0x4+_0x49bd66]===_0x20064f)return!![];}const _0x5ba6c9=Math[_0x2237ea(0x12d)](_0x1ee556/0x2)*0x2,_0x5d9a49=Math[_0x2237ea(0x12d)](_0x49bd66/0x2)*0x2;for(let _0x50ec53=_0x5ba6c9;_0x50ec53<_0x5ba6c9+0x2;_0x50ec53++)for(let _0x5b200c=_0x5d9a49;_0x5b200c<_0x5d9a49+0x2;_0x5b200c++){const _0xca7350=_0x50ec53*0x4+_0x5b200c;if(_0xca7350!==_0x34f8c5&&board[_0xca7350]===_0x20064f)return!![];}return![];}function isSolved(){for(let _0x2e1a96=0x0;_0x2e1a96<0x10;_0x2e1a96++)if(board[_0x2e1a96]!==solution[_0x2e1a96])return![];return!![];}function updateProgressText(){const _0x5aced1=_0x163127,_0x691ac7=board[_0x5aced1(0x1be)](_0x22d0ec=>_0x22d0ec!==0x0)[_0x5aced1(0x1b8)];puzzleProgressEl[_0x5aced1(0x1e7)]=_0x5aced1(0x16f)+_0x691ac7+_0x5aced1(0x16b);}pickerEl[_0x163127(0x13e)](_0x163127(0x141),_0x3ad0c4=>{const _0xf1906=_0x163127,_0x1c8ba8=_0x3ad0c4[_0xf1906(0x14e)][_0xf1906(0x199)](_0xf1906(0x1ee));if(!_0x1c8ba8)return;setNumber(parseInt(_0x1c8ba8[_0xf1906(0x137)]['n'],0xa));}),document['addEventListener'](_0x163127(0x1c2),_0x403331=>{const _0x138884=_0x163127;if(selectedIdx<0x0)return;_0x403331[_0x138884(0x19a)]>='1'&&_0x403331['key']<='4'&&setNumber(parseInt(_0x403331[_0x138884(0x19a)],0xa));(_0x403331[_0x138884(0x19a)]===_0x138884(0x1b3)||_0x403331[_0x138884(0x19a)]==='Delete'||_0x403331['key']==='0')&&setNumber(0x0);const _0x1589ec=Math[_0x138884(0x12d)](selectedIdx/0x4),_0x298209=selectedIdx%0x4;if(_0x403331[_0x138884(0x19a)]===_0x138884(0x123))selectCell(_0x1589ec*0x4+Math[_0x138884(0x1f3)](_0x298209+0x1,0x3));if(_0x403331[_0x138884(0x19a)]==='ArrowLeft')selectCell(_0x1589ec*0x4+Math[_0x138884(0x1d4)](_0x298209-0x1,0x0));if(_0x403331[_0x138884(0x19a)]===_0x138884(0x16d))selectCell(Math[_0x138884(0x1f3)]((_0x1589ec+0x1)*0x4+_0x298209,0xf));if(_0x403331[_0x138884(0x19a)]==='ArrowUp')selectCell(Math[_0x138884(0x1d4)]((_0x1589ec-0x1)*0x4+_0x298209,0x0));});async function initialize(){const _0x4cea8e=_0x163127;try{const _0x26a545=initializeApp(firebaseConfig);db=getFirestore(_0x26a545),auth=getAuth(_0x26a545),onAuthStateChanged(auth,async _0x1b8144=>{!_0x1b8144&&await signInAnonymously(auth);});}catch(_0x2d7e00){console[_0x4cea8e(0x165)]('Firebase\x20init\x20failed:',_0x2d7e00),toast(_0x4cea8e(0x1d3));}}function showView(_0x21fc57){const _0x46d64b=_0x163127;[playerJoinView,playerWaitView,adminLoginModal,adminLobbyView,gameView,gameOverView,adminSettingsModal]['forEach'](_0x3fb4c4=>_0x3fb4c4['classList']['add'](_0x46d64b(0x150)));const _0xef526a=$(_0x46d64b(0x13d));if(_0x21fc57==='player-join'||_0x21fc57===_0x46d64b(0x146))_0xef526a[_0x46d64b(0x17a)][_0x46d64b(0x153)]('hidden');else isHost?_0xef526a['classList']['remove'](_0x46d64b(0x150)):_0xef526a[_0x46d64b(0x17a)]['add'](_0x46d64b(0x150));if(_0x21fc57===_0x46d64b(0x186))playerJoinView[_0x46d64b(0x17a)]['remove'](_0x46d64b(0x150));else{if(_0x21fc57==='player-wait')playerWaitView[_0x46d64b(0x17a)][_0x46d64b(0x153)]('hidden');else{if(_0x21fc57===_0x46d64b(0x146))adminLoginModal[_0x46d64b(0x17a)][_0x46d64b(0x153)](_0x46d64b(0x150));else{if(_0x21fc57===_0x46d64b(0x19f))adminLobbyView[_0x46d64b(0x17a)][_0x46d64b(0x153)](_0x46d64b(0x150));else{if(_0x21fc57==='admin-settings')adminSettingsModal['classList'][_0x46d64b(0x153)](_0x46d64b(0x150));else{if(_0x21fc57===_0x46d64b(0x1c0))gameView[_0x46d64b(0x17a)]['remove'](_0x46d64b(0x150));else{if(_0x21fc57===_0x46d64b(0x133))gameOverView[_0x46d64b(0x17a)][_0x46d64b(0x153)](_0x46d64b(0x150));}}}}}}}async function createGameRoom(){const _0x97e1de=_0x163127;isHost=!![],document['body']['classList'][_0x97e1de(0x153)](_0x97e1de(0x1ec)),showView('admin-lobby'),gameCodeDisplay[_0x97e1de(0x1e7)]=_0x97e1de(0x1e0);const _0xa4b0f8=rnd(0xa,0x63)[_0x97e1de(0x1a8)]();currentGameId=_0xa4b0f8;const _0x16ac82={'hostId':auth[_0x97e1de(0x14a)][_0x97e1de(0x19b)],'status':_0x97e1de(0x1b4),'players':{},'createdAt':serverTimestamp()};await setDoc(doc(db,_0x97e1de(0x136),currentGameId),_0x16ac82),gameCodeDisplay['textContent']=currentGameId,listenForGameUpdates(currentGameId);}async function handleStartGame(){const _0x59080e=_0x163127;if(!isHost||!currentGameId)return;gameSettings[_0x59080e(0x13c)]=document[_0x59080e(0x15d)]('input[name=\x22resultDisplayMode\x22]:checked')[_0x59080e(0x1d2)],gameSettings[_0x59080e(0x1c6)]=Math[_0x59080e(0x1d4)](0xa,parseInt($(_0x59080e(0x15f))['value']||'60',0xa)),gameSettings[_0x59080e(0x19c)]=$(_0x59080e(0x110))['value'];const _0x3051e1=doc(db,_0x59080e(0x136),currentGameId);try{await runTransaction(db,async _0x43cca4=>{const _0x14af84=_0x59080e,_0x212912=await _0x43cca4[_0x14af84(0x185)](_0x3051e1);if(!_0x212912['exists']())throw _0x14af84(0x158);const _0x45c6e1=_0x212912[_0x14af84(0x159)]()[_0x14af84(0x151)]||{},_0x2c9506={'status':_0x14af84(0x1b7),'startTime':serverTimestamp(),'gameMode':gameSettings};if(gameSettings[_0x14af84(0x19c)]==='mixed'){gameSettings[_0x14af84(0x178)]=0x3;const _0x1f59d9=generateSudoku(_0x14af84(0x1aa)),_0x5206c3=generateSudoku('medium'),_0x3160c7=generateSudoku(_0x14af84(0x11c));_0x2c9506['puzzles']={'easy':_0x1f59d9,'medium':_0x5206c3,'hard':_0x3160c7};}else gameSettings[_0x14af84(0x178)]=0x1,_0x2c9506[_0x14af84(0x1cf)]=generateSudoku(gameSettings[_0x14af84(0x19c)]);for(const _0x29bb89 in _0x45c6e1){_0x2c9506[_0x14af84(0x112)+_0x29bb89+_0x14af84(0x162)]=0x0,_0x2c9506['players.'+_0x29bb89+'.finishTime']=null,_0x2c9506[_0x14af84(0x112)+_0x29bb89+_0x14af84(0x1a1)]=0x0;const _0x3b38ad=doc(db,'games',currentGameId,'playerStates',_0x29bb89);let _0x3769f6,_0x190002;gameSettings[_0x14af84(0x19c)]===_0x14af84(0x190)?(_0x3769f6=_0x2c9506[_0x14af84(0x11a)][_0x14af84(0x1aa)]['puzzle'],_0x2c9506[_0x14af84(0x112)+_0x29bb89+_0x14af84(0x149)]='easy'):_0x3769f6=_0x2c9506[_0x14af84(0x1cf)][_0x14af84(0x1b9)];_0x190002=_0x3769f6[_0x14af84(0x1be)](_0x3e7160=>_0x3e7160!==0x0)[_0x14af84(0x1b8)],_0x2c9506[_0x14af84(0x112)+_0x29bb89+_0x14af84(0x1a1)]=_0x190002;const _0x7c05f2={'board':_0x3769f6[_0x14af84(0x125)](''),'hasMistake':![]};_0x43cca4['set'](_0x3b38ad,_0x7c05f2);}_0x43cca4['update'](_0x3051e1,_0x2c9506);}),showView(_0x59080e(0x1c0));}catch(_0x3a2ecf){console[_0x59080e(0x165)](_0x59080e(0x11e),_0x3a2ecf),toast(_0x59080e(0x157));}}function startPracticeGame(){const _0x78442=_0x163127;isPracticeMode=!![],gameSettings[_0x78442(0x1c6)]=Math['max'](0xa,parseInt($(_0x78442(0x15f))[_0x78442(0x1d2)]||'60',0xa)),gameSettings[_0x78442(0x19c)]=$('#difficulty-select')['value'],document[_0x78442(0x111)][_0x78442(0x17a)][_0x78442(0x1e4)](_0x78442(0x1ec)),hostControls[_0x78442(0x17a)][_0x78442(0x1e4)](_0x78442(0x150)),playerScoreDisplay[_0x78442(0x17a)][_0x78442(0x1e4)](_0x78442(0x150)),$(_0x78442(0x1de))[_0x78442(0x17a)][_0x78442(0x1e4)](_0x78442(0x150));if(gameSettings[_0x78442(0x19c)]===_0x78442(0x190))practicePuzzles={'easy':generateSudoku(_0x78442(0x1aa)),'medium':generateSudoku('medium'),'hard':generateSudoku(_0x78442(0x11c))},currentPracticeLevel=_0x78442(0x1aa),loadPracticePuzzle(currentPracticeLevel);else{practicePuzzles=null,currentPracticeLevel=gameSettings[_0x78442(0x19c)];const _0x47fd44=generateSudoku(gameSettings[_0x78442(0x19c)]);given=_0x47fd44['puzzle']['slice'](),board=_0x47fd44[_0x78442(0x1b9)][_0x78442(0x16a)](),solution=_0x47fd44[_0x78442(0x10f)][_0x78442(0x16a)](),targetNumberDisplay[_0x78442(0x1e7)]='ฝึกซ้อม:\x20'+gameSettings['difficulty'];}hasMistake=![],selectedIdx=board['findIndex']((_0x312ad9,_0x35b1be)=>!given[_0x35b1be]);if(selectedIdx<0x0)selectedIdx=0x0;showView(_0x78442(0x1c0)),gameBoard['classList'][_0x78442(0x153)](_0x78442(0x150)),playerFinishedView[_0x78442(0x17a)][_0x78442(0x1e4)]('hidden'),pickerEl['classList'][_0x78442(0x153)]('hidden'),$('#reset-btn')[_0x78442(0x17a)][_0x78442(0x153)](_0x78442(0x150)),$(_0x78442(0x195))[_0x78442(0x17a)]['remove'](_0x78442(0x150)),renderSudoku(),startPracticeTimer();}function _0x5434(){const _0x593743=['style','add','<li><span>','#toast','textContent','175416uVWTgR','#game-timer','status','1986561JTKmDe','player-view','#target-number-display','.pick','กรุณากรอกข้อมูลให้ครบถ้วน','Game\x20not\x20found','\x20คะแนน</span></li>','Player\x20not\x20found\x20in\x20game','min','push','#other-rankings-container','เข้าร่วมสำเร็จ!\x20รอสักครู่...','medium','map','player-wait','solution','#difficulty-select','body','players.','1:989271279576:web:43115bbaeeae31160954ad','aborted','from','#admin-login-modal','finished','<i\x20class=\x22fas\x20fa-check-circle\x20mr-2\x22></i>ฝึกซ้อมสำเร็จ!','\x20คะแนน</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22rank\x22>','puzzles','#start-game-btn','hard','15fsfZwJ','Error\x20starting\x20game:','#game-code-display','#player-finished-view\x20p','#lobby-player-name-list','\x20แทน','ArrowRight','change','join','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22player-score\x22>','winner','every','log','11854230vybZjd','#player-name-input','update','floor','score','รอผลการแข่งขันสักครู่...','#open-settings-btn','G-B1ZTE90SGG','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22player-name\x22>','game-over','gameMode','AIzaSyAJsk4l8I8uCYpJY8jZLAlRW1w2qLWN-2o','games','dataset','toMillis','wait','1348707uaJEwq','board\x20sync\x20failed','resultDisplayMode','#admin-icon-btn','addEventListener','data-theme','.app','click','.cell','#competition-settings','keys','entries','admin-login','podium-stand\x20podium-','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22text-lg\x20mt-4\x22>คะแนนรอบนี้:</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22text-4xl\x20font-bold\x22\x20style=\x22color:\x20var(--accent);\x22>','.currentLevel','currentUser','#admin-password-input','game24-69666.firebaseapp.com','conflict','target','ชื่อซ้ำ,\x20เปลี่ยนเป็น\x20','hidden','players','Sudoku\x204x4','remove','immediate','347795CmdeER','setItem','เกิดข้อผิดพลาดในการเริ่มเกม','Game\x20does\x20not\x20exist!','data','<i\x20class=\x22fas\x20fa-play\x20mr-2\x22></i>เริ่มฝึกซ้อม','#end-game-btn','onclick','querySelector','padStart','#time-limit-input','single','g24_theme_mp','.score','#player-list','เกิดข้อผิดพลาดในการกลับสู่ล็อบบี้','error','game24-69666.firebasestorage.app','warn','playerStates','#admin-login-btn','slice','/16','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22text-center\x20text-lg\x20space-y-4\x20my-8\x20p-6\x20rounded-lg\x22\x20style=\x22background:\x20var(--card-bg);\x20border:\x202px\x20solid\x20var(--card-border);\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>ความยาก:\x20<strong\x20class=\x22text-xl\x22\x20style=\x22color:\x20var(--accent);\x22>','ArrowDown','#player-finished-view\x20h2','เติมแล้ว\x20','#game-view','#player-finished-view','hasMistake','<i\x20class=\x22fas\x20fa-crown\x22></i>','game24-69666','2nhWUeS','admin-settings','values','numQuestions','#player-join-view','classList','includes','#join-game-btn','filled','ไม่สามารถเข้าร่วมได้\x20เกมเริ่มไปแล้ว','documentElement',')</span></div>','ห้องเกมถูกปิดแล้ว','#back-to-lobby-btn','innerHTML','#results-header','get','player-join','ด่าน\x20','#reset-btn','เวลา:\x2000:00','#podium-container','</div>','#admin-lobby-view','/16)','show','appendChild','mixed','#puzzle-progress','.finishTime','#lobby-player-count','Transaction\x20aborted,\x20likely\x20because\x20another\x20player\x20finished\x20first.','#home-btn','#practice-score-display','finishTime','ลองใหม่อีกครั้งนะ','closest','key','uid','difficulty','sidebar-hidden','forEach','admin-lobby','137238MYepbz','.filled','toggle','given','currentLevel','#player-score-display','findIndex','now','toString','คะแนน:\x20','easy','setAttribute','fill','</span><span>','กลับไปหน้าแรก','set','indexOf','className','Error\x20returning\x20to\x20lobby:','Backspace','lobby','#game-code-input','<i\x20class=\x22fas\x20fa-play\x20mr-2\x22></i>เริ่มแข่งขัน','playing','length','puzzle','คุณไขปริศนาสำเร็จ','เยี่ยมมาก!','board','2135064FdsjDt','filter','\x20คะแนน\x20(','game','#game-over-view','keydown','idx','split','Finish\x20attempt\x20failed:','timeLimit','pointerEvents','เวลา:\x20','<i\x20class=\x22fas\x20fa-trophy\x20mr-2\x22></i>หมดเวลา!','เสร็จแล้ว','#player-wait-view','เยี่ยม!\x20ด่านต่อไป:\x20ปานกลาง','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','<div\x20class=\x22player-row\x22><span\x20class=\x22player-name\x22>','sudoku','หมดเวลา!','Error\x20joining\x20game:','value','การเชื่อมต่อล้มเหลว','max','#game-board','none','#themeSelect','เกมจบแล้ว\x20มีผู้ชนะแล้ว!','createElement','ไม่พบห้องเกมนี้','sort','selected','แอดมินได้สร้างห้องใหม่แล้ว','#toggle-sidebar-btn','119wNNiyW','...','exists','random'];_0x5434=function(){return _0x593743;};return _0x5434();}function loadPracticePuzzle(_0x412094){const _0xf846b6=_0x163127,_0x57355f=practicePuzzles[_0x412094];given=_0x57355f['puzzle'][_0xf846b6(0x16a)](),board=_0x57355f['puzzle']['slice'](),solution=_0x57355f['solution'][_0xf846b6(0x16a)](),hasMistake=![],selectedIdx=board[_0xf846b6(0x1a6)]((_0x1e4a58,_0x4f766d)=>!given[_0x4f766d]);if(selectedIdx<0x0)selectedIdx=0x0;targetNumberDisplay[_0xf846b6(0x1e7)]='ฝึกซ้อม:\x20'+_0x412094,renderSudoku();}function startPracticeTimer(){const _0x546ae7=_0x163127;if(timerInterval)clearInterval(timerInterval);let _0x36905f=gameSettings[_0x546ae7(0x1c6)];const _0x19730d=()=>{const _0x5f573d=_0x546ae7,_0x3f5c04=String(Math[_0x5f573d(0x12d)](_0x36905f/0x3c))[_0x5f573d(0x15e)](0x2,'0'),_0x75af26=String(_0x36905f%0x3c)['padStart'](0x2,'0');gameTimerEl[_0x5f573d(0x1e7)]='เวลา:\x20'+_0x3f5c04+':'+_0x75af26;};_0x19730d(),timerInterval=setInterval(()=>{const _0x3f98a8=_0x546ae7;_0x36905f--,_0x19730d(),_0x36905f<=0x0&&(clearInterval(timerInterval),gameBoard[_0x3f98a8(0x17a)]['add'](_0x3f98a8(0x150)),playerFinishedView[_0x3f98a8(0x17a)][_0x3f98a8(0x153)](_0x3f98a8(0x150)),$(_0x3f98a8(0x16e))['textContent']=_0x3f98a8(0x1d0),$(_0x3f98a8(0x120))[_0x3f98a8(0x1e7)]=_0x3f98a8(0x198));},0x3e8);}async function forceEndGame(){const _0x4b0ede=_0x163127;if(!isHost||!currentGameId)return;const _0x354f23=doc(db,_0x4b0ede(0x136),currentGameId),_0x1b05aa=await getDoc(_0x354f23);_0x1b05aa[_0x4b0ede(0x1e1)]()&&_0x1b05aa['data']()['status']===_0x4b0ede(0x1b7)&&await updateDoc(_0x354f23,{'status':_0x4b0ede(0x117),'winner':null});}async function returnToLobby(){const _0x5c5276=_0x163127;if(!isHost||!currentGameId)return;const _0x1089b8=doc(db,_0x5c5276(0x136),currentGameId);try{await updateDoc(_0x1089b8,{'status':_0x5c5276(0x1b4),'players':{},'winner':deleteField(),'sudoku':deleteField(),'puzzles':deleteField(),'startTime':deleteField(),'gameMode':deleteField()}),showView(_0x5c5276(0x19f));}catch(_0xb003e0){console[_0x5c5276(0x165)](_0x5c5276(0x1b2),_0xb003e0),toast(_0x5c5276(0x164));}}async function handleJoinGame(){const _0x47ae83=_0x163127,_0x4af0d3=$(_0x47ae83(0x1b5))[_0x47ae83(0x1d2)],_0x4144f2=$(_0x47ae83(0x12b))['value']['trim']();if(!_0x4af0d3||!_0x4144f2)return toast(_0x47ae83(0x1ef));currentGameId=_0x4af0d3,currentPlayerName=_0x4144f2;const _0x14f2fb=doc(db,_0x47ae83(0x136),currentGameId);try{await runTransaction(db,async _0x303dea=>{const _0x2631ac=_0x47ae83,_0x597674=await _0x303dea[_0x2631ac(0x185)](_0x14f2fb);if(!_0x597674[_0x2631ac(0x1e1)]())throw new Error(_0x2631ac(0x1da));const _0x5e2d97=_0x597674[_0x2631ac(0x159)]();if(_0x5e2d97[_0x2631ac(0x1ea)]!==_0x2631ac(0x1b4))throw new Error(_0x2631ac(0x17e));let _0x3b1062=_0x4144f2;_0x5e2d97[_0x2631ac(0x151)]&&_0x5e2d97[_0x2631ac(0x151)][_0x3b1062]&&(_0x3b1062=''+_0x4144f2+rnd(0xa,0x63),toast(_0x2631ac(0x14f)+_0x3b1062+_0x2631ac(0x122))),currentPlayerName=_0x3b1062,_0x303dea[_0x2631ac(0x12c)](_0x14f2fb,{[_0x2631ac(0x112)+_0x3b1062]:{'joined':!![]}});}),isHost=![],document[_0x47ae83(0x111)][_0x47ae83(0x17a)]['add'](_0x47ae83(0x1ec)),toast(_0x47ae83(0x1f6)),listenForGameUpdates(currentGameId);}catch(_0x5c1ca6){console[_0x47ae83(0x165)](_0x47ae83(0x1d1),_0x5c1ca6),toast(_0x5c1ca6['message']);}}function listenForGameUpdates(_0x4882b9){if(unsubscribeGameListener)unsubscribeGameListener();const _0x120eb9=doc(db,'games',_0x4882b9);unsubscribeGameListener=onSnapshot(_0x120eb9,_0x51508d=>{const _0xe6f899=_0x2df9;if(!_0x51508d['exists']()){toast(_0xe6f899(0x181));if(unsubscribeGameListener)unsubscribeGameListener();if(unsubscribePlayerStateListener)unsubscribePlayerStateListener();timerInterval&&(clearInterval(timerInterval),timerInterval=null);isHost=![],document[_0xe6f899(0x111)][_0xe6f899(0x17a)][_0xe6f899(0x153)](_0xe6f899(0x1ec)),showView(_0xe6f899(0x186));return;}const _0xf524ef=_0x51508d['data'](),_0x1a9b9c=_0xf524ef[_0xe6f899(0x1ea)];if(!isHost&&previousGameStatus==='finished'&&_0x1a9b9c===_0xe6f899(0x1b4)){if(unsubscribeGameListener)unsubscribeGameListener();if(unsubscribePlayerStateListener)unsubscribePlayerStateListener();if(timerInterval)clearInterval(timerInterval);currentGameId=null,currentPlayerName=null,toast(_0xe6f899(0x1dd)),document['body'][_0xe6f899(0x17a)][_0xe6f899(0x153)](_0xe6f899(0x1ec)),showView(_0xe6f899(0x186)),previousGameStatus=null;return;}previousGameStatus=_0x1a9b9c;if(_0x1a9b9c===_0xe6f899(0x1b4)){timerInterval&&(clearInterval(timerInterval),timerInterval=null);if(unsubscribePlayerStateListener)unsubscribePlayerStateListener();if(isHost)showView('admin-lobby'),renderLobbyPlayers(_0xf524ef[_0xe6f899(0x151)]);else showView(_0xe6f899(0x10e));}else{if(_0x1a9b9c===_0xe6f899(0x1b7)){startOrUpdateTimer(_0xf524ef),showView(_0xe6f899(0x1c0));if(isHost){renderAdminGameView(_0xf524ef);if(_0xf524ef[_0xe6f899(0x134)][_0xe6f899(0x13c)]===_0xe6f899(0x139)){const _0x1bdb01=Object[_0xe6f899(0x177)](_0xf524ef[_0xe6f899(0x151)]||{});_0x1bdb01[_0xe6f899(0x1b8)]>0x0&&_0x1bdb01[_0xe6f899(0x128)](_0x1bd6d8=>_0x1bd6d8['finishTime'])&&forceEndGame();}}else renderPlayerGameView(_0xf524ef),listenForPlayerState(_0x4882b9,currentPlayerName);}else{if(_0x1a9b9c===_0xe6f899(0x117)){timerInterval&&(clearInterval(timerInterval),timerInterval=null);if(unsubscribePlayerStateListener)unsubscribePlayerStateListener();renderGameOverView(_0xf524ef);}}}});}function listenForPlayerState(_0x2f106e,_0x3e519e){const _0x224363=_0x163127;if(unsubscribePlayerStateListener)return;const _0xe89e90=doc(db,_0x224363(0x136),_0x2f106e,_0x224363(0x168),_0x3e519e);unsubscribePlayerStateListener=onSnapshot(_0xe89e90,_0x1ed00e=>{const _0x30caa0=_0x224363;if(_0x1ed00e[_0x30caa0(0x1e1)]()){const _0x4a9fa9=_0x1ed00e['data']();board=(_0x4a9fa9[_0x30caa0(0x1bc)]||'')[_0x30caa0(0x1c4)]('')[_0x30caa0(0x10d)](_0x33c0dd=>parseInt(_0x33c0dd,0xa)||0x0),hasMistake=!!_0x4a9fa9[_0x30caa0(0x172)],renderSudoku();}});}function renderLobbyPlayers(_0x2c818c){const _0x418778=_0x163127,_0x37ff7a=Object[_0x418778(0x144)](_0x2c818c||{});lobbyPlayerCount[_0x418778(0x1e7)]=_0x37ff7a['length'],lobbyPlayerNameList[_0x418778(0x183)]=_0x37ff7a[_0x418778(0x1b8)]===0x0?'<p\x20class=\x22text-gray-500\x20text-center\x20w-full\x22>ยังไม่มีใครเข้าร่วม...</p>':_0x37ff7a[_0x418778(0x10d)](_0x29d320=>'<div\x20class=\x22lobby-player-tag\x22>'+_0x29d320+_0x418778(0x18b))['join']('');}function startOrUpdateTimer(_0x1efa1f){const _0x1bec3d=_0x163127;if(timerInterval)clearInterval(timerInterval);const _0x53d77f=_0x1efa1f[_0x1bec3d(0x134)]||gameSettings,_0x2dda8d=_0x1efa1f['startTime'][_0x1bec3d(0x138)]();timerInterval=setInterval(()=>{const _0x2422b0=_0x1bec3d,_0x18f036=Math[_0x2422b0(0x12d)]((Date['now']()-_0x2dda8d)/0x3e8),_0x5ba5c1=_0x53d77f['timeLimit']-_0x18f036;if(_0x5ba5c1<=0x0){clearInterval(timerInterval),gameTimerEl[_0x2422b0(0x1e7)]=_0x2422b0(0x189);if(isHost)forceEndGame();}else{const _0x4d9cb6=String(Math[_0x2422b0(0x12d)](_0x5ba5c1/0x3c))['padStart'](0x2,'0'),_0x38f4a3=String(_0x5ba5c1%0x3c)['padStart'](0x2,'0');gameTimerEl['textContent']=_0x2422b0(0x1c8)+_0x4d9cb6+':'+_0x38f4a3;}},0x1f4);}function renderAdminGameView(_0xc89938){const _0x45d207=_0x163127;$(_0x45d207(0x1de))['classList'][_0x45d207(0x153)]('hidden'),hostControls['classList'][_0x45d207(0x153)](_0x45d207(0x150));const _0x49633a=_0xc89938[_0x45d207(0x151)]||{},_0x1102f7=Object[_0x45d207(0x145)](_0x49633a)[_0x45d207(0x1db)]((_0x3f6c5c,_0xb2c9b3)=>{const _0x1f78b1=_0x45d207,_0xd11b67=_0x3f6c5c[0x1],_0x43bd4a=_0xb2c9b3[0x1];if((_0xd11b67[_0x1f78b1(0x197)]?0x1:0x0)!==(_0x43bd4a['finishTime']?0x1:0x0))return(_0x43bd4a['finishTime']?0x1:0x0)-(_0xd11b67[_0x1f78b1(0x197)]?0x1:0x0);if((_0xd11b67[_0x1f78b1(0x12e)]||0x0)!==(_0x43bd4a[_0x1f78b1(0x12e)]||0x0))return(_0x43bd4a[_0x1f78b1(0x12e)]||0x0)-(_0xd11b67[_0x1f78b1(0x12e)]||0x0);return(_0x43bd4a[_0x1f78b1(0x17d)]||0x0)-(_0xd11b67[_0x1f78b1(0x17d)]||0x0);});playerList['innerHTML']=_0x1102f7[_0x45d207(0x10d)](([_0x5b38b6,_0xa660e2])=>{const _0x354932=_0x45d207;let _0x1b1618=(_0xa660e2[_0x354932(0x17d)]||0x0)+_0x354932(0x16b);if(_0xa660e2['finishTime'])_0x1b1618=_0x354932(0x1ca);else _0xc89938['gameMode'][_0x354932(0x19c)]===_0x354932(0x190)&&(_0x1b1618=_0x354932(0x187)+(_0xa660e2[_0x354932(0x1a4)]||_0x354932(0x1aa))+'\x20('+(_0xa660e2[_0x354932(0x17d)]||0x0)+_0x354932(0x18d));return _0x354932(0x1ce)+_0x5b38b6+'</span><span\x20class=\x22player-progress\x22>'+(_0xa660e2[_0x354932(0x12e)]||0x0)+_0x354932(0x1bf)+_0x1b1618+_0x354932(0x180);})[_0x45d207(0x125)]('');let _0x497cea;if(_0xc89938[_0x45d207(0x134)]['difficulty']==='mixed'){const _0x229bb4=['easy',_0x45d207(0x10c),_0x45d207(0x11c)];let _0x1ef70d=_0x45d207(0x1aa);const _0x24a05a=Object[_0x45d207(0x177)](_0x49633a);for(const _0x29546a of _0x24a05a){if(_0x29546a[_0x45d207(0x197)])continue;const _0x299a44=_0x29546a['currentLevel']||_0x45d207(0x1aa);_0x229bb4[_0x45d207(0x1b0)](_0x299a44)>_0x229bb4['indexOf'](_0x1ef70d)&&(_0x1ef70d=_0x299a44);}_0x497cea=_0xc89938[_0x45d207(0x11a)]?_0xc89938['puzzles'][_0x1ef70d]:null;}else _0x497cea=_0xc89938[_0x45d207(0x1cf)];if(!_0x497cea)return;const _0x40ab78=_0x497cea[_0x45d207(0x1b9)]||[];given=_0x40ab78['slice'](),board=_0x40ab78[_0x45d207(0x16a)](),solution=_0x497cea[_0x45d207(0x10f)]||[],selectedIdx=-0x1,renderSudoku(),$$('#sudoku\x20.cell')[_0x45d207(0x19e)](_0x356b18=>_0x356b18[_0x45d207(0x1e3)][_0x45d207(0x1c7)]=_0x45d207(0x1d6)),pickerEl[_0x45d207(0x17a)][_0x45d207(0x1e4)](_0x45d207(0x150)),$(_0x45d207(0x188))[_0x45d207(0x17a)][_0x45d207(0x1e4)]('hidden'),$('#home-btn')[_0x45d207(0x17a)][_0x45d207(0x1e4)](_0x45d207(0x150));}function renderPlayerGameView(_0x46becd){const _0x4cc02b=_0x163127;$(_0x4cc02b(0x1de))[_0x4cc02b(0x17a)]['add'](_0x4cc02b(0x150));const _0xbd5a13=(_0x46becd['players']||{})[currentPlayerName];if(!_0xbd5a13)return;playerScoreDisplay[_0x4cc02b(0x1e7)]=_0x4cc02b(0x1a9)+(_0xbd5a13['score']||0x0),playerScoreDisplay['classList'][_0x4cc02b(0x153)](_0x4cc02b(0x150));let _0x244070;if(_0x46becd[_0x4cc02b(0x134)]['difficulty']===_0x4cc02b(0x190)){const _0x1bdfb5=_0xbd5a13[_0x4cc02b(0x1a4)]||_0x4cc02b(0x1aa);_0x244070=_0x46becd[_0x4cc02b(0x11a)][_0x1bdfb5],targetNumberDisplay[_0x4cc02b(0x1e7)]=_0x4cc02b(0x187)+_0x1bdfb5;}else _0x244070=_0x46becd[_0x4cc02b(0x1cf)],targetNumberDisplay[_0x4cc02b(0x1e7)]=_0x4cc02b(0x152);if(!_0x244070)return;given=(_0x244070[_0x4cc02b(0x1b9)]||[])[_0x4cc02b(0x16a)](),solution=(_0x244070[_0x4cc02b(0x10f)]||[])[_0x4cc02b(0x16a)](),selectedIdx=board[_0x4cc02b(0x1a6)]((_0x19666d,_0x4cd266)=>!given[_0x4cd266]);if(selectedIdx<0x0)selectedIdx=0x0;_0xbd5a13[_0x4cc02b(0x197)]?(gameBoard['classList']['add'](_0x4cc02b(0x150)),playerFinishedView[_0x4cc02b(0x17a)][_0x4cc02b(0x153)]('hidden')):(gameBoard[_0x4cc02b(0x17a)][_0x4cc02b(0x153)]('hidden'),playerFinishedView[_0x4cc02b(0x17a)][_0x4cc02b(0x1e4)](_0x4cc02b(0x150)));}function renderGameOverView(_0x55932a){const _0x4f9292=_0x163127,_0x42787f=_0x55932a[_0x4f9292(0x127)],_0x442fea=$(_0x4f9292(0x184));_0x42787f?_0x442fea[_0x4f9292(0x183)]='<i\x20class=\x22fas\x20fa-crown\x20mr-2\x22></i>ผู้ชนะคือ\x20'+_0x42787f+'!':_0x442fea[_0x4f9292(0x183)]=_0x4f9292(0x1c9);const _0xc94ba4=_0x55932a[_0x4f9292(0x151)]||{},_0x1b2744=Object['entries'](_0xc94ba4)['sort'](([,_0xb228c],[,_0x54aeaf])=>{const _0x31429f=_0x4f9292;if((_0xb228c[_0x31429f(0x12e)]||0x0)!==(_0x54aeaf[_0x31429f(0x12e)]||0x0))return(_0x54aeaf[_0x31429f(0x12e)]||0x0)-(_0xb228c[_0x31429f(0x12e)]||0x0);if(_0x54aeaf['finishTime']&&_0xb228c['finishTime'])return _0xb228c[_0x31429f(0x197)][_0x31429f(0x138)]()-_0x54aeaf[_0x31429f(0x197)][_0x31429f(0x138)]();if(_0x54aeaf['finishTime'])return 0x1;if(_0xb228c['finishTime'])return-0x1;return(_0x54aeaf[_0x31429f(0x17d)]||0x0)-(_0xb228c[_0x31429f(0x17d)]||0x0);});podiumContainer[_0x4f9292(0x183)]='',otherRankingsList['innerHTML']='';const _0x2f3037=_0x1b2744[_0x4f9292(0x16a)](0x0,0x3),_0x17632d=_0x1b2744[_0x4f9292(0x16a)](0x3);_0x2f3037[_0x4f9292(0x19e)](([_0x551e2a,_0x971c],_0x28511b)=>{const _0x25602c=_0x4f9292,_0x44159f=_0x28511b+0x1,_0x1bcd84=document[_0x25602c(0x1d9)]('div');_0x1bcd84['className']=_0x25602c(0x147)+_0x44159f,_0x1bcd84[_0x25602c(0x183)]=(_0x44159f===0x1&&_0x42787f?_0x25602c(0x173):'')+_0x25602c(0x132)+_0x551e2a+_0x25602c(0x126)+(_0x971c[_0x25602c(0x12e)]||0x0)+_0x25602c(0x119)+_0x44159f+_0x25602c(0x18b),podiumContainer[_0x25602c(0x18f)](_0x1bcd84);});for(let _0x4b19eb=_0x1b2744[_0x4f9292(0x1b8)];_0x4b19eb<0x3;_0x4b19eb++){const _0x174bcd=_0x4b19eb+0x1,_0x59d898=document[_0x4f9292(0x1d9)]('div');_0x59d898[_0x4f9292(0x1b1)]=_0x4f9292(0x147)+_0x174bcd,podiumContainer['appendChild'](_0x59d898);}if(_0x17632d[_0x4f9292(0x1b8)]>0x0)otherRankingsContainer[_0x4f9292(0x17a)][_0x4f9292(0x153)](_0x4f9292(0x150)),otherRankingsList[_0x4f9292(0x183)]=_0x17632d[_0x4f9292(0x10d)](([_0xce9ff6,_0x1d56f2],_0xbd93fb)=>_0x4f9292(0x1e5)+(_0xbd93fb+0x4)+'.\x20'+_0xce9ff6+_0x4f9292(0x1ad)+(_0x1d56f2['score']||0x0)+_0x4f9292(0x1f1))[_0x4f9292(0x125)]('');else otherRankingsContainer[_0x4f9292(0x17a)][_0x4f9292(0x1e4)](_0x4f9292(0x150));if(isHost)$('#back-to-lobby-btn')[_0x4f9292(0x17a)][_0x4f9292(0x153)](_0x4f9292(0x150));else $(_0x4f9292(0x182))[_0x4f9292(0x17a)][_0x4f9292(0x1e4)](_0x4f9292(0x150));showView('game-over');}function renderPracticeGameOverView(){const _0x6d1636=_0x163127,_0x45fa4e=gameTimerEl[_0x6d1636(0x1e7)]['replace'](_0x6d1636(0x1c8),''),_0x561ad5=_0x45fa4e['split'](':'),_0x2eafd5=parseInt(_0x561ad5[0x0],0xa)*0x3c+parseInt(_0x561ad5[0x1],0xa),_0xafb33a=gameSettings['timeLimit']-_0x2eafd5,_0x4a6e49=String(Math['floor'](_0xafb33a/0x3c))[_0x6d1636(0x15e)](0x2,'0'),_0x5b938b=String(_0xafb33a%0x3c)['padStart'](0x2,'0'),_0x19e9df=_0x4a6e49+':'+_0x5b938b;resultsHeader[_0x6d1636(0x183)]=_0x6d1636(0x118),podiumContainer[_0x6d1636(0x183)]=_0x6d1636(0x16c)+gameSettings[_0x6d1636(0x19c)]+'</strong></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>เวลาที่ใช้:\x20<strong\x20class=\x22text-xl\x22\x20style=\x22color:\x20var(--accent);\x22>'+_0x19e9df+'</strong></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',otherRankingsContainer[_0x6d1636(0x17a)][_0x6d1636(0x1e4)](_0x6d1636(0x150));const _0x213eb0=$('#back-to-lobby-btn');_0x213eb0[_0x6d1636(0x1e7)]=_0x6d1636(0x1ae),_0x213eb0['classList'][_0x6d1636(0x153)](_0x6d1636(0x150)),_0x213eb0[_0x6d1636(0x15c)]=()=>$(_0x6d1636(0x195))[_0x6d1636(0x141)](),showView(_0x6d1636(0x133));}let syncTimer=null;function scheduleBoardSync(){if(isPracticeMode||!currentGameId||!currentPlayerName)return;if(syncTimer)clearTimeout(syncTimer);syncTimer=setTimeout(async()=>{const _0x229d89=_0x2df9;try{const _0x45d326=board[_0x229d89(0x1be)](_0x24e9fc=>_0x24e9fc!==0x0)[_0x229d89(0x1b8)],_0x351439=doc(db,_0x229d89(0x136),currentGameId,_0x229d89(0x168),currentPlayerName);await updateDoc(_0x351439,{'board':board['join'](''),'hasMistake':hasMistake});const _0x45ebee=doc(db,'games',currentGameId);await updateDoc(_0x45ebee,{[_0x229d89(0x112)+currentPlayerName+_0x229d89(0x1a1)]:_0x45d326});}catch(_0x249f7a){console[_0x229d89(0x167)](_0x229d89(0x13b),_0x249f7a);}},0xc8);}async function tryFinish(){const _0x341fca=_0x163127;if(isPracticeMode){if(!isSolved())return;const _0x5f28fe=gameTimerEl[_0x341fca(0x1e7)]['replace']('เวลา:\x20',''),_0x3fc2dd=_0x5f28fe[_0x341fca(0x1c4)](':'),_0x28d2c2=parseInt(_0x3fc2dd[0x0],0xa)*0x3c+parseInt(_0x3fc2dd[0x1],0xa),_0x32bc63=0x64+_0x28d2c2+(hasMistake?0x0:0x32);if(gameSettings[_0x341fca(0x19c)]===_0x341fca(0x190)){if(currentPracticeLevel==='easy'){currentPracticeLevel=_0x341fca(0x10c),toast(_0x341fca(0x1cc),0x9c4),loadPracticePuzzle(_0x341fca(0x10c));return;}else{if(currentPracticeLevel===_0x341fca(0x10c)){currentPracticeLevel='hard',toast('สุดยอด!\x20ด่านต่อไป:\x20ยาก',0x9c4),loadPracticePuzzle(_0x341fca(0x11c));return;}}}if(timerInterval)clearInterval(timerInterval);gameBoard['classList'][_0x341fca(0x1e4)](_0x341fca(0x150)),playerFinishedView[_0x341fca(0x17a)][_0x341fca(0x153)](_0x341fca(0x150)),$(_0x341fca(0x16e))[_0x341fca(0x1e7)]=_0x341fca(0x1bb),$(_0x341fca(0x120))[_0x341fca(0x1e7)]=_0x341fca(0x1ba),$(_0x341fca(0x196))[_0x341fca(0x183)]=_0x341fca(0x148)+_0x32bc63+_0x341fca(0x1cd),setTimeout(()=>{renderPracticeGameOverView();},0x7d0);return;}if(syncTimer)clearTimeout(syncTimer);const _0x92b98d=doc(db,_0x341fca(0x136),currentGameId);try{await runTransaction(db,async _0x5f2102=>{const _0x51c7b7=_0x341fca,_0xbf2d84=await _0x5f2102[_0x51c7b7(0x185)](_0x92b98d);if(!_0xbf2d84[_0x51c7b7(0x1e1)]())throw new Error(_0x51c7b7(0x1f0));const _0x5b3aa6=_0xbf2d84[_0x51c7b7(0x159)]();if(_0x5b3aa6['status']!==_0x51c7b7(0x1b7))return;const _0xa50a8f=(_0x5b3aa6[_0x51c7b7(0x151)]||{})[currentPlayerName];if(!_0xa50a8f)throw new Error(_0x51c7b7(0x1f2));if(_0xa50a8f[_0x51c7b7(0x197)])return;const _0x2cd0da=board;let _0x1524d5,_0x54e85e=_0x51c7b7(0x160);_0x5b3aa6[_0x51c7b7(0x134)][_0x51c7b7(0x19c)]===_0x51c7b7(0x190)?(_0x54e85e=_0xa50a8f[_0x51c7b7(0x1a4)]||'easy',_0x1524d5=_0x5b3aa6['puzzles'][_0x54e85e][_0x51c7b7(0x10f)]):_0x1524d5=_0x5b3aa6[_0x51c7b7(0x1cf)][_0x51c7b7(0x10f)];for(let _0x13159d=0x0;_0x13159d<0x10;_0x13159d++){if(_0x2cd0da[_0x13159d]!==_0x1524d5[_0x13159d])return;}const _0x26586c=_0x5b3aa6['startTime'][_0x51c7b7(0x138)](),_0x3b1e3b=Math[_0x51c7b7(0x12d)]((Date[_0x51c7b7(0x1a7)]()-_0x26586c)/0x3e8),_0x2c1b98=Math[_0x51c7b7(0x1d4)](0x0,_0x5b3aa6[_0x51c7b7(0x134)][_0x51c7b7(0x1c6)]-_0x3b1e3b),_0x2ceac9=0x64+_0x2c1b98+(hasMistake?0x0:0x32),_0x410eb9={};if(_0x5b3aa6['gameMode'][_0x51c7b7(0x19c)]===_0x51c7b7(0x190)){const _0x5d78c8=doc(db,_0x51c7b7(0x136),currentGameId,_0x51c7b7(0x168),currentPlayerName);if(_0x54e85e==='easy')_0x410eb9['players.'+currentPlayerName+_0x51c7b7(0x149)]=_0x51c7b7(0x10c),_0x410eb9[_0x51c7b7(0x112)+currentPlayerName+_0x51c7b7(0x162)]=increment(_0x2ceac9),_0x5f2102['set'](_0x5d78c8,{'board':_0x5b3aa6['puzzles'][_0x51c7b7(0x10c)]['puzzle'][_0x51c7b7(0x125)](''),'hasMistake':![]});else _0x54e85e==='medium'?(_0x410eb9[_0x51c7b7(0x112)+currentPlayerName+_0x51c7b7(0x149)]=_0x51c7b7(0x11c),_0x410eb9[_0x51c7b7(0x112)+currentPlayerName+_0x51c7b7(0x162)]=increment(_0x2ceac9),_0x5f2102[_0x51c7b7(0x1af)](_0x5d78c8,{'board':_0x5b3aa6[_0x51c7b7(0x11a)][_0x51c7b7(0x11c)][_0x51c7b7(0x1b9)][_0x51c7b7(0x125)](''),'hasMistake':![]})):(_0x410eb9[_0x51c7b7(0x112)+currentPlayerName+_0x51c7b7(0x162)]=increment(_0x2ceac9),_0x410eb9[_0x51c7b7(0x112)+currentPlayerName+_0x51c7b7(0x192)]=serverTimestamp(),_0x5b3aa6[_0x51c7b7(0x134)][_0x51c7b7(0x13c)]===_0x51c7b7(0x154)&&(_0x410eb9[_0x51c7b7(0x1ea)]=_0x51c7b7(0x117),_0x410eb9[_0x51c7b7(0x127)]=currentPlayerName));}else _0x410eb9['players.'+currentPlayerName+_0x51c7b7(0x162)]=increment(_0x2ceac9),_0x410eb9[_0x51c7b7(0x112)+currentPlayerName+_0x51c7b7(0x192)]=serverTimestamp(),_0x5b3aa6['gameMode'][_0x51c7b7(0x13c)]===_0x51c7b7(0x154)&&(_0x410eb9['status']='finished',_0x410eb9[_0x51c7b7(0x127)]=currentPlayerName);_0x5f2102['update'](_0x92b98d,_0x410eb9);});}catch(_0x24b0da){_0x24b0da['message'][_0x341fca(0x17b)](_0x341fca(0x114))?(console[_0x341fca(0x129)](_0x341fca(0x194)),toast(_0x341fca(0x1d8))):(console[_0x341fca(0x165)](_0x341fca(0x1c5),_0x24b0da),toast('เกิดข้อผิดพลาดในการจบเกม'));}}$(_0x163127(0x13d))[_0x163127(0x13e)]('click',()=>showView(_0x163127(0x146))),$('#admin-back-btn')['addEventListener'](_0x163127(0x141),()=>showView(_0x163127(0x186))),$(_0x163127(0x169))[_0x163127(0x13e)]('click',async()=>{const _0x1edf0f=_0x163127;if($(_0x1edf0f(0x14b))[_0x1edf0f(0x1d2)]==='8899')await createGameRoom();else toast('รหัสผ่านไม่ถูกต้อง');}),$(_0x163127(0x17c))[_0x163127(0x13e)](_0x163127(0x141),handleJoinGame),$('#start-practice-btn')[_0x163127(0x13e)]('click',()=>{const _0x2352a3=_0x163127;isPracticeMode=!![],isHost=!![],showView(_0x2352a3(0x176)),$('#competition-settings')[_0x2352a3(0x17a)]['add'](_0x2352a3(0x150)),$(_0x2352a3(0x11b))[_0x2352a3(0x183)]=_0x2352a3(0x15a);}),$(_0x163127(0x130))['addEventListener']('click',()=>{const _0x302996=_0x163127;isPracticeMode=![],showView(_0x302996(0x176)),$(_0x302996(0x143))[_0x302996(0x17a)][_0x302996(0x153)](_0x302996(0x150)),$(_0x302996(0x11b))[_0x302996(0x183)]=_0x302996(0x1b6);}),$('#cancel-settings-btn')[_0x163127(0x13e)](_0x163127(0x141),()=>{const _0x10fa73=_0x163127;isHost&&!currentGameId&&isPracticeMode?(isPracticeMode=![],isHost=![],showView(_0x10fa73(0x186))):showView(_0x10fa73(0x19f));}),$('#start-game-btn')['addEventListener'](_0x163127(0x141),()=>{isPracticeMode?startPracticeGame():handleStartGame();}),$(_0x163127(0x15b))[_0x163127(0x13e)](_0x163127(0x141),forceEndGame),$(_0x163127(0x182))[_0x163127(0x13e)]('click',returnToLobby),$(_0x163127(0x195))[_0x163127(0x13e)](_0x163127(0x141),()=>{const _0x56f30d=_0x163127;if(unsubscribeGameListener)unsubscribeGameListener();unsubscribePlayerStateListener&&(unsubscribePlayerStateListener(),unsubscribePlayerStateListener=null);if(timerInterval)clearInterval(timerInterval);currentGameId=null,currentPlayerName=null,isHost=![],isPracticeMode=![],practicePuzzles=null,currentPracticeLevel=null,document[_0x56f30d(0x111)][_0x56f30d(0x17a)][_0x56f30d(0x153)](_0x56f30d(0x1ec)),showView('player-join'),$('#player-finished-view\x20h2')[_0x56f30d(0x1e7)]='เสร็จแล้ว!',$(_0x56f30d(0x120))['textContent']=_0x56f30d(0x12f);}),$(_0x163127(0x188))[_0x163127(0x13e)](_0x163127(0x141),()=>{for(let _0x20bb61=0x0;_0x20bb61<0x10;_0x20bb61++)board[_0x20bb61]=given[_0x20bb61];hasMistake=![],renderSudoku(),scheduleBoardSync();}),sudokuEl[_0x163127(0x13e)](_0x163127(0x141),_0x13f39e=>{const _0x25c6e5=_0x163127,_0x451d82=_0x13f39e[_0x25c6e5(0x14e)][_0x25c6e5(0x199)](_0x25c6e5(0x142));if(!_0x451d82)return;const _0x88eee=parseInt(_0x451d82[_0x25c6e5(0x137)][_0x25c6e5(0x1c3)],0xa);if(!given[_0x88eee])selectCell(_0x88eee);}),$(_0x163127(0x1de))[_0x163127(0x13e)](_0x163127(0x141),()=>{const _0x740271=_0x163127;$(_0x740271(0x140))['classList'][_0x740271(0x1a2)](_0x740271(0x19d));}),$(_0x163127(0x110))[_0x163127(0x13e)](_0x163127(0x124),_0x200ab2=>{const _0x350123=_0x163127,_0x6aa859=$('#time-limit-input');switch(_0x200ab2[_0x350123(0x14e)]['value']){case _0x350123(0x1aa):_0x6aa859[_0x350123(0x1d2)]=0x1e;break;case _0x350123(0x10c):_0x6aa859[_0x350123(0x1d2)]=0x3c;break;case _0x350123(0x11c):_0x6aa859['value']=0x78;break;case _0x350123(0x190):_0x6aa859[_0x350123(0x1d2)]=0xd2;break;}}),window[_0x163127(0x13e)]('beforeunload',()=>{const _0x165a9c=_0x163127;isHost&&currentGameId&&deleteDoc(doc(db,_0x165a9c(0x136),currentGameId));}),initialize(),showView(_0x163127(0x186));
