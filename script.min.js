const _0x2e06fa=_0x24df;(function(_0x44dfd6,_0x7abb85){const _0x442698=_0x24df,_0x58adbb=_0x44dfd6();while(!![]){try{const _0x1d0bf2=-parseInt(_0x442698(0x110))/0x1+parseInt(_0x442698(0x191))/0x2+parseInt(_0x442698(0xf3))/0x3*(parseInt(_0x442698(0x154))/0x4)+parseInt(_0x442698(0x1c1))/0x5*(-parseInt(_0x442698(0x156))/0x6)+-parseInt(_0x442698(0x142))/0x7*(-parseInt(_0x442698(0xde))/0x8)+-parseInt(_0x442698(0xfc))/0x9+-parseInt(_0x442698(0x106))/0xa;if(_0x1d0bf2===_0x7abb85)break;else _0x58adbb['push'](_0x58adbb['shift']());}catch(_0x6dcea9){_0x58adbb['push'](_0x58adbb['shift']());}}}(_0x2e3e,0xa03fd));import{initializeApp}from'https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js';import{getAuth,signInAnonymously,onAuthStateChanged}from'https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js';import{getFirestore,doc,getDoc,setDoc,updateDoc,onSnapshot,serverTimestamp,runTransaction,deleteDoc,deleteField,increment,collection}from'https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js';const firebaseConfig={'apiKey':_0x2e06fa(0x1b4),'authDomain':'game24-69666.firebaseapp.com','projectId':_0x2e06fa(0x151),'storageBucket':_0x2e06fa(0x103),'messagingSenderId':_0x2e06fa(0x11e),'appId':_0x2e06fa(0x1a3),'measurementId':_0x2e06fa(0x166)},$=_0x410966=>document[_0x2e06fa(0x13c)](_0x410966),$$=_0x1c3f01=>Array[_0x2e06fa(0x145)](document[_0x2e06fa(0x1a6)](_0x1c3f01)),playerJoinView=$('#player-join-view'),playerWaitView=$(_0x2e06fa(0xea)),adminLobbyView=$(_0x2e06fa(0x10e)),gameView=$(_0x2e06fa(0x144)),adminLoginModal=$(_0x2e06fa(0x158)),adminSettingsModal=$(_0x2e06fa(0x126)),gameOverView=$(_0x2e06fa(0x11c)),sudokuEl=$(_0x2e06fa(0x131)),pickerEl=$(_0x2e06fa(0x1b7)),playerList=$(_0x2e06fa(0x198)),lobbyPlayerNameList=$(_0x2e06fa(0x15d)),lobbyPlayerCount=$(_0x2e06fa(0x117)),hostControls=$(_0x2e06fa(0x1a9)),toastEl=$('#toast'),gameCodeDisplay=$(_0x2e06fa(0xf5)),gameTimerEl=$(_0x2e06fa(0x1bb)),puzzleProgressEl=$(_0x2e06fa(0x196)),playerScoreDisplay=$('#player-score-display'),gameBoard=$(_0x2e06fa(0x179)),playerFinishedView=$(_0x2e06fa(0xe2)),podiumContainer=$(_0x2e06fa(0x1b0)),otherRankingsList=$(_0x2e06fa(0xf1)),otherRankingsContainer=$('#other-rankings-container'),targetNumberDisplay=$(_0x2e06fa(0xf2));let db,auth,userId,currentPlayerName,isHost=![],currentGameId=null,unsubscribeGameListener=null,unsubscribePlayerStateListener=null,timerInterval=null,allPlayerStates={},unsubscribeAllPlayerStates=null,latestGameData={},previousGameStatus=null,isPracticeMode=![],practicePuzzles=null,currentPracticeLevel=null,given=new Array(0x10)[_0x2e06fa(0x180)](0x0),board=new Array(0x10)['fill'](0x0),solution=new Array(0x10)[_0x2e06fa(0x180)](0x0),selectedIdx=-0x1,hasMistake=![],gameSettings={'timeLimit':0x3c,'resultDisplayMode':_0x2e06fa(0x108),'difficulty':_0x2e06fa(0xf7),'numQuestions':0x1};function toast(_0x31fdf6,_0x16c6dc=0x7d0){const _0x3f1dbb=_0x2e06fa;toastEl['textContent']=_0x31fdf6,toastEl[_0x3f1dbb(0x162)][_0x3f1dbb(0x18d)](_0x3f1dbb(0xf0)),setTimeout(()=>toastEl[_0x3f1dbb(0x162)][_0x3f1dbb(0x14c)](_0x3f1dbb(0xf0)),_0x16c6dc);}const rnd=(_0x18694e,_0x41677a)=>Math[_0x2e06fa(0x10c)](Math[_0x2e06fa(0x1a4)]()*(_0x41677a-_0x18694e+0x1))+_0x18694e,themeKey=_0x2e06fa(0x1ab),themeSelect=$('#themeSelect');function applyTheme(_0xf1e7a2){const _0xcbc9f9=_0x2e06fa;document['documentElement'][_0xcbc9f9(0x174)](_0xcbc9f9(0x115),_0xf1e7a2),localStorage[_0xcbc9f9(0x1ba)](themeKey,_0xf1e7a2);}const savedTheme=localStorage[_0x2e06fa(0x11b)](themeKey),initialTheme=savedTheme||_0x2e06fa(0x19e);applyTheme(initialTheme);themeSelect&&themeSelect['addEventListener']('change',()=>applyTheme(themeSelect[_0x2e06fa(0x113)]));function baseSolved(){return[0x1,0x2,0x3,0x4,0x3,0x4,0x1,0x2,0x2,0x1,0x4,0x3,0x4,0x3,0x2,0x1];}function shuffle(_0x5c0a31){const _0x26918e=_0x2e06fa;for(let _0x1e4685=_0x5c0a31['length']-0x1;_0x1e4685>0x0;_0x1e4685--){const _0x1328c7=Math[_0x26918e(0x10c)](Math[_0x26918e(0x1a4)]()*(_0x1e4685+0x1));[_0x5c0a31[_0x1e4685],_0x5c0a31[_0x1328c7]]=[_0x5c0a31[_0x1328c7],_0x5c0a31[_0x1e4685]];}return _0x5c0a31;}function applyPermutations(_0x165599){const _0x1374f3=_0x2e06fa;let _0x39f4ed=_0x165599[_0x1374f3(0x16a)]();const _0x1918f9=(_0x4b2537,_0x26b218)=>{for(let _0x5d3ea7=0x0;_0x5d3ea7<0x4;_0x5d3ea7++){const _0x319596=_0x4b2537*0x4+_0x5d3ea7,_0x10680b=_0x26b218*0x4+_0x5d3ea7;[_0x39f4ed[_0x319596],_0x39f4ed[_0x10680b]]=[_0x39f4ed[_0x10680b],_0x39f4ed[_0x319596]];}},_0x4c5308=(_0x48dfcd,_0x5bc436)=>{for(let _0x2252df=0x0;_0x2252df<0x4;_0x2252df++){const _0x46940b=_0x2252df*0x4+_0x48dfcd,_0x5032a9=_0x2252df*0x4+_0x5bc436;[_0x39f4ed[_0x46940b],_0x39f4ed[_0x5032a9]]=[_0x39f4ed[_0x5032a9],_0x39f4ed[_0x46940b]];}};if(Math['random']()<0.5)_0x1918f9(0x0,0x1);if(Math[_0x1374f3(0x1a4)]()<0.5)_0x1918f9(0x2,0x3);if(Math[_0x1374f3(0x1a4)]()<0.5)_0x4c5308(0x0,0x1);if(Math[_0x1374f3(0x1a4)]()<0.5)_0x4c5308(0x2,0x3);if(Math['random']()<0.5)for(let _0x2399f6=0x0;_0x2399f6<0x4;_0x2399f6++){const _0x171c6d=0x0*0x4+_0x2399f6,_0x35a12a=0x2*0x4+_0x2399f6;[_0x39f4ed[_0x171c6d],_0x39f4ed[_0x35a12a]]=[_0x39f4ed[_0x35a12a],_0x39f4ed[_0x171c6d]];const _0x442f55=0x1*0x4+_0x2399f6,_0x5a0ec8=0x3*0x4+_0x2399f6;[_0x39f4ed[_0x442f55],_0x39f4ed[_0x5a0ec8]]=[_0x39f4ed[_0x5a0ec8],_0x39f4ed[_0x442f55]];}if(Math['random']()<0.5)for(let _0xe17b6c=0x0;_0xe17b6c<0x4;_0xe17b6c++){const _0x3c88d6=_0xe17b6c*0x4+0x0,_0x4a52ad=_0xe17b6c*0x4+0x2;[_0x39f4ed[_0x3c88d6],_0x39f4ed[_0x4a52ad]]=[_0x39f4ed[_0x4a52ad],_0x39f4ed[_0x3c88d6]];const _0xd631d0=_0xe17b6c*0x4+0x1,_0xc58b62=_0xe17b6c*0x4+0x3;[_0x39f4ed[_0xd631d0],_0x39f4ed[_0xc58b62]]=[_0x39f4ed[_0xc58b62],_0x39f4ed[_0xd631d0]];}const _0x3da340=[0x0,...shuffle([0x1,0x2,0x3,0x4])];for(let _0x3e48f6=0x0;_0x3e48f6<0x10;_0x3e48f6++)_0x39f4ed[_0x3e48f6]=_0x3da340[_0x39f4ed[_0x3e48f6]];return _0x39f4ed;}function countSolutions(_0x505edf){let _0x3aaed9=_0x505edf['slice'](),_0x40c0dd=0x0;function _0xcd735e(_0x1a9d65,_0x3b3fb3){const _0x28b780=_0x24df,_0x34332e=Math[_0x28b780(0x10c)](_0x1a9d65/0x4),_0x3779ea=_0x1a9d65%0x4;for(let _0x371419=0x0;_0x371419<0x4;_0x371419++){if(_0x3aaed9[_0x34332e*0x4+_0x371419]===_0x3b3fb3&&_0x371419!==_0x3779ea)return![];if(_0x3aaed9[_0x371419*0x4+_0x3779ea]===_0x3b3fb3&&_0x371419!==_0x34332e)return![];}const _0x14e74c=Math[_0x28b780(0x10c)](_0x34332e/0x2)*0x2,_0x7f7b7b=Math[_0x28b780(0x10c)](_0x3779ea/0x2)*0x2;for(let _0x712fec=_0x14e74c;_0x712fec<_0x14e74c+0x2;_0x712fec++)for(let _0x143d3e=_0x7f7b7b;_0x143d3e<_0x7f7b7b+0x2;_0x143d3e++){const _0x45c20f=_0x712fec*0x4+_0x143d3e;if(_0x45c20f!==_0x1a9d65&&_0x3aaed9[_0x45c20f]===_0x3b3fb3)return![];}return!![];}function _0x43fb3f(_0x560444=0x0){while(_0x560444<0x10&&_0x3aaed9[_0x560444]!==0x0)_0x560444++;if(_0x560444===0x10)return _0x40c0dd++,_0x40c0dd;for(let _0x5c906b=0x1;_0x5c906b<=0x4;_0x5c906b++){if(_0xcd735e(_0x560444,_0x5c906b)){_0x3aaed9[_0x560444]=_0x5c906b,_0x43fb3f(_0x560444+0x1);if(_0x40c0dd>0x1)return _0x40c0dd;_0x3aaed9[_0x560444]=0x0;}}return _0x40c0dd;}return _0x43fb3f(0x0);}function makePuzzleByClues(_0x1ca254,_0x4260d5){const _0x26efef=_0x2e06fa;let _0x23b141=_0x1ca254[_0x26efef(0x16a)]();const _0x53cce5=shuffle([...Array(0x10)[_0x26efef(0x181)]()]);let _0x342567=0x0;for(const _0x1f3484 of _0x53cce5){if(0x10-_0x342567<=_0x4260d5)break;const _0x16ca78=_0x23b141[_0x1f3484];_0x23b141[_0x1f3484]=0x0,countSolutions(_0x23b141)!==0x1?_0x23b141[_0x1f3484]=_0x16ca78:_0x342567++;}return _0x23b141;}function _0x2e3e(){const _0x49f024=['entries','กรุณากรอกข้อมูลให้ครบถ้วน','Error\x20returning\x20to\x20lobby:','game24-69666','message','\x20คะแนน</span></li>','4zuOxHE','data','5665236rronou','toMillis','#admin-login-modal','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22player-score\x22>','เวลา:\x20','#admin-login-btn','startTime','#lobby-player-name-list','padStart','map','/16',')</span></div>','classList','Firebase\x20init\x20failed:','.pick','innerHTML','G-B1ZTE90SGG','Sudoku\x204x4','<div\x20class=\x22player-row\x22><span\x20class=\x22player-name\x22>','</span><span\x20class=\x22player-progress\x22>','slice','#competition-settings','dataset','podium-stand\x20podium-','Delete','board','#sudoku\x20.cell','given','</div>','puzzle','setAttribute','className','ArrowUp','sort','replace','#game-board','playerStates','8899','pointerEvents','Game\x20not\x20found','สุดยอด!\x20ด่านต่อไป:\x20ยาก','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22text-lg\x20mt-4\x22>คะแนนรอบนี้:</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22text-4xl\x20font-bold\x22\x20style=\x22color:\x20var(--accent);\x22>','fill','keys','เวลา:\x2000:00','Error\x20joining\x20game:','warn','<i\x20class=\x22fas\x20fa-play\x20mr-2\x22></i>เริ่มแข่งขัน','solution','mixed','conflict','currentUser','[data-idx=\x22','update','#difficulty-select','add','เกมจบแล้ว\x20มีผู้ชนะแล้ว!','every','input[name=\x22resultDisplayMode\x22]:checked','1420190KDrHFy','max','selected','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22text-center\x20text-lg\x20space-y-4\x20my-8\x20p-6\x20rounded-lg\x22\x20style=\x22background:\x20var(--card-bg);\x20border:\x202px\x20solid\x20var(--card-border);\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>ความยาก:\x20<strong\x20class=\x22text-xl\x22\x20style=\x22color:\x20var(--accent);\x22>','ห้องเกมถูกปิดแล้ว','#puzzle-progress','currentLevel','#player-list','<p\x20class=\x22text-gray-500\x20text-center\x20w-full\x22>ยังไม่มีใครเข้าร่วม...</p>','length','lobby','playing','finishTime','contrast','now','key','hidden','trim','1:989271279576:web:43115bbaeeae31160954ad','random','\x20คะแนน</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22rank\x22>','querySelectorAll','#cancel-settings-btn','forEach','#host-controls','split','g24_theme_mp','values','admin-lobby','target','ไม่สามารถเข้าร่วมได้\x20เกมเริ่มไปแล้ว','#podium-container','ฝึกซ้อม:\x20','min','winner','AIzaSyAJsk4l8I8uCYpJY8jZLAlRW1w2qLWN-2o','#back-to-lobby-btn','<i\x20class=\x22fas\x20fa-play\x20mr-2\x22></i>เริ่มฝึกซ้อม','#picker','ด่าน\x20','ArrowDown','setItem','#game-timer','games','รหัสผ่านไม่ถูกต้อง','cell\x20','Transaction\x20aborted,\x20likely\x20because\x20another\x20player\x20finished\x20first.','#practice-score-display','5HXsDMn','hasMistake','</strong></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','sudoku','player-join','#start-practice-btn','easy','กลับไปหน้าแรก','idx','body','เยี่ยม!\x20ด่านต่อไป:\x20ปานกลาง','toggle','.app','admin-settings','.cell','8xbYadS','เกิดข้อผิดพลาดในการกลับสู่ล็อบบี้','addEventListener','resultDisplayMode','#player-finished-view','players.','ไม่พบห้องเกมนี้','puzzles','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22player-name\x22>','filled','click','exists','#player-wait-view','คุณไขปริศนาสำเร็จ','wait','#home-btn','Game\x20does\x20not\x20exist!','docs','show','#other-rankings-list','#target-number-display','3565788ZRZxkj','createElement','#game-code-display','player-view','medium','.finishTime','#time-limit-input','.currentLevel','#game-code-input','7340535xJrpqU','push','การเชื่อมต่อล้มเหลว','#start-game-btn','findIndex','#reset-btn','#end-game-btn','game24-69666.firebasestorage.app','หมดเวลา!','filter','6745220XyMjna','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','immediate','timeLimit','none','style','floor','...','#admin-lobby-view','.filled','26964blyPZR','#player-name-input','set','value','get','data-theme','join','#lobby-player-count','appendChild','คะแนน:\x20','แอดมินได้สร้างห้องใหม่แล้ว','getItem','#game-over-view','log','989271279576','#player-finished-view\x20h2','error','<i\x20class=\x22fas\x20fa-crown\x20mr-2\x22></i>ผู้ชนะคือ\x20','score','Player\x20not\x20found\x20in\x20game','player-wait','#toggle-sidebar-btn','#admin-settings-modal','indexOf','#results-header','gameMode','finished','Backspace','#player-finished-view\x20p','div','\x20คะแนน\x20(','onclick','textContent','#sudoku','ชื่อซ้ำ,\x20เปลี่ยนเป็น\x20','\x20แทน','Finish\x20attempt\x20failed:','<i\x20class=\x22fas\x20fa-trophy\x20mr-2\x22></i>หมดเวลา!','sidebar-hidden','ArrowLeft','game','admin-login','hard','.score','querySelector','#join-game-btn','change','game-over','#admin-back-btn','#admin-password-input','8532979zoZVlR','#admin-icon-btn','#game-view','from','</strong></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>เวลาที่ใช้:\x20<strong\x20class=\x22text-xl\x22\x20style=\x22color:\x20var(--accent);\x22>','difficulty','status','เติมแล้ว\x20','closest','players','remove','beforeunload'];_0x2e3e=function(){return _0x49f024;};return _0x2e3e();}function generateSudoku(_0x3d9ad5){const _0x277cfb=applyPermutations(baseSolved());let _0x2fe8ff={'easy':[0x9,0xa],'medium':[0x7,0x8],'hard':[0x5,0x6]}[_0x3d9ad5]||[0x7,0x8];const _0x423a78=rnd(_0x2fe8ff[0x0],_0x2fe8ff[0x1]);let _0x2c26d8=makePuzzleByClues(_0x277cfb,_0x423a78);if(countSolutions(_0x2c26d8)!==0x1)return generateSudoku(_0x3d9ad5);return{'solution':_0x277cfb,'puzzle':_0x2c26d8};}function cellClasses(_0x101d90){const _0x12242a=_0x2e06fa,_0x3304e1=Math[_0x12242a(0x10c)](_0x101d90/0x4),_0x4edc3c=_0x101d90%0x4,_0x47a7df=[];if(_0x4edc3c===0x1)_0x47a7df[_0x12242a(0xfd)]('bR');if(_0x3304e1===0x1)_0x47a7df[_0x12242a(0xfd)]('bB');return _0x47a7df[_0x12242a(0x116)]('\x20');}function updateBoardFromState(_0x2c05dd){const _0x4b8480=_0x2e06fa;for(let _0x272305=0x0;_0x272305<0x10;_0x272305++){if(board[_0x272305]!==_0x2c05dd[_0x272305]){const _0x64d3d6=sudokuEl[_0x4b8480(0x13c)](_0x4b8480(0x18a)+_0x272305+'\x22]');_0x64d3d6&&(_0x64d3d6['textContent']=_0x2c05dd[_0x272305]?_0x2c05dd[_0x272305]:'');}}board=_0x2c05dd,markConflictsAll(),updateProgressText();}function renderSudoku(){const _0x1c89d9=_0x2e06fa;sudokuEl['innerHTML']='';for(let _0x4c2375=0x0;_0x4c2375<0x10;_0x4c2375++){const _0x50be90=board[_0x4c2375],_0x2b95d1=document[_0x1c89d9(0xf4)](_0x1c89d9(0x12d));_0x2b95d1[_0x1c89d9(0x175)]=_0x1c89d9(0x1be)+cellClasses(_0x4c2375)+'\x20'+(given[_0x4c2375]?_0x1c89d9(0x171):''),_0x2b95d1[_0x1c89d9(0x16c)][_0x1c89d9(0xd7)]=_0x4c2375,_0x2b95d1['textContent']=_0x50be90?_0x50be90:'',!given[_0x4c2375]&&_0x2b95d1[_0x1c89d9(0xe0)](_0x1c89d9(0xe8),()=>selectCell(_0x4c2375)),sudokuEl[_0x1c89d9(0x118)](_0x2b95d1);}if(selectedIdx>=0x0)highlightRelatives(selectedIdx);markConflictsAll(),updateProgressText();}function selectCell(_0x1c7f77){const _0xc66ae4=_0x2e06fa;selectedIdx=_0x1c7f77,$$('.cell')['forEach'](_0x30f7ea=>_0x30f7ea[_0xc66ae4(0x162)]['remove'](_0xc66ae4(0x193),'hl'));const _0x4f5774=$$(_0xc66ae4(0xdd))[_0x1c7f77];_0x4f5774[_0xc66ae4(0x162)][_0xc66ae4(0x18d)](_0xc66ae4(0x193)),highlightRelatives(_0x1c7f77);}function highlightRelatives(_0x2f4d1b){const _0x2c5f3c=_0x2e06fa,_0xeacd2b=Math[_0x2c5f3c(0x10c)](_0x2f4d1b/0x4),_0x454c74=_0x2f4d1b%0x4;$$(_0x2c5f3c(0xdd))[_0x2c5f3c(0x1a8)]((_0x34632e,_0x305bc2)=>{const _0x2311cd=_0x2c5f3c,_0x2a2cdb=Math[_0x2311cd(0x10c)](_0x305bc2/0x4),_0x4b8cf3=_0x305bc2%0x4;(_0x2a2cdb===_0xeacd2b||_0x4b8cf3===_0x454c74||Math[_0x2311cd(0x10c)](_0x2a2cdb/0x2)===Math[_0x2311cd(0x10c)](_0xeacd2b/0x2)&&Math[_0x2311cd(0x10c)](_0x4b8cf3/0x2)===Math[_0x2311cd(0x10c)](_0x454c74/0x2))&&_0x34632e[_0x2311cd(0x162)]['add']('hl');});}function setNumber(_0x140ddb){const _0x23534d=_0x2e06fa;if(selectedIdx<0x0||given[selectedIdx])return;const _0x5c83f6=$$(_0x23534d(0xdd))[selectedIdx];_0x5c83f6[_0x23534d(0x130)]=_0x140ddb?_0x140ddb:'',board[selectedIdx]=_0x140ddb;_0x140ddb!==0x0&&causesConflict(selectedIdx)&&(hasMistake=!![]);markConflictsAll(),updateProgressText(),scheduleBoardSync();if(isSolved())tryFinish();}function markConflictsAll(){const _0x1dfe9e=_0x2e06fa;$$('.cell')[_0x1dfe9e(0x1a8)](_0x581239=>_0x581239[_0x1dfe9e(0x162)][_0x1dfe9e(0x14c)]('conflict','ok'));for(let _0x457792=0x0;_0x457792<0x10;_0x457792++){if(board[_0x457792]!==0x0&&causesConflict(_0x457792))$$(_0x1dfe9e(0xdd))[_0x457792][_0x1dfe9e(0x162)][_0x1dfe9e(0x18d)](_0x1dfe9e(0x188));else board[_0x457792]!==0x0&&$$(_0x1dfe9e(0xdd))[_0x457792][_0x1dfe9e(0x162)][_0x1dfe9e(0x18d)]('ok');}}function causesConflict(_0x12e2f0){const _0x2f843e=_0x2e06fa,_0x4a6f77=board[_0x12e2f0];if(_0x4a6f77===0x0)return![];const _0x267935=Math['floor'](_0x12e2f0/0x4),_0x27c99d=_0x12e2f0%0x4;for(let _0x4aacb6=0x0;_0x4aacb6<0x4;_0x4aacb6++){if(_0x4aacb6!==_0x27c99d&&board[_0x267935*0x4+_0x4aacb6]===_0x4a6f77)return!![];if(_0x4aacb6!==_0x267935&&board[_0x4aacb6*0x4+_0x27c99d]===_0x4a6f77)return!![];}const _0x33f21f=Math[_0x2f843e(0x10c)](_0x267935/0x2)*0x2,_0x3e7205=Math[_0x2f843e(0x10c)](_0x27c99d/0x2)*0x2;for(let _0x14f2e7=_0x33f21f;_0x14f2e7<_0x33f21f+0x2;_0x14f2e7++)for(let _0x52676c=_0x3e7205;_0x52676c<_0x3e7205+0x2;_0x52676c++){const _0x335e65=_0x14f2e7*0x4+_0x52676c;if(_0x335e65!==_0x12e2f0&&board[_0x335e65]===_0x4a6f77)return!![];}return![];}function isSolved(){for(let _0x1ef1bc=0x0;_0x1ef1bc<0x10;_0x1ef1bc++)if(board[_0x1ef1bc]!==solution[_0x1ef1bc])return![];return!![];}function updateProgressText(){const _0x7685eb=_0x2e06fa,_0x306942=board[_0x7685eb(0x105)](_0x5af4c8=>_0x5af4c8!==0x0)['length'];puzzleProgressEl['textContent']=_0x7685eb(0x149)+_0x306942+'/16';}pickerEl[_0x2e06fa(0xe0)]('click',_0x3e6e2f=>{const _0x5dcfd2=_0x2e06fa,_0x5a0444=_0x3e6e2f[_0x5dcfd2(0x1ae)][_0x5dcfd2(0x14a)](_0x5dcfd2(0x164));if(!_0x5a0444)return;setNumber(parseInt(_0x5a0444[_0x5dcfd2(0x16c)]['n'],0xa));}),document[_0x2e06fa(0xe0)]('keydown',_0x331ebc=>{const _0x7221b7=_0x2e06fa;if(selectedIdx<0x0)return;_0x331ebc[_0x7221b7(0x1a0)]>='1'&&_0x331ebc[_0x7221b7(0x1a0)]<='4'&&setNumber(parseInt(_0x331ebc['key'],0xa));(_0x331ebc[_0x7221b7(0x1a0)]===_0x7221b7(0x12b)||_0x331ebc[_0x7221b7(0x1a0)]===_0x7221b7(0x16e)||_0x331ebc[_0x7221b7(0x1a0)]==='0')&&setNumber(0x0);const _0x5099b4=Math[_0x7221b7(0x10c)](selectedIdx/0x4),_0x5f2999=selectedIdx%0x4;if(_0x331ebc[_0x7221b7(0x1a0)]==='ArrowRight')selectCell(_0x5099b4*0x4+Math[_0x7221b7(0x1b2)](_0x5f2999+0x1,0x3));if(_0x331ebc['key']===_0x7221b7(0x137))selectCell(_0x5099b4*0x4+Math[_0x7221b7(0x192)](_0x5f2999-0x1,0x0));if(_0x331ebc[_0x7221b7(0x1a0)]===_0x7221b7(0x1b9))selectCell(Math[_0x7221b7(0x1b2)]((_0x5099b4+0x1)*0x4+_0x5f2999,0xf));if(_0x331ebc[_0x7221b7(0x1a0)]===_0x7221b7(0x176))selectCell(Math[_0x7221b7(0x192)]((_0x5099b4-0x1)*0x4+_0x5f2999,0x0));});async function initialize(){const _0x30a030=_0x2e06fa;try{const _0x30bd48=initializeApp(firebaseConfig);db=getFirestore(_0x30bd48),auth=getAuth(_0x30bd48),onAuthStateChanged(auth,async _0x17a241=>{!_0x17a241&&await signInAnonymously(auth);});}catch(_0x347623){console[_0x30a030(0x120)](_0x30a030(0x163),_0x347623),toast(_0x30a030(0xfe));}}function showView(_0x2127cd){const _0xda768f=_0x2e06fa;[playerJoinView,playerWaitView,adminLoginModal,adminLobbyView,gameView,gameOverView,adminSettingsModal]['forEach'](_0x30fa45=>_0x30fa45[_0xda768f(0x162)][_0xda768f(0x18d)]('hidden'));const _0x2a7536=$(_0xda768f(0x143));if(_0x2127cd===_0xda768f(0xd3)||_0x2127cd===_0xda768f(0x139))_0x2a7536['classList']['remove'](_0xda768f(0x1a1));else isHost?_0x2a7536[_0xda768f(0x162)][_0xda768f(0x14c)](_0xda768f(0x1a1)):_0x2a7536['classList'][_0xda768f(0x18d)](_0xda768f(0x1a1));if(_0x2127cd===_0xda768f(0xd3))playerJoinView['classList']['remove'](_0xda768f(0x1a1));else{if(_0x2127cd===_0xda768f(0x124))playerWaitView[_0xda768f(0x162)]['remove']('hidden');else{if(_0x2127cd===_0xda768f(0x139))adminLoginModal[_0xda768f(0x162)][_0xda768f(0x14c)]('hidden');else{if(_0x2127cd===_0xda768f(0x1ad))adminLobbyView['classList'][_0xda768f(0x14c)](_0xda768f(0x1a1));else{if(_0x2127cd===_0xda768f(0xdc))adminSettingsModal[_0xda768f(0x162)][_0xda768f(0x14c)](_0xda768f(0x1a1));else{if(_0x2127cd===_0xda768f(0x138))gameView['classList'][_0xda768f(0x14c)](_0xda768f(0x1a1));else{if(_0x2127cd==='game-over')gameOverView[_0xda768f(0x162)]['remove'](_0xda768f(0x1a1));}}}}}}}async function createGameRoom(){const _0x33ea38=_0x2e06fa;isHost=!![],document[_0x33ea38(0xd8)][_0x33ea38(0x162)][_0x33ea38(0x14c)](_0x33ea38(0xf6)),showView(_0x33ea38(0x1ad)),gameCodeDisplay['textContent']=_0x33ea38(0x10d);const _0x2641a3=rnd(0xa,0x63)['toString']();currentGameId=_0x2641a3;const _0x62af4c={'hostId':auth[_0x33ea38(0x189)]['uid'],'status':_0x33ea38(0x19b),'players':{},'createdAt':serverTimestamp()};await setDoc(doc(db,_0x33ea38(0x1bc),currentGameId),_0x62af4c),gameCodeDisplay[_0x33ea38(0x130)]=currentGameId,listenForGameUpdates(currentGameId);}async function handleStartGame(){const _0x2bd30e=_0x2e06fa;if(!isHost||!currentGameId)return;gameSettings['resultDisplayMode']=document[_0x2bd30e(0x13c)](_0x2bd30e(0x190))[_0x2bd30e(0x113)],gameSettings[_0x2bd30e(0x109)]=Math[_0x2bd30e(0x192)](0xa,parseInt($(_0x2bd30e(0xf9))[_0x2bd30e(0x113)]||'60',0xa)),gameSettings[_0x2bd30e(0x147)]=$(_0x2bd30e(0x18c))[_0x2bd30e(0x113)];const _0x1575b8=doc(db,_0x2bd30e(0x1bc),currentGameId);try{await runTransaction(db,async _0x3c004b=>{const _0x43da65=_0x2bd30e,_0x32deec=await _0x3c004b['get'](_0x1575b8);if(!_0x32deec['exists']())throw _0x43da65(0xee);const _0x214490=_0x32deec['data']()[_0x43da65(0x14b)]||{},_0x18b6c8={'status':_0x43da65(0x19c),'startTime':serverTimestamp(),'gameMode':gameSettings};if(gameSettings['difficulty']===_0x43da65(0x187)){gameSettings['numQuestions']=0x3;const _0x3db808=generateSudoku(_0x43da65(0xd5)),_0x4242d6=generateSudoku(_0x43da65(0xf7)),_0x1f13db=generateSudoku(_0x43da65(0x13a));_0x18b6c8[_0x43da65(0xe5)]={'easy':_0x3db808,'medium':_0x4242d6,'hard':_0x1f13db};}else gameSettings['numQuestions']=0x1,_0x18b6c8[_0x43da65(0xd2)]=generateSudoku(gameSettings[_0x43da65(0x147)]);for(const _0x48b3ff in _0x214490){_0x18b6c8[_0x43da65(0xe3)+_0x48b3ff+_0x43da65(0x13b)]=0x0,_0x18b6c8[_0x43da65(0xe3)+_0x48b3ff+'.finishTime']=null,_0x18b6c8[_0x43da65(0xe3)+_0x48b3ff+_0x43da65(0x10f)]=0x0;const _0x572440=doc(db,_0x43da65(0x1bc),currentGameId,_0x43da65(0x17a),_0x48b3ff);let _0x3daa87,_0xaff9d4;gameSettings['difficulty']===_0x43da65(0x187)?(_0x3daa87=_0x18b6c8[_0x43da65(0xe5)][_0x43da65(0xd5)][_0x43da65(0x173)],_0x18b6c8[_0x43da65(0xe3)+_0x48b3ff+_0x43da65(0xfa)]=_0x43da65(0xd5)):_0x3daa87=_0x18b6c8[_0x43da65(0xd2)][_0x43da65(0x173)];_0xaff9d4=_0x3daa87['filter'](_0x19730b=>_0x19730b!==0x0)[_0x43da65(0x19a)],_0x18b6c8[_0x43da65(0xe3)+_0x48b3ff+_0x43da65(0x10f)]=_0xaff9d4;const _0x54a35b={'board':_0x3daa87['join'](''),'hasMistake':![]};_0x3c004b[_0x43da65(0x112)](_0x572440,_0x54a35b);}_0x3c004b[_0x43da65(0x18b)](_0x1575b8,_0x18b6c8);}),showView(_0x2bd30e(0x138));}catch(_0x74c118){console[_0x2bd30e(0x120)]('Error\x20starting\x20game:',_0x74c118),toast('เกิดข้อผิดพลาดในการเริ่มเกม');}}function startPracticeGame(){const _0x583963=_0x2e06fa;isPracticeMode=!![],gameSettings['timeLimit']=Math['max'](0xa,parseInt($(_0x583963(0xf9))['value']||'60',0xa)),gameSettings[_0x583963(0x147)]=$(_0x583963(0x18c))[_0x583963(0x113)],document[_0x583963(0xd8)][_0x583963(0x162)]['add'](_0x583963(0xf6)),hostControls[_0x583963(0x162)][_0x583963(0x18d)]('hidden'),playerScoreDisplay[_0x583963(0x162)]['add'](_0x583963(0x1a1)),$(_0x583963(0x125))['classList'][_0x583963(0x18d)](_0x583963(0x1a1));if(gameSettings['difficulty']===_0x583963(0x187))practicePuzzles={'easy':generateSudoku(_0x583963(0xd5)),'medium':generateSudoku(_0x583963(0xf7)),'hard':generateSudoku(_0x583963(0x13a))},currentPracticeLevel=_0x583963(0xd5),loadPracticePuzzle(currentPracticeLevel);else{practicePuzzles=null,currentPracticeLevel=gameSettings[_0x583963(0x147)];const _0x139513=generateSudoku(gameSettings[_0x583963(0x147)]);given=_0x139513[_0x583963(0x173)][_0x583963(0x16a)](),board=_0x139513['puzzle']['slice'](),solution=_0x139513[_0x583963(0x186)][_0x583963(0x16a)](),targetNumberDisplay[_0x583963(0x130)]=_0x583963(0x1b1)+gameSettings[_0x583963(0x147)];}hasMistake=![],selectedIdx=board[_0x583963(0x100)]((_0x50c1c9,_0x50b992)=>!given[_0x50b992]);if(selectedIdx<0x0)selectedIdx=0x0;showView(_0x583963(0x138)),gameBoard['classList'][_0x583963(0x14c)](_0x583963(0x1a1)),playerFinishedView[_0x583963(0x162)][_0x583963(0x18d)](_0x583963(0x1a1)),pickerEl['classList'][_0x583963(0x14c)]('hidden'),$(_0x583963(0x101))[_0x583963(0x162)][_0x583963(0x14c)](_0x583963(0x1a1)),$(_0x583963(0xed))[_0x583963(0x162)]['remove']('hidden'),renderSudoku(),startPracticeTimer();}function loadPracticePuzzle(_0x58ce18){const _0x237433=_0x2e06fa,_0x17cc97=practicePuzzles[_0x58ce18];given=_0x17cc97[_0x237433(0x173)][_0x237433(0x16a)](),board=_0x17cc97[_0x237433(0x173)]['slice'](),solution=_0x17cc97['solution'][_0x237433(0x16a)](),hasMistake=![],selectedIdx=board[_0x237433(0x100)]((_0x7b1569,_0x3f473c)=>!given[_0x3f473c]);if(selectedIdx<0x0)selectedIdx=0x0;targetNumberDisplay[_0x237433(0x130)]=_0x237433(0x1b1)+_0x58ce18,renderSudoku();}function startPracticeTimer(){if(timerInterval)clearInterval(timerInterval);let _0x1bbd6b=gameSettings['timeLimit'];const _0x380499=()=>{const _0x4b7a24=_0x24df,_0x408faa=String(Math['floor'](_0x1bbd6b/0x3c))['padStart'](0x2,'0'),_0x3b3e3f=String(_0x1bbd6b%0x3c)[_0x4b7a24(0x15e)](0x2,'0');gameTimerEl[_0x4b7a24(0x130)]=_0x4b7a24(0x15a)+_0x408faa+':'+_0x3b3e3f;};_0x380499(),timerInterval=setInterval(()=>{const _0x109141=_0x24df;_0x1bbd6b--,_0x380499(),_0x1bbd6b<=0x0&&(clearInterval(timerInterval),gameBoard[_0x109141(0x162)][_0x109141(0x18d)](_0x109141(0x1a1)),playerFinishedView[_0x109141(0x162)][_0x109141(0x14c)]('hidden'),$(_0x109141(0x11f))[_0x109141(0x130)]=_0x109141(0x104),$(_0x109141(0x12c))['textContent']='ลองใหม่อีกครั้งนะ');},0x3e8);}async function forceEndGame(){const _0x327b65=_0x2e06fa;if(!isHost||!currentGameId)return;const _0x8dc904=doc(db,_0x327b65(0x1bc),currentGameId),_0x5cad95=await getDoc(_0x8dc904);_0x5cad95[_0x327b65(0xe9)]()&&_0x5cad95[_0x327b65(0x155)]()[_0x327b65(0x148)]===_0x327b65(0x19c)&&await updateDoc(_0x8dc904,{'status':_0x327b65(0x12a),'winner':null});}function _0x24df(_0x4085f7,_0x44f5cd){const _0x2e3e8a=_0x2e3e();return _0x24df=function(_0x24dff5,_0x38d1b6){_0x24dff5=_0x24dff5-0xd1;let _0x30ab9d=_0x2e3e8a[_0x24dff5];return _0x30ab9d;},_0x24df(_0x4085f7,_0x44f5cd);}async function returnToLobby(){const _0x375891=_0x2e06fa;if(!isHost||!currentGameId)return;const _0x5224cf=doc(db,_0x375891(0x1bc),currentGameId);try{await updateDoc(_0x5224cf,{'status':_0x375891(0x19b),'players':{},'winner':deleteField(),'sudoku':deleteField(),'puzzles':deleteField(),'startTime':deleteField(),'gameMode':deleteField()}),showView('admin-lobby');}catch(_0x4f7377){console['error'](_0x375891(0x150),_0x4f7377),toast(_0x375891(0xdf));}}async function handleJoinGame(){const _0xe4e429=_0x2e06fa,_0x3d0a93=$(_0xe4e429(0xfb))[_0xe4e429(0x113)],_0x1b4262=$(_0xe4e429(0x111))[_0xe4e429(0x113)][_0xe4e429(0x1a2)]();if(!_0x3d0a93||!_0x1b4262)return toast(_0xe4e429(0x14f));currentGameId=_0x3d0a93,currentPlayerName=_0x1b4262;const _0xf4bca7=doc(db,_0xe4e429(0x1bc),currentGameId);try{await runTransaction(db,async _0x186a6a=>{const _0x504340=_0xe4e429,_0x450421=await _0x186a6a[_0x504340(0x114)](_0xf4bca7);if(!_0x450421['exists']())throw new Error(_0x504340(0xe4));const _0x1d6033=_0x450421['data']();if(_0x1d6033['status']!==_0x504340(0x19b))throw new Error(_0x504340(0x1af));let _0x2a1fc3=_0x1b4262;_0x1d6033[_0x504340(0x14b)]&&_0x1d6033[_0x504340(0x14b)][_0x2a1fc3]&&(_0x2a1fc3=''+_0x1b4262+rnd(0xa,0x63),toast(_0x504340(0x132)+_0x2a1fc3+_0x504340(0x133))),currentPlayerName=_0x2a1fc3,_0x186a6a['update'](_0xf4bca7,{[_0x504340(0xe3)+_0x2a1fc3]:{'joined':!![]}});}),isHost=![],document[_0xe4e429(0xd8)][_0xe4e429(0x162)]['add'](_0xe4e429(0xf6)),toast('เข้าร่วมสำเร็จ!\x20รอสักครู่...'),listenForGameUpdates(currentGameId);}catch(_0x5ed525){console[_0xe4e429(0x120)](_0xe4e429(0x183),_0x5ed525),toast(_0x5ed525[_0xe4e429(0x152)]);}}function listenForGameUpdates(_0xa9c6f9){const _0x20c82a=_0x2e06fa;if(unsubscribeGameListener)unsubscribeGameListener();const _0x4c838f=doc(db,_0x20c82a(0x1bc),_0xa9c6f9);unsubscribeGameListener=onSnapshot(_0x4c838f,_0x31bda1=>{const _0x20167=_0x20c82a;if(!_0x31bda1['exists']()){toast(_0x20167(0x195));if(unsubscribeGameListener)unsubscribeGameListener();if(unsubscribePlayerStateListener)unsubscribePlayerStateListener();if(unsubscribeAllPlayerStates)unsubscribeAllPlayerStates();timerInterval&&(clearInterval(timerInterval),timerInterval=null);isHost=![],document['body'][_0x20167(0x162)][_0x20167(0x14c)](_0x20167(0xf6)),showView(_0x20167(0xd3));return;}const _0x35f56d=_0x31bda1[_0x20167(0x155)]();latestGameData=_0x35f56d;const _0x1b1ca4=_0x35f56d['status'];previousGameStatus===_0x20167(0x19c)&&_0x1b1ca4!==_0x20167(0x19c)&&isHost&&(unsubscribeAllPlayerStates&&(unsubscribeAllPlayerStates(),unsubscribeAllPlayerStates=null));if(!isHost&&previousGameStatus===_0x20167(0x12a)&&_0x1b1ca4===_0x20167(0x19b)){if(unsubscribeGameListener)unsubscribeGameListener();if(unsubscribePlayerStateListener)unsubscribePlayerStateListener();unsubscribePlayerStateListener=null;if(timerInterval)clearInterval(timerInterval);currentGameId=null,currentPlayerName=null,toast(_0x20167(0x11a)),document[_0x20167(0xd8)]['classList'][_0x20167(0x14c)]('player-view'),showView(_0x20167(0xd3)),previousGameStatus=null;return;}previousGameStatus=_0x1b1ca4;if(_0x1b1ca4===_0x20167(0x19b)){timerInterval&&(clearInterval(timerInterval),timerInterval=null);if(unsubscribePlayerStateListener)unsubscribePlayerStateListener();unsubscribePlayerStateListener=null;if(isHost)showView(_0x20167(0x1ad)),renderLobbyPlayers(_0x35f56d[_0x20167(0x14b)]);else showView('player-wait');}else{if(_0x1b1ca4==='playing'){startOrUpdateTimer(_0x35f56d),showView(_0x20167(0x138));if(isHost){if(!unsubscribeAllPlayerStates){const _0x5ebdcb=collection(db,'games',_0xa9c6f9,_0x20167(0x17a));unsubscribeAllPlayerStates=onSnapshot(_0x5ebdcb,_0x3e766b=>{const _0x3ee417=_0x20167;_0x3e766b[_0x3ee417(0xef)]['forEach'](_0x2e593d=>{const _0x29498c=_0x3ee417;allPlayerStates[_0x2e593d['id']]=_0x2e593d[_0x29498c(0x155)]();}),renderAdminGameView();});}renderAdminGameView();if(_0x35f56d[_0x20167(0x129)]['resultDisplayMode']===_0x20167(0xec)){const _0x48a5f4=Object['values'](_0x35f56d['players']||{});_0x48a5f4[_0x20167(0x19a)]>0x0&&_0x48a5f4[_0x20167(0x18f)](_0xfc8974=>_0xfc8974[_0x20167(0x19d)])&&forceEndGame();}}else renderPlayerGameView(_0x35f56d),listenForPlayerState(_0xa9c6f9,currentPlayerName);}else{if(_0x1b1ca4===_0x20167(0x12a)){timerInterval&&(clearInterval(timerInterval),timerInterval=null);if(unsubscribePlayerStateListener)unsubscribePlayerStateListener();renderGameOverView(_0x35f56d);}}}});}function listenForPlayerState(_0x43bf17,_0x17d6db){const _0xff1ed5=_0x2e06fa;if(unsubscribePlayerStateListener)return;const _0x4b4969=doc(db,_0xff1ed5(0x1bc),_0x43bf17,_0xff1ed5(0x17a),_0x17d6db);unsubscribePlayerStateListener=onSnapshot(_0x4b4969,_0x335dc3=>{const _0x35eef0=_0xff1ed5;if(_0x335dc3[_0x35eef0(0xe9)]()){const _0x19d906=_0x335dc3[_0x35eef0(0x155)](),_0x19cc3e=(_0x19d906[_0x35eef0(0x16f)]||'')['split']('')[_0x35eef0(0x15f)](_0x1459c4=>parseInt(_0x1459c4,0xa)||0x0);hasMistake=!!_0x19d906[_0x35eef0(0x1c2)],updateBoardFromState(_0x19cc3e);}});}function renderLobbyPlayers(_0x30c45b){const _0x2e0a22=_0x2e06fa,_0x15183c=Object['keys'](_0x30c45b||{});lobbyPlayerCount[_0x2e0a22(0x130)]=_0x15183c['length'],lobbyPlayerNameList[_0x2e0a22(0x165)]=_0x15183c[_0x2e0a22(0x19a)]===0x0?_0x2e0a22(0x199):_0x15183c[_0x2e0a22(0x15f)](_0x2b89ca=>'<div\x20class=\x22lobby-player-tag\x22>'+_0x2b89ca+_0x2e0a22(0x172))['join']('');}function startOrUpdateTimer(_0x16620f){const _0x26635a=_0x2e06fa;if(timerInterval)clearInterval(timerInterval);const _0x199ea8=_0x16620f['gameMode']||gameSettings,_0x4a78bd=_0x16620f[_0x26635a(0x15c)][_0x26635a(0x157)]();timerInterval=setInterval(()=>{const _0x46b82a=_0x26635a,_0x332301=Math[_0x46b82a(0x10c)]((Date[_0x46b82a(0x19f)]()-_0x4a78bd)/0x3e8),_0xb417d6=_0x199ea8[_0x46b82a(0x109)]-_0x332301;if(_0xb417d6<=0x0){clearInterval(timerInterval),gameTimerEl[_0x46b82a(0x130)]=_0x46b82a(0x182);if(isHost)forceEndGame();}else{const _0x590da2=String(Math['floor'](_0xb417d6/0x3c))[_0x46b82a(0x15e)](0x2,'0'),_0x26e0f3=String(_0xb417d6%0x3c)[_0x46b82a(0x15e)](0x2,'0');gameTimerEl[_0x46b82a(0x130)]=_0x46b82a(0x15a)+_0x590da2+':'+_0x26e0f3;}},0x1f4);}function renderAdminGameView(){const _0x5d1e04=_0x2e06fa,_0x5ec8f2=latestGameData;if(!_0x5ec8f2||!_0x5ec8f2['players'])return;$(_0x5d1e04(0x125))[_0x5d1e04(0x162)][_0x5d1e04(0x14c)](_0x5d1e04(0x1a1)),hostControls[_0x5d1e04(0x162)]['remove'](_0x5d1e04(0x1a1));const _0x3a0b82=_0x5ec8f2[_0x5d1e04(0x14b)]||{},_0x41fef8=Object[_0x5d1e04(0x14e)](_0x3a0b82)[_0x5d1e04(0x177)]((_0x555b9c,_0x3d0f3f)=>{const _0x8a015=_0x5d1e04,_0x56fe0d=_0x555b9c[0x1],_0xb0f8cf=_0x3d0f3f[0x1];if((_0x56fe0d[_0x8a015(0x19d)]?0x1:0x0)!==(_0xb0f8cf[_0x8a015(0x19d)]?0x1:0x0))return(_0xb0f8cf[_0x8a015(0x19d)]?0x1:0x0)-(_0x56fe0d[_0x8a015(0x19d)]?0x1:0x0);if((_0x56fe0d[_0x8a015(0x122)]||0x0)!==(_0xb0f8cf[_0x8a015(0x122)]||0x0))return(_0xb0f8cf[_0x8a015(0x122)]||0x0)-(_0x56fe0d[_0x8a015(0x122)]||0x0);const _0x5e29f3=(allPlayerStates?.[_0x555b9c[0x0]]?.['board']||'')[_0x8a015(0x178)](/0/g,'')[_0x8a015(0x19a)],_0x2bd416=(allPlayerStates?.[_0x3d0f3f[0x0]]?.['board']||'')['replace'](/0/g,'')[_0x8a015(0x19a)];return _0x2bd416-_0x5e29f3;});playerList[_0x5d1e04(0x165)]=_0x41fef8[_0x5d1e04(0x15f)](([_0x437fe7,_0x430f9f])=>{const _0x39cb27=_0x5d1e04,_0x5ca6cc=(allPlayerStates?.[_0x437fe7]?.[_0x39cb27(0x16f)]||'')[_0x39cb27(0x178)](/0/g,'')['length'];let _0x5b9e3a=_0x5ca6cc+_0x39cb27(0x160);if(_0x430f9f[_0x39cb27(0x19d)])_0x5b9e3a='เสร็จแล้ว';else _0x5ec8f2[_0x39cb27(0x129)][_0x39cb27(0x147)]==='mixed'&&(_0x5b9e3a=_0x39cb27(0x1b8)+(_0x430f9f[_0x39cb27(0x197)]||_0x39cb27(0xd5))+'\x20('+_0x5ca6cc+'/16)');return _0x39cb27(0x168)+_0x437fe7+_0x39cb27(0x169)+(_0x430f9f[_0x39cb27(0x122)]||0x0)+_0x39cb27(0x12e)+_0x5b9e3a+_0x39cb27(0x161);})['join']('');let _0x555db7;if(_0x5ec8f2[_0x5d1e04(0x129)][_0x5d1e04(0x147)]===_0x5d1e04(0x187)){const _0x2c5f50=[_0x5d1e04(0xd5),'medium',_0x5d1e04(0x13a)];let _0x25c5fd='easy';const _0x20eebd=Object[_0x5d1e04(0x1ac)](_0x3a0b82);for(const _0x24e90f of _0x20eebd){if(_0x24e90f[_0x5d1e04(0x19d)])continue;const _0x3a0496=_0x24e90f[_0x5d1e04(0x197)]||'easy';_0x2c5f50[_0x5d1e04(0x127)](_0x3a0496)>_0x2c5f50[_0x5d1e04(0x127)](_0x25c5fd)&&(_0x25c5fd=_0x3a0496);}_0x555db7=_0x5ec8f2['puzzles']?_0x5ec8f2[_0x5d1e04(0xe5)][_0x25c5fd]:null;}else _0x555db7=_0x5ec8f2[_0x5d1e04(0xd2)];if(!_0x555db7)return;const _0x356072=_0x555db7['puzzle']||[];given=_0x356072[_0x5d1e04(0x16a)](),board=_0x356072[_0x5d1e04(0x16a)](),solution=_0x555db7[_0x5d1e04(0x186)]||[],selectedIdx=-0x1,renderSudoku(),$$(_0x5d1e04(0x170))[_0x5d1e04(0x1a8)](_0x1fef84=>_0x1fef84[_0x5d1e04(0x10b)][_0x5d1e04(0x17c)]=_0x5d1e04(0x10a)),pickerEl['classList'][_0x5d1e04(0x18d)]('hidden'),$(_0x5d1e04(0x101))['classList'][_0x5d1e04(0x18d)](_0x5d1e04(0x1a1)),$(_0x5d1e04(0xed))['classList'][_0x5d1e04(0x18d)](_0x5d1e04(0x1a1));}function renderPlayerGameView(_0x29972a){const _0x457402=_0x2e06fa;$(_0x457402(0x125))['classList'][_0x457402(0x18d)]('hidden');const _0x9a4fc1=(_0x29972a[_0x457402(0x14b)]||{})[currentPlayerName];if(!_0x9a4fc1)return;playerScoreDisplay['textContent']=_0x457402(0x119)+(_0x9a4fc1['score']||0x0),playerScoreDisplay[_0x457402(0x162)][_0x457402(0x14c)](_0x457402(0x1a1));let _0x23328c;if(_0x29972a[_0x457402(0x129)]['difficulty']===_0x457402(0x187)){const _0x121279=_0x9a4fc1['currentLevel']||_0x457402(0xd5);_0x23328c=_0x29972a[_0x457402(0xe5)][_0x121279],targetNumberDisplay[_0x457402(0x130)]='ด่าน\x20'+_0x121279;}else _0x23328c=_0x29972a[_0x457402(0xd2)],targetNumberDisplay['textContent']=_0x457402(0x167);if(!_0x23328c)return;given=(_0x23328c[_0x457402(0x173)]||[])[_0x457402(0x16a)](),solution=(_0x23328c[_0x457402(0x186)]||[])[_0x457402(0x16a)](),board=given[_0x457402(0x16a)](),selectedIdx=board[_0x457402(0x100)]((_0x2d1bbc,_0x5c1089)=>!given[_0x5c1089]);if(selectedIdx<0x0)selectedIdx=0x0;_0x9a4fc1[_0x457402(0x19d)]?(gameBoard[_0x457402(0x162)][_0x457402(0x18d)](_0x457402(0x1a1)),playerFinishedView[_0x457402(0x162)][_0x457402(0x14c)]('hidden')):(gameBoard[_0x457402(0x162)][_0x457402(0x14c)]('hidden'),playerFinishedView['classList'][_0x457402(0x18d)]('hidden'),renderSudoku());}function renderGameOverView(_0x133f49){const _0x4f1f1f=_0x2e06fa,_0x2415d3=_0x133f49[_0x4f1f1f(0x1b3)],_0x3bc910=$(_0x4f1f1f(0x128));_0x2415d3?_0x3bc910[_0x4f1f1f(0x165)]=_0x4f1f1f(0x121)+_0x2415d3+'!':_0x3bc910[_0x4f1f1f(0x165)]=_0x4f1f1f(0x135);const _0x3ba100=_0x133f49[_0x4f1f1f(0x14b)]||{},_0x239038=Object['entries'](_0x3ba100)['sort'](([,_0x3d4c6b],[,_0x11061c])=>{const _0x90e2d=_0x4f1f1f;if((_0x3d4c6b[_0x90e2d(0x122)]||0x0)!==(_0x11061c[_0x90e2d(0x122)]||0x0))return(_0x11061c[_0x90e2d(0x122)]||0x0)-(_0x3d4c6b[_0x90e2d(0x122)]||0x0);if(_0x11061c[_0x90e2d(0x19d)]&&_0x3d4c6b['finishTime'])return _0x3d4c6b[_0x90e2d(0x19d)]['toMillis']()-_0x11061c[_0x90e2d(0x19d)][_0x90e2d(0x157)]();if(_0x11061c[_0x90e2d(0x19d)])return 0x1;if(_0x3d4c6b[_0x90e2d(0x19d)])return-0x1;return(_0x11061c[_0x90e2d(0xe7)]||0x0)-(_0x3d4c6b[_0x90e2d(0xe7)]||0x0);});podiumContainer['innerHTML']='',otherRankingsList['innerHTML']='';const _0x4d61c3=_0x239038[_0x4f1f1f(0x16a)](0x0,0x3),_0x38b024=_0x239038[_0x4f1f1f(0x16a)](0x3);_0x4d61c3[_0x4f1f1f(0x1a8)](([_0x44449a,_0x332693],_0x2b40c7)=>{const _0x4ba8cd=_0x4f1f1f,_0x18295f=_0x2b40c7+0x1,_0x262543=document[_0x4ba8cd(0xf4)](_0x4ba8cd(0x12d));_0x262543[_0x4ba8cd(0x175)]=_0x4ba8cd(0x16d)+_0x18295f,_0x262543['innerHTML']=(_0x18295f===0x1&&_0x2415d3?'<i\x20class=\x22fas\x20fa-crown\x22></i>':'')+_0x4ba8cd(0xe6)+_0x44449a+_0x4ba8cd(0x159)+(_0x332693[_0x4ba8cd(0x122)]||0x0)+_0x4ba8cd(0x1a5)+_0x18295f+_0x4ba8cd(0x172),podiumContainer[_0x4ba8cd(0x118)](_0x262543);});for(let _0x160677=_0x239038[_0x4f1f1f(0x19a)];_0x160677<0x3;_0x160677++){const _0x22b228=_0x160677+0x1,_0x40c604=document[_0x4f1f1f(0xf4)](_0x4f1f1f(0x12d));_0x40c604['className']=_0x4f1f1f(0x16d)+_0x22b228,podiumContainer['appendChild'](_0x40c604);}if(_0x38b024[_0x4f1f1f(0x19a)]>0x0)otherRankingsContainer[_0x4f1f1f(0x162)][_0x4f1f1f(0x14c)](_0x4f1f1f(0x1a1)),otherRankingsList[_0x4f1f1f(0x165)]=_0x38b024[_0x4f1f1f(0x15f)](([_0x3ca043,_0x21f3d0],_0xf8a898)=>'<li><span>'+(_0xf8a898+0x4)+'.\x20'+_0x3ca043+'</span><span>'+(_0x21f3d0['score']||0x0)+_0x4f1f1f(0x153))[_0x4f1f1f(0x116)]('');else otherRankingsContainer[_0x4f1f1f(0x162)][_0x4f1f1f(0x18d)](_0x4f1f1f(0x1a1));if(isHost)$(_0x4f1f1f(0x1b5))['classList'][_0x4f1f1f(0x14c)](_0x4f1f1f(0x1a1));else $(_0x4f1f1f(0x1b5))['classList']['add']('hidden');showView(_0x4f1f1f(0x13f));}function renderPracticeGameOverView(){const _0x2028c8=_0x2e06fa,_0x554bc9=gameTimerEl[_0x2028c8(0x130)]['replace'](_0x2028c8(0x15a),''),_0x214323=_0x554bc9[_0x2028c8(0x1aa)](':'),_0x51cfe7=parseInt(_0x214323[0x0],0xa)*0x3c+parseInt(_0x214323[0x1],0xa),_0x5707e6=gameSettings[_0x2028c8(0x109)]-_0x51cfe7,_0x35be3f=String(Math['floor'](_0x5707e6/0x3c))[_0x2028c8(0x15e)](0x2,'0'),_0x463ff5=String(_0x5707e6%0x3c)[_0x2028c8(0x15e)](0x2,'0'),_0x5f16c6=_0x35be3f+':'+_0x463ff5;resultsHeader[_0x2028c8(0x165)]='<i\x20class=\x22fas\x20fa-check-circle\x20mr-2\x22></i>ฝึกซ้อมสำเร็จ!',podiumContainer[_0x2028c8(0x165)]=_0x2028c8(0x194)+gameSettings['difficulty']+_0x2028c8(0x146)+_0x5f16c6+_0x2028c8(0xd1),otherRankingsContainer['classList']['add']('hidden');const _0x253678=$(_0x2028c8(0x1b5));_0x253678['textContent']=_0x2028c8(0xd6),_0x253678[_0x2028c8(0x162)][_0x2028c8(0x14c)]('hidden'),_0x253678[_0x2028c8(0x12f)]=()=>$(_0x2028c8(0xed))[_0x2028c8(0xe8)](),showView(_0x2028c8(0x13f));}let syncTimer=null;function scheduleBoardSync(){if(isPracticeMode||!currentGameId||!currentPlayerName)return;if(syncTimer)clearTimeout(syncTimer);syncTimer=setTimeout(async()=>{const _0xafc3df=_0x24df;try{const _0x19d56f=doc(db,_0xafc3df(0x1bc),currentGameId,_0xafc3df(0x17a),currentPlayerName);await updateDoc(_0x19d56f,{'board':board[_0xafc3df(0x116)](''),'hasMistake':hasMistake});}catch(_0x5b4461){console[_0xafc3df(0x184)]('board\x20sync\x20failed',_0x5b4461);}},0xc8);}async function tryFinish(){const _0x25da95=_0x2e06fa;if(isPracticeMode){if(!isSolved())return;const _0x4c9152=gameTimerEl[_0x25da95(0x130)]['replace'](_0x25da95(0x15a),''),_0x1574fc=_0x4c9152[_0x25da95(0x1aa)](':'),_0x1cb8f1=parseInt(_0x1574fc[0x0],0xa)*0x3c+parseInt(_0x1574fc[0x1],0xa),_0x2bcb4e=0x64+_0x1cb8f1+(hasMistake?0x0:0x32);if(gameSettings[_0x25da95(0x147)]===_0x25da95(0x187)){if(currentPracticeLevel===_0x25da95(0xd5)){currentPracticeLevel=_0x25da95(0xf7),toast(_0x25da95(0xd9),0x9c4),loadPracticePuzzle(_0x25da95(0xf7));return;}else{if(currentPracticeLevel===_0x25da95(0xf7)){currentPracticeLevel=_0x25da95(0x13a),toast(_0x25da95(0x17e),0x9c4),loadPracticePuzzle('hard');return;}}}if(timerInterval)clearInterval(timerInterval);gameBoard['classList']['add'](_0x25da95(0x1a1)),playerFinishedView['classList'][_0x25da95(0x14c)](_0x25da95(0x1a1)),$(_0x25da95(0x11f))[_0x25da95(0x130)]='เยี่ยมมาก!',$(_0x25da95(0x12c))[_0x25da95(0x130)]=_0x25da95(0xeb),$(_0x25da95(0x1c0))[_0x25da95(0x165)]=_0x25da95(0x17f)+_0x2bcb4e+_0x25da95(0x107),setTimeout(()=>{renderPracticeGameOverView();},0x7d0);return;}if(syncTimer)clearTimeout(syncTimer);const _0x74e931=doc(db,_0x25da95(0x1bc),currentGameId);try{await runTransaction(db,async _0x3b5351=>{const _0x489eb8=_0x25da95,_0x4de98f=await _0x3b5351['get'](_0x74e931);if(!_0x4de98f[_0x489eb8(0xe9)]())throw new Error(_0x489eb8(0x17d));const _0x1fa130=_0x4de98f[_0x489eb8(0x155)]();if(_0x1fa130[_0x489eb8(0x148)]!==_0x489eb8(0x19c))return;const _0x3217fd=(_0x1fa130['players']||{})[currentPlayerName];if(!_0x3217fd)throw new Error(_0x489eb8(0x123));if(_0x3217fd[_0x489eb8(0x19d)])return;const _0x3d48bf=board;let _0xec61e0,_0x2e8d1b='single';_0x1fa130[_0x489eb8(0x129)][_0x489eb8(0x147)]===_0x489eb8(0x187)?(_0x2e8d1b=_0x3217fd[_0x489eb8(0x197)]||_0x489eb8(0xd5),_0xec61e0=_0x1fa130[_0x489eb8(0xe5)][_0x2e8d1b][_0x489eb8(0x186)]):_0xec61e0=_0x1fa130[_0x489eb8(0xd2)]['solution'];for(let _0x41a2c6=0x0;_0x41a2c6<0x10;_0x41a2c6++){if(_0x3d48bf[_0x41a2c6]!==_0xec61e0[_0x41a2c6])return;}const _0x23bb2b=_0x1fa130[_0x489eb8(0x15c)]['toMillis'](),_0xbf7d88=Math[_0x489eb8(0x10c)]((Date[_0x489eb8(0x19f)]()-_0x23bb2b)/0x3e8),_0x5f1a42=Math['max'](0x0,_0x1fa130[_0x489eb8(0x129)][_0x489eb8(0x109)]-_0xbf7d88),_0x428efb=0x64+_0x5f1a42+(hasMistake?0x0:0x32),_0x32155b={};if(_0x1fa130[_0x489eb8(0x129)][_0x489eb8(0x147)]==='mixed'){const _0x13a37e=doc(db,_0x489eb8(0x1bc),currentGameId,_0x489eb8(0x17a),currentPlayerName);if(_0x2e8d1b===_0x489eb8(0xd5))_0x32155b['players.'+currentPlayerName+_0x489eb8(0xfa)]='medium',_0x32155b[_0x489eb8(0xe3)+currentPlayerName+_0x489eb8(0x13b)]=increment(_0x428efb),_0x3b5351[_0x489eb8(0x112)](_0x13a37e,{'board':_0x1fa130[_0x489eb8(0xe5)][_0x489eb8(0xf7)][_0x489eb8(0x173)][_0x489eb8(0x116)](''),'hasMistake':![]});else _0x2e8d1b==='medium'?(_0x32155b[_0x489eb8(0xe3)+currentPlayerName+_0x489eb8(0xfa)]=_0x489eb8(0x13a),_0x32155b[_0x489eb8(0xe3)+currentPlayerName+'.score']=increment(_0x428efb),_0x3b5351[_0x489eb8(0x112)](_0x13a37e,{'board':_0x1fa130['puzzles'][_0x489eb8(0x13a)][_0x489eb8(0x173)][_0x489eb8(0x116)](''),'hasMistake':![]})):(_0x32155b[_0x489eb8(0xe3)+currentPlayerName+'.score']=increment(_0x428efb),_0x32155b[_0x489eb8(0xe3)+currentPlayerName+_0x489eb8(0xf8)]=serverTimestamp(),_0x1fa130[_0x489eb8(0x129)][_0x489eb8(0xe1)]===_0x489eb8(0x108)&&(_0x32155b['status']=_0x489eb8(0x12a),_0x32155b[_0x489eb8(0x1b3)]=currentPlayerName));}else _0x32155b[_0x489eb8(0xe3)+currentPlayerName+_0x489eb8(0x13b)]=increment(_0x428efb),_0x32155b[_0x489eb8(0xe3)+currentPlayerName+'.finishTime']=serverTimestamp(),_0x1fa130[_0x489eb8(0x129)][_0x489eb8(0xe1)]===_0x489eb8(0x108)&&(_0x32155b['status']='finished',_0x32155b[_0x489eb8(0x1b3)]=currentPlayerName);_0x3b5351['update'](_0x74e931,_0x32155b);});}catch(_0x348481){_0x348481[_0x25da95(0x152)]['includes']('aborted')?(console[_0x25da95(0x11d)](_0x25da95(0x1bf)),toast(_0x25da95(0x18e))):(console[_0x25da95(0x120)](_0x25da95(0x134),_0x348481),toast('เกิดข้อผิดพลาดในการจบเกม'));}}$('#admin-icon-btn')[_0x2e06fa(0xe0)](_0x2e06fa(0xe8),()=>showView(_0x2e06fa(0x139))),$(_0x2e06fa(0x140))[_0x2e06fa(0xe0)](_0x2e06fa(0xe8),()=>showView(_0x2e06fa(0xd3))),$(_0x2e06fa(0x15b))['addEventListener']('click',async()=>{const _0x453d38=_0x2e06fa;if($(_0x453d38(0x141))[_0x453d38(0x113)]===_0x453d38(0x17b))await createGameRoom();else toast(_0x453d38(0x1bd));}),$(_0x2e06fa(0x13d))[_0x2e06fa(0xe0)]('click',handleJoinGame),$(_0x2e06fa(0xd4))[_0x2e06fa(0xe0)]('click',()=>{const _0xd06e87=_0x2e06fa;isPracticeMode=!![],isHost=!![],showView(_0xd06e87(0xdc)),$(_0xd06e87(0x16b))[_0xd06e87(0x162)][_0xd06e87(0x18d)](_0xd06e87(0x1a1)),$('#start-game-btn')['innerHTML']=_0xd06e87(0x1b6);}),$('#open-settings-btn')[_0x2e06fa(0xe0)](_0x2e06fa(0xe8),()=>{const _0x913d07=_0x2e06fa;isPracticeMode=![],showView(_0x913d07(0xdc)),$(_0x913d07(0x16b))[_0x913d07(0x162)][_0x913d07(0x14c)]('hidden'),$(_0x913d07(0xff))[_0x913d07(0x165)]=_0x913d07(0x185);}),$(_0x2e06fa(0x1a7))[_0x2e06fa(0xe0)]('click',()=>{const _0x536f1e=_0x2e06fa;isHost&&!currentGameId&&isPracticeMode?(isPracticeMode=![],isHost=![],showView(_0x536f1e(0xd3))):showView('admin-lobby');}),$(_0x2e06fa(0xff))[_0x2e06fa(0xe0)](_0x2e06fa(0xe8),()=>{isPracticeMode?startPracticeGame():handleStartGame();}),$(_0x2e06fa(0x102))[_0x2e06fa(0xe0)](_0x2e06fa(0xe8),forceEndGame),$(_0x2e06fa(0x1b5))[_0x2e06fa(0xe0)](_0x2e06fa(0xe8),returnToLobby),$('#home-btn')[_0x2e06fa(0xe0)](_0x2e06fa(0xe8),()=>{const _0x1e825a=_0x2e06fa;if(unsubscribeGameListener)unsubscribeGameListener();unsubscribePlayerStateListener&&(unsubscribePlayerStateListener(),unsubscribePlayerStateListener=null);if(timerInterval)clearInterval(timerInterval);currentGameId=null,currentPlayerName=null,isHost=![],isPracticeMode=![],practicePuzzles=null,currentPracticeLevel=null,document['body'][_0x1e825a(0x162)][_0x1e825a(0x14c)](_0x1e825a(0xf6)),showView('player-join'),$(_0x1e825a(0x11f))[_0x1e825a(0x130)]='เสร็จแล้ว!',$('#player-finished-view\x20p')[_0x1e825a(0x130)]='รอผลการแข่งขันสักครู่...';}),$('#reset-btn')['addEventListener'](_0x2e06fa(0xe8),()=>{for(let _0x1bcd07=0x0;_0x1bcd07<0x10;_0x1bcd07++)board[_0x1bcd07]=given[_0x1bcd07];hasMistake=![],renderSudoku(),scheduleBoardSync();}),sudokuEl[_0x2e06fa(0xe0)](_0x2e06fa(0xe8),_0x43e109=>{const _0x1b49ff=_0x2e06fa,_0x3dbf2c=_0x43e109['target'][_0x1b49ff(0x14a)](_0x1b49ff(0xdd));if(!_0x3dbf2c)return;const _0x27f502=parseInt(_0x3dbf2c[_0x1b49ff(0x16c)][_0x1b49ff(0xd7)],0xa);if(!given[_0x27f502])selectCell(_0x27f502);}),$(_0x2e06fa(0x125))[_0x2e06fa(0xe0)](_0x2e06fa(0xe8),()=>{const _0x52a657=_0x2e06fa;$(_0x52a657(0xdb))['classList'][_0x52a657(0xda)](_0x52a657(0x136));}),$('#difficulty-select')[_0x2e06fa(0xe0)](_0x2e06fa(0x13e),_0x1ce347=>{const _0x275ead=_0x2e06fa,_0x10e2f2=$('#time-limit-input');switch(_0x1ce347['target'][_0x275ead(0x113)]){case _0x275ead(0xd5):_0x10e2f2[_0x275ead(0x113)]=0x1e;break;case'medium':_0x10e2f2[_0x275ead(0x113)]=0x3c;break;case _0x275ead(0x13a):_0x10e2f2['value']=0x78;break;case _0x275ead(0x187):_0x10e2f2[_0x275ead(0x113)]=0xd2;break;}}),window[_0x2e06fa(0xe0)](_0x2e06fa(0x14d),()=>{const _0x206f1e=_0x2e06fa;isHost&&currentGameId&&deleteDoc(doc(db,_0x206f1e(0x1bc),currentGameId));}),initialize(),showView(_0x2e06fa(0xd3));
