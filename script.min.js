const _0x574540=_0x4d2a;(function(_0x52e9ad,_0x20a629){const _0x7a2a62=_0x4d2a,_0x40793b=_0x52e9ad();while(!![]){try{const _0x227a7=parseInt(_0x7a2a62(0x14d))/0x1+parseInt(_0x7a2a62(0x1dd))/0x2*(parseInt(_0x7a2a62(0x1d0))/0x3)+parseInt(_0x7a2a62(0x1d5))/0x4+parseInt(_0x7a2a62(0x198))/0x5*(-parseInt(_0x7a2a62(0x20d))/0x6)+parseInt(_0x7a2a62(0x1cb))/0x7*(parseInt(_0x7a2a62(0x168))/0x8)+-parseInt(_0x7a2a62(0x21a))/0x9*(-parseInt(_0x7a2a62(0x1e2))/0xa)+-parseInt(_0x7a2a62(0x215))/0xb;if(_0x227a7===_0x20a629)break;else _0x40793b['push'](_0x40793b['shift']());}catch(_0x1edc4f){_0x40793b['push'](_0x40793b['shift']());}}}(_0x312d,0x49767));import{initializeApp}from'https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js';import{getAuth,signInAnonymously,onAuthStateChanged}from'https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js';import{getFirestore,doc,getDoc,setDoc,updateDoc,onSnapshot,serverTimestamp,runTransaction,deleteDoc,deleteField,increment,collection}from'https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js';const firebaseConfig={'apiKey':_0x574540(0x1d8),'authDomain':'game24-69666.firebaseapp.com','projectId':_0x574540(0x228),'storageBucket':'game24-69666.firebasestorage.app','messagingSenderId':_0x574540(0x171),'appId':_0x574540(0x176),'measurementId':'G-B1ZTE90SGG'},$=_0x481609=>document[_0x574540(0x1b4)](_0x481609),$$=_0x5ac69b=>Array[_0x574540(0x169)](document['querySelectorAll'](_0x5ac69b)),playerJoinView=$('#player-join-view'),playerWaitView=$(_0x574540(0x157)),adminLobbyView=$('#admin-lobby-view'),gameView=$(_0x574540(0x202)),adminLoginModal=$(_0x574540(0x1e3)),adminSettingsModal=$('#admin-settings-modal'),gameOverView=$(_0x574540(0x16b)),sudokuEl=$(_0x574540(0x1f3)),pickerEl=$(_0x574540(0x181)),playerList=$(_0x574540(0x229)),lobbyPlayerNameList=$(_0x574540(0x15f)),lobbyPlayerCount=$(_0x574540(0x1eb)),hostControls=$(_0x574540(0x150)),toastEl=$('#toast'),gameCodeDisplay=$(_0x574540(0x194)),gameTimerEl=$(_0x574540(0x17b)),puzzleProgressEl=$(_0x574540(0x1f4)),playerScoreDisplay=$(_0x574540(0x203)),gameBoard=$(_0x574540(0x1ad)),playerFinishedView=$(_0x574540(0x1d4)),podiumContainer=$(_0x574540(0x214)),otherRankingsList=$(_0x574540(0x1cd)),otherRankingsContainer=$(_0x574540(0x173)),targetNumberDisplay=$('#target-number-display');let db,auth,userId,currentPlayerName,isHost=![],currentGameId=null,unsubscribeGameListener=null,unsubscribePlayerStateListener=null,timerInterval=null,allPlayerStates={},unsubscribeAllPlayerStates=null,latestGameData={},previousGameStatus=null,isPracticeMode=![],practicePuzzles=null,currentPracticeLevel=null,given=new Array(0x10)[_0x574540(0x1f7)](0x0),board=new Array(0x10)[_0x574540(0x1f7)](0x0),solution=new Array(0x10)['fill'](0x0),selectedIdx=-0x1,hasMistake=![],gameSettings={'timeLimit':0x3c,'resultDisplayMode':_0x574540(0x196),'difficulty':_0x574540(0x1bc),'numQuestions':0x1};function toast(_0x1bf533,_0x29b204=0x7d0){const _0x187fd5=_0x574540;toastEl['textContent']=_0x1bf533,toastEl[_0x187fd5(0x163)][_0x187fd5(0x199)](_0x187fd5(0x227)),setTimeout(()=>toastEl['classList'][_0x187fd5(0x1db)](_0x187fd5(0x227)),_0x29b204);}const rnd=(_0x473bf6,_0x48aa0a)=>Math[_0x574540(0x206)](Math['random']()*(_0x48aa0a-_0x473bf6+0x1))+_0x473bf6,themeKey=_0x574540(0x201),themeSelect=$(_0x574540(0x217));function applyTheme(_0x4eb306){const _0x4f4faa=_0x574540;document[_0x4f4faa(0x226)]['setAttribute'](_0x4f4faa(0x19d),_0x4eb306),localStorage['setItem'](themeKey,_0x4eb306);}const savedTheme=localStorage['getItem'](themeKey),initialTheme=savedTheme||_0x574540(0x151);applyTheme(initialTheme);function _0x4d2a(_0x36f4d6,_0x352c4d){const _0x312d34=_0x312d();return _0x4d2a=function(_0x4d2aec,_0x4eff17){_0x4d2aec=_0x4d2aec-0x14d;let _0x1dcbdf=_0x312d34[_0x4d2aec];return _0x1dcbdf;},_0x4d2a(_0x36f4d6,_0x352c4d);}themeSelect&&themeSelect[_0x574540(0x20b)](_0x574540(0x18b),()=>applyTheme(themeSelect[_0x574540(0x224)]));function baseSolved(){return[0x1,0x2,0x3,0x4,0x3,0x4,0x1,0x2,0x2,0x1,0x4,0x3,0x4,0x3,0x2,0x1];}function shuffle(_0x5b39c2){const _0x45ccdf=_0x574540;for(let _0x5a1417=_0x5b39c2[_0x45ccdf(0x184)]-0x1;_0x5a1417>0x0;_0x5a1417--){const _0xd7bfe6=Math[_0x45ccdf(0x206)](Math[_0x45ccdf(0x1ba)]()*(_0x5a1417+0x1));[_0x5b39c2[_0x5a1417],_0x5b39c2[_0xd7bfe6]]=[_0x5b39c2[_0xd7bfe6],_0x5b39c2[_0x5a1417]];}return _0x5b39c2;}function applyPermutations(_0x376522){const _0x53bc43=_0x574540;let _0x595419=_0x376522[_0x53bc43(0x164)]();const _0x404655=(_0x2424f9,_0x380411)=>{for(let _0xd6a080=0x0;_0xd6a080<0x4;_0xd6a080++){const _0x4ed67f=_0x2424f9*0x4+_0xd6a080,_0x17f3b0=_0x380411*0x4+_0xd6a080;[_0x595419[_0x4ed67f],_0x595419[_0x17f3b0]]=[_0x595419[_0x17f3b0],_0x595419[_0x4ed67f]];}},_0x23b7c3=(_0x4e1d42,_0x188503)=>{for(let _0x172943=0x0;_0x172943<0x4;_0x172943++){const _0x57d3bf=_0x172943*0x4+_0x4e1d42,_0x44202c=_0x172943*0x4+_0x188503;[_0x595419[_0x57d3bf],_0x595419[_0x44202c]]=[_0x595419[_0x44202c],_0x595419[_0x57d3bf]];}};if(Math[_0x53bc43(0x1ba)]()<0.5)_0x404655(0x0,0x1);if(Math[_0x53bc43(0x1ba)]()<0.5)_0x404655(0x2,0x3);if(Math['random']()<0.5)_0x23b7c3(0x0,0x1);if(Math['random']()<0.5)_0x23b7c3(0x2,0x3);if(Math[_0x53bc43(0x1ba)]()<0.5)for(let _0x4048b1=0x0;_0x4048b1<0x4;_0x4048b1++){const _0x3919cc=0x0*0x4+_0x4048b1,_0x17640c=0x2*0x4+_0x4048b1;[_0x595419[_0x3919cc],_0x595419[_0x17640c]]=[_0x595419[_0x17640c],_0x595419[_0x3919cc]];const _0x2fef65=0x1*0x4+_0x4048b1,_0x223d96=0x3*0x4+_0x4048b1;[_0x595419[_0x2fef65],_0x595419[_0x223d96]]=[_0x595419[_0x223d96],_0x595419[_0x2fef65]];}if(Math['random']()<0.5)for(let _0x203f3c=0x0;_0x203f3c<0x4;_0x203f3c++){const _0x526704=_0x203f3c*0x4+0x0,_0x36e0ff=_0x203f3c*0x4+0x2;[_0x595419[_0x526704],_0x595419[_0x36e0ff]]=[_0x595419[_0x36e0ff],_0x595419[_0x526704]];const _0x203405=_0x203f3c*0x4+0x1,_0x28fc51=_0x203f3c*0x4+0x3;[_0x595419[_0x203405],_0x595419[_0x28fc51]]=[_0x595419[_0x28fc51],_0x595419[_0x203405]];}const _0x553f38=[0x0,...shuffle([0x1,0x2,0x3,0x4])];for(let _0x4f60eb=0x0;_0x4f60eb<0x10;_0x4f60eb++)_0x595419[_0x4f60eb]=_0x553f38[_0x595419[_0x4f60eb]];return _0x595419;}function _0x312d(){const _0x476441=['542733tnzsZX','closest','#sudoku\x20.cell','ไม่พบห้องเกมนี้','#player-finished-view','585504myYzFd','max','/16)','AIzaSyAJsk4l8I8uCYpJY8jZLAlRW1w2qLWN-2o','ไม่สามารถเข้าร่วมได้\x20เกมเริ่มไปแล้ว','split','remove','players.','4QePsRM','toggle','<li><span>','</strong></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>เวลาที่ใช้:\x20<strong\x20class=\x22text-xl\x22\x20style=\x22color:\x20var(--accent);\x22>','...','440mSpdfc','#admin-login-modal','sudoku','.cell','#admin-back-btn','entries','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22player-name\x22>','#home-btn','ห้องเกมถูกปิดแล้ว','#lobby-player-count','update','finished','#start-practice-btn','Transaction\x20aborted,\x20likely\x20because\x20another\x20player\x20finished\x20first.','min','gameMode','forEach','#sudoku','#puzzle-progress','lobby','.app','fill','#cancel-settings-btn','8899','board','player-join','log','toString','หมดเวลา!','error','เสร็จแล้ว!','g24_theme_mp','#game-view','#player-score-display','every','mixed','floor','padStart','join','push','.currentLevel','addEventListener','wait','610962dMonNL','.pick','winner','textContent','#time-limit-input','#game-code-input','click','#podium-container','5239707LyJzAU','aborted','#themeSelect','#toggle-sidebar-btn','game-over','15597DQcTyB','#competition-settings','ArrowLeft','player-wait','createElement','startTime','conflict','score','target','<i\x20class=\x22fas\x20fa-play\x20mr-2\x22></i>เริ่มแข่งขัน','value','puzzle','documentElement','show','game24-69666','#player-list','indexOf','exists','warn','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','\x20คะแนน</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22rank\x22>','Finish\x20attempt\x20failed:','easy','admin-login','sort','map','difficulty','248427bDYABC','เยี่ยมมาก!','\x20คะแนน\x20(','#host-controls','contrast','Sudoku\x204x4','cell\x20','#player-finished-view\x20h2','playerStates','solution','#player-wait-view','currentLevel','Firebase\x20init\x20failed:','filter','<i\x20class=\x22fas\x20fa-crown\x20mr-2\x22></i>ผู้ชนะคือ\x20','Error\x20returning\x20to\x20lobby:','Error\x20joining\x20game:','keys','#lobby-player-name-list','Delete','<p\x20class=\x22text-gray-500\x20text-center\x20w-full\x22>ยังไม่มีใครเข้าร่วม...</p>','#player-finished-view\x20p','classList','slice','timeLimit','div','admin-lobby','394712aFAwMR','from','game','#game-over-view','<i\x20class=\x22fas\x20fa-trophy\x20mr-2\x22></i>หมดเวลา!','player-view','เกิดข้อผิดพลาดในการจบเกม','.finishTime','ArrowDown','989271279576','data','#other-rankings-container','#start-game-btn','เกิดข้อผิดพลาดในการกลับสู่ล็อบบี้','1:989271279576:web:43115bbaeeae31160954ad','<div\x20class=\x22player-row\x22><span\x20class=\x22player-name\x22>','key','รหัสผ่านไม่ถูกต้อง','/16','#game-timer','เข้าร่วมสำเร็จ!\x20รอสักครู่...','</strong></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','Game\x20not\x20found','เกมจบแล้ว\x20มีผู้ชนะแล้ว!','style','#picker','selected','hard','length','innerHTML','message','dataset','</span><span\x20class=\x22player-progress\x22>','filled','เสร็จแล้ว','change','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22text-lg\x20mt-4\x22>คะแนนรอบนี้:</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22text-4xl\x20font-bold\x22\x20style=\x22color:\x20var(--accent);\x22>','<i\x20class=\x22fas\x20fa-check-circle\x20mr-2\x22></i>ฝึกซ้อมสำเร็จ!','.score','#reset-btn','กลับไปหน้าแรก','hidden','given','เยี่ยม!\x20ด่านต่อไป:\x20ปานกลาง','#game-code-display','เวลา:\x20','immediate','input[name=\x22resultDisplayMode\x22]:checked','10fDHExj','add','beforeunload','#difficulty-select','board\x20sync\x20failed','data-theme','toMillis','get','now','ด่าน\x20','includes','findIndex','แอดมินได้สร้างห้องใหม่แล้ว','admin-settings','#admin-icon-btn','className','players','ArrowUp','รอผลการแข่งขันสักครู่...','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22text-center\x20text-lg\x20space-y-4\x20my-8\x20p-6\x20rounded-lg\x22\x20style=\x22background:\x20var(--card-bg);\x20border:\x202px\x20solid\x20var(--card-border);\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>ความยาก:\x20<strong\x20class=\x22text-xl\x22\x20style=\x22color:\x20var(--accent);\x22>','ฝึกซ้อม:\x20','#game-board','appendChild','podium-stand\x20podium-','puzzles','<i\x20class=\x22fas\x20fa-play\x20mr-2\x22></i>เริ่มฝึกซ้อม','#back-to-lobby-btn','finishTime','querySelector','คะแนน:\x20','idx','replace','onclick','การเชื่อมต่อล้มเหลว','random','status','medium','Error\x20starting\x20game:','กรุณากรอกข้อมูลให้ครบถ้วน','Player\x20not\x20found\x20in\x20game','playing','games','body','keydown','#practice-score-display','values','#player-name-input','single','.filled','#join-game-btn','uid','21TDfsSV','resultDisplayMode','#other-rankings-list','set','</div>'];_0x312d=function(){return _0x476441;};return _0x312d();}function countSolutions(_0xf1d433){const _0x16d0dc=_0x574540;let _0x446735=_0xf1d433[_0x16d0dc(0x164)](),_0x5121d7=0x0;function _0x4093b9(_0x40476c,_0x26391e){const _0x264036=_0x16d0dc,_0x83eed8=Math['floor'](_0x40476c/0x4),_0x542a2a=_0x40476c%0x4;for(let _0x4590a4=0x0;_0x4590a4<0x4;_0x4590a4++){if(_0x446735[_0x83eed8*0x4+_0x4590a4]===_0x26391e&&_0x4590a4!==_0x542a2a)return![];if(_0x446735[_0x4590a4*0x4+_0x542a2a]===_0x26391e&&_0x4590a4!==_0x83eed8)return![];}const _0x346112=Math[_0x264036(0x206)](_0x83eed8/0x2)*0x2,_0x1ca796=Math['floor'](_0x542a2a/0x2)*0x2;for(let _0x61e3d1=_0x346112;_0x61e3d1<_0x346112+0x2;_0x61e3d1++)for(let _0x33af15=_0x1ca796;_0x33af15<_0x1ca796+0x2;_0x33af15++){const _0x50bf28=_0x61e3d1*0x4+_0x33af15;if(_0x50bf28!==_0x40476c&&_0x446735[_0x50bf28]===_0x26391e)return![];}return!![];}function _0x2f86de(_0x4d834c=0x0){while(_0x4d834c<0x10&&_0x446735[_0x4d834c]!==0x0)_0x4d834c++;if(_0x4d834c===0x10)return _0x5121d7++,_0x5121d7;for(let _0x541386=0x1;_0x541386<=0x4;_0x541386++){if(_0x4093b9(_0x4d834c,_0x541386)){_0x446735[_0x4d834c]=_0x541386,_0x2f86de(_0x4d834c+0x1);if(_0x5121d7>0x1)return _0x5121d7;_0x446735[_0x4d834c]=0x0;}}return _0x5121d7;}return _0x2f86de(0x0);}function makePuzzleByClues(_0x4bdb83,_0x465c3d){const _0x48cc5a=_0x574540;let _0x10e6f9=_0x4bdb83['slice']();const _0x277f34=shuffle([...Array(0x10)[_0x48cc5a(0x15e)]()]);let _0x4aec43=0x0;for(const _0x42c6f7 of _0x277f34){if(0x10-_0x4aec43<=_0x465c3d)break;const _0xa567af=_0x10e6f9[_0x42c6f7];_0x10e6f9[_0x42c6f7]=0x0,countSolutions(_0x10e6f9)!==0x1?_0x10e6f9[_0x42c6f7]=_0xa567af:_0x4aec43++;}return _0x10e6f9;}function generateSudoku(_0x365c2d){const _0x51bcee=applyPermutations(baseSolved());let _0x36008c={'easy':[0x9,0xa],'medium':[0x7,0x8],'hard':[0x5,0x6]}[_0x365c2d]||[0x7,0x8];const _0x289942=rnd(_0x36008c[0x0],_0x36008c[0x1]);let _0x49f4c2=makePuzzleByClues(_0x51bcee,_0x289942);if(countSolutions(_0x49f4c2)!==0x1)return generateSudoku(_0x365c2d);return{'solution':_0x51bcee,'puzzle':_0x49f4c2};}function cellClasses(_0x49f0ce){const _0x42597c=_0x574540,_0x1fc7f2=Math[_0x42597c(0x206)](_0x49f0ce/0x4),_0x12cd27=_0x49f0ce%0x4,_0x51b924=[];if(_0x12cd27===0x1)_0x51b924[_0x42597c(0x209)]('bR');if(_0x1fc7f2===0x1)_0x51b924['push']('bB');return _0x51b924['join']('\x20');}function updateBoardFromState(_0x463af7){const _0x50d531=_0x574540;for(let _0x409e3f=0x0;_0x409e3f<0x10;_0x409e3f++){if(board[_0x409e3f]!==_0x463af7[_0x409e3f]){const _0x3b1390=sudokuEl[_0x50d531(0x1b4)]('[data-idx=\x22'+_0x409e3f+'\x22]');_0x3b1390&&(_0x3b1390[_0x50d531(0x210)]=_0x463af7[_0x409e3f]?_0x463af7[_0x409e3f]:'');}}board=_0x463af7,markConflictsAll(),updateProgressText();}function renderSudoku(){const _0xe00165=_0x574540;sudokuEl[_0xe00165(0x185)]='';for(let _0x4e8ec3=0x0;_0x4e8ec3<0x10;_0x4e8ec3++){const _0x57feed=board[_0x4e8ec3],_0x11c7ca=document[_0xe00165(0x21e)](_0xe00165(0x166));_0x11c7ca[_0xe00165(0x1a7)]=_0xe00165(0x153)+cellClasses(_0x4e8ec3)+'\x20'+(given[_0x4e8ec3]?_0xe00165(0x192):''),_0x11c7ca[_0xe00165(0x187)][_0xe00165(0x1b6)]=_0x4e8ec3,_0x11c7ca['textContent']=_0x57feed?_0x57feed:'',!given[_0x4e8ec3]&&_0x11c7ca[_0xe00165(0x20b)](_0xe00165(0x213),()=>selectCell(_0x4e8ec3)),sudokuEl['appendChild'](_0x11c7ca);}if(selectedIdx>=0x0)highlightRelatives(selectedIdx);markConflictsAll(),updateProgressText();}function selectCell(_0x50599c){const _0x275fcf=_0x574540;selectedIdx=_0x50599c,$$(_0x275fcf(0x1e5))['forEach'](_0x4a1e89=>_0x4a1e89[_0x275fcf(0x163)]['remove'](_0x275fcf(0x182),'hl'));const _0x33c84e=$$('.cell')[_0x50599c];_0x33c84e[_0x275fcf(0x163)][_0x275fcf(0x199)](_0x275fcf(0x182)),highlightRelatives(_0x50599c);}function highlightRelatives(_0x4da342){const _0x44b447=Math['floor'](_0x4da342/0x4),_0x33a55b=_0x4da342%0x4;$$('.cell')['forEach']((_0x4c2677,_0x59b396)=>{const _0x2cf76c=_0x4d2a,_0x2daae8=Math['floor'](_0x59b396/0x4),_0x361e4e=_0x59b396%0x4;(_0x2daae8===_0x44b447||_0x361e4e===_0x33a55b||Math[_0x2cf76c(0x206)](_0x2daae8/0x2)===Math[_0x2cf76c(0x206)](_0x44b447/0x2)&&Math[_0x2cf76c(0x206)](_0x361e4e/0x2)===Math['floor'](_0x33a55b/0x2))&&_0x4c2677[_0x2cf76c(0x163)][_0x2cf76c(0x199)]('hl');});}function setNumber(_0x2955cd){const _0x129efd=_0x574540;if(selectedIdx<0x0||given[selectedIdx])return;const _0x182876=$$('.cell')[selectedIdx];_0x182876[_0x129efd(0x210)]=_0x2955cd?_0x2955cd:'',board[selectedIdx]=_0x2955cd;_0x2955cd!==0x0&&causesConflict(selectedIdx)&&(hasMistake=!![]);markConflictsAll(),updateProgressText(),scheduleBoardSync();if(isSolved())tryFinish();}function markConflictsAll(){const _0x568b57=_0x574540;$$(_0x568b57(0x1e5))[_0x568b57(0x1f2)](_0x32a63f=>_0x32a63f['classList']['remove'](_0x568b57(0x220),'ok'));for(let _0x304056=0x0;_0x304056<0x10;_0x304056++){if(board[_0x304056]!==0x0&&causesConflict(_0x304056))$$(_0x568b57(0x1e5))[_0x304056][_0x568b57(0x163)][_0x568b57(0x199)](_0x568b57(0x220));else board[_0x304056]!==0x0&&$$(_0x568b57(0x1e5))[_0x304056]['classList'][_0x568b57(0x199)]('ok');}}function causesConflict(_0x53b6dd){const _0x484520=_0x574540,_0x43105d=board[_0x53b6dd];if(_0x43105d===0x0)return![];const _0x383ed7=Math[_0x484520(0x206)](_0x53b6dd/0x4),_0x5db563=_0x53b6dd%0x4;for(let _0x4ef98a=0x0;_0x4ef98a<0x4;_0x4ef98a++){if(_0x4ef98a!==_0x5db563&&board[_0x383ed7*0x4+_0x4ef98a]===_0x43105d)return!![];if(_0x4ef98a!==_0x383ed7&&board[_0x4ef98a*0x4+_0x5db563]===_0x43105d)return!![];}const _0xe94f1f=Math[_0x484520(0x206)](_0x383ed7/0x2)*0x2,_0x29f8a2=Math[_0x484520(0x206)](_0x5db563/0x2)*0x2;for(let _0x167b95=_0xe94f1f;_0x167b95<_0xe94f1f+0x2;_0x167b95++)for(let _0x2f0100=_0x29f8a2;_0x2f0100<_0x29f8a2+0x2;_0x2f0100++){const _0x1708e9=_0x167b95*0x4+_0x2f0100;if(_0x1708e9!==_0x53b6dd&&board[_0x1708e9]===_0x43105d)return!![];}return![];}function isSolved(){for(let _0x3a6eb0=0x0;_0x3a6eb0<0x10;_0x3a6eb0++)if(board[_0x3a6eb0]!==solution[_0x3a6eb0])return![];return!![];}function updateProgressText(){const _0x17f0a6=_0x574540,_0x30a7db=board['filter'](_0x557101=>_0x557101!==0x0)[_0x17f0a6(0x184)];puzzleProgressEl[_0x17f0a6(0x210)]='เติมแล้ว\x20'+_0x30a7db+_0x17f0a6(0x17a);}pickerEl['addEventListener'](_0x574540(0x213),_0x429f0f=>{const _0x47d02f=_0x574540,_0x3be9a8=_0x429f0f[_0x47d02f(0x222)][_0x47d02f(0x1d1)](_0x47d02f(0x20e));if(!_0x3be9a8)return;setNumber(parseInt(_0x3be9a8[_0x47d02f(0x187)]['n'],0xa));}),document[_0x574540(0x20b)](_0x574540(0x1c3),_0x4b227c=>{const _0x5663e6=_0x574540;if(selectedIdx<0x0)return;_0x4b227c[_0x5663e6(0x178)]>='1'&&_0x4b227c['key']<='4'&&setNumber(parseInt(_0x4b227c[_0x5663e6(0x178)],0xa));(_0x4b227c[_0x5663e6(0x178)]==='Backspace'||_0x4b227c[_0x5663e6(0x178)]===_0x5663e6(0x160)||_0x4b227c[_0x5663e6(0x178)]==='0')&&setNumber(0x0);const _0x330f5d=Math[_0x5663e6(0x206)](selectedIdx/0x4),_0x530b3b=selectedIdx%0x4;if(_0x4b227c[_0x5663e6(0x178)]==='ArrowRight')selectCell(_0x330f5d*0x4+Math[_0x5663e6(0x1f0)](_0x530b3b+0x1,0x3));if(_0x4b227c[_0x5663e6(0x178)]===_0x5663e6(0x21c))selectCell(_0x330f5d*0x4+Math[_0x5663e6(0x1d6)](_0x530b3b-0x1,0x0));if(_0x4b227c[_0x5663e6(0x178)]===_0x5663e6(0x170))selectCell(Math[_0x5663e6(0x1f0)]((_0x330f5d+0x1)*0x4+_0x530b3b,0xf));if(_0x4b227c[_0x5663e6(0x178)]===_0x5663e6(0x1a9))selectCell(Math['max']((_0x330f5d-0x1)*0x4+_0x530b3b,0x0));});async function initialize(){const _0x3dc22b=_0x574540;try{const _0x132fdf=initializeApp(firebaseConfig);db=getFirestore(_0x132fdf),auth=getAuth(_0x132fdf),onAuthStateChanged(auth,async _0x19f680=>{!_0x19f680&&await signInAnonymously(auth);});}catch(_0x2eaf60){console['error'](_0x3dc22b(0x159),_0x2eaf60),toast(_0x3dc22b(0x1b9));}}function showView(_0x4ce8d8){const _0x2ac5ac=_0x574540;[playerJoinView,playerWaitView,adminLoginModal,adminLobbyView,gameView,gameOverView,adminSettingsModal][_0x2ac5ac(0x1f2)](_0x2de8dd=>_0x2de8dd[_0x2ac5ac(0x163)][_0x2ac5ac(0x199)](_0x2ac5ac(0x191)));const _0x331b66=$(_0x2ac5ac(0x1a6));if(_0x4ce8d8===_0x2ac5ac(0x1fb)||_0x4ce8d8==='admin-login')_0x331b66[_0x2ac5ac(0x163)]['remove'](_0x2ac5ac(0x191));else isHost?_0x331b66[_0x2ac5ac(0x163)][_0x2ac5ac(0x1db)](_0x2ac5ac(0x191)):_0x331b66[_0x2ac5ac(0x163)]['add'](_0x2ac5ac(0x191));if(_0x4ce8d8===_0x2ac5ac(0x1fb))playerJoinView[_0x2ac5ac(0x163)]['remove'](_0x2ac5ac(0x191));else{if(_0x4ce8d8===_0x2ac5ac(0x21d))playerWaitView[_0x2ac5ac(0x163)][_0x2ac5ac(0x1db)](_0x2ac5ac(0x191));else{if(_0x4ce8d8==='admin-login')adminLoginModal[_0x2ac5ac(0x163)][_0x2ac5ac(0x1db)](_0x2ac5ac(0x191));else{if(_0x4ce8d8===_0x2ac5ac(0x167))adminLobbyView[_0x2ac5ac(0x163)][_0x2ac5ac(0x1db)](_0x2ac5ac(0x191));else{if(_0x4ce8d8===_0x2ac5ac(0x1a5))adminSettingsModal['classList'][_0x2ac5ac(0x1db)]('hidden');else{if(_0x4ce8d8===_0x2ac5ac(0x16a))gameView['classList']['remove'](_0x2ac5ac(0x191));else{if(_0x4ce8d8===_0x2ac5ac(0x219))gameOverView[_0x2ac5ac(0x163)][_0x2ac5ac(0x1db)](_0x2ac5ac(0x191));}}}}}}}async function createGameRoom(){const _0x526289=_0x574540;isHost=!![],document[_0x526289(0x1c2)][_0x526289(0x163)]['remove'](_0x526289(0x16d)),showView(_0x526289(0x167)),gameCodeDisplay[_0x526289(0x210)]=_0x526289(0x1e1);const _0x32ead2=rnd(0xa,0x63)[_0x526289(0x1fd)]();currentGameId=_0x32ead2;const _0x44bf1e={'hostId':auth['currentUser'][_0x526289(0x1ca)],'status':'lobby','players':{},'createdAt':serverTimestamp()};await setDoc(doc(db,'games',currentGameId),_0x44bf1e),gameCodeDisplay[_0x526289(0x210)]=currentGameId,listenForGameUpdates(currentGameId);}async function handleStartGame(){const _0x555877=_0x574540;if(!isHost||!currentGameId)return;gameSettings[_0x555877(0x1cc)]=document['querySelector'](_0x555877(0x197))[_0x555877(0x224)],gameSettings['timeLimit']=Math[_0x555877(0x1d6)](0xa,parseInt($(_0x555877(0x211))[_0x555877(0x224)]||'60',0xa)),gameSettings[_0x555877(0x234)]=$(_0x555877(0x19b))[_0x555877(0x224)];const _0x6e369f=doc(db,_0x555877(0x1c1),currentGameId);try{await runTransaction(db,async _0x213c62=>{const _0x4b3c2d=_0x555877,_0x39aaca=await _0x213c62[_0x4b3c2d(0x19f)](_0x6e369f);if(!_0x39aaca[_0x4b3c2d(0x22b)]())throw'Game\x20does\x20not\x20exist!';const _0x20c642=_0x39aaca[_0x4b3c2d(0x172)]()[_0x4b3c2d(0x1a8)]||{},_0x2afbdc={'status':_0x4b3c2d(0x1c0),'startTime':serverTimestamp(),'gameMode':gameSettings};if(gameSettings[_0x4b3c2d(0x234)]===_0x4b3c2d(0x205)){gameSettings['numQuestions']=0x3;const _0x4df408=generateSudoku(_0x4b3c2d(0x230)),_0x3c158a=generateSudoku(_0x4b3c2d(0x1bc)),_0x3225c6=generateSudoku('hard');_0x2afbdc[_0x4b3c2d(0x1b0)]={'easy':_0x4df408,'medium':_0x3c158a,'hard':_0x3225c6};}else gameSettings['numQuestions']=0x1,_0x2afbdc[_0x4b3c2d(0x1e4)]=generateSudoku(gameSettings['difficulty']);for(const _0x2e57d5 in _0x20c642){_0x2afbdc[_0x4b3c2d(0x1dc)+_0x2e57d5+_0x4b3c2d(0x18e)]=0x0,_0x2afbdc[_0x4b3c2d(0x1dc)+_0x2e57d5+'.finishTime']=null,_0x2afbdc[_0x4b3c2d(0x1dc)+_0x2e57d5+_0x4b3c2d(0x1c8)]=0x0;const _0x3e1e01=doc(db,'games',currentGameId,_0x4b3c2d(0x155),_0x2e57d5);let _0x350b8b,_0x5e3889;gameSettings[_0x4b3c2d(0x234)]===_0x4b3c2d(0x205)?(_0x350b8b=_0x2afbdc[_0x4b3c2d(0x1b0)][_0x4b3c2d(0x230)][_0x4b3c2d(0x225)],_0x2afbdc[_0x4b3c2d(0x1dc)+_0x2e57d5+_0x4b3c2d(0x20a)]='easy'):_0x350b8b=_0x2afbdc[_0x4b3c2d(0x1e4)][_0x4b3c2d(0x225)];_0x5e3889=_0x350b8b[_0x4b3c2d(0x15a)](_0x377ed5=>_0x377ed5!==0x0)['length'],_0x2afbdc[_0x4b3c2d(0x1dc)+_0x2e57d5+_0x4b3c2d(0x1c8)]=_0x5e3889;const _0x15c97d={'board':_0x350b8b['join'](''),'hasMistake':![]};_0x213c62['set'](_0x3e1e01,_0x15c97d);}_0x213c62[_0x4b3c2d(0x1ec)](_0x6e369f,_0x2afbdc);}),showView(_0x555877(0x16a));}catch(_0x19511f){console[_0x555877(0x1ff)](_0x555877(0x1bd),_0x19511f),toast('เกิดข้อผิดพลาดในการเริ่มเกม');}}function startPracticeGame(){const _0x1ce3bd=_0x574540;isPracticeMode=!![],gameSettings[_0x1ce3bd(0x165)]=Math['max'](0xa,parseInt($(_0x1ce3bd(0x211))['value']||'60',0xa)),gameSettings[_0x1ce3bd(0x234)]=$(_0x1ce3bd(0x19b))[_0x1ce3bd(0x224)],document[_0x1ce3bd(0x1c2)][_0x1ce3bd(0x163)][_0x1ce3bd(0x199)]('player-view'),hostControls[_0x1ce3bd(0x163)][_0x1ce3bd(0x199)](_0x1ce3bd(0x191)),playerScoreDisplay[_0x1ce3bd(0x163)][_0x1ce3bd(0x199)]('hidden'),$('#toggle-sidebar-btn')[_0x1ce3bd(0x163)][_0x1ce3bd(0x199)](_0x1ce3bd(0x191));if(gameSettings[_0x1ce3bd(0x234)]===_0x1ce3bd(0x205))practicePuzzles={'easy':generateSudoku('easy'),'medium':generateSudoku('medium'),'hard':generateSudoku(_0x1ce3bd(0x183))},currentPracticeLevel=_0x1ce3bd(0x230),loadPracticePuzzle(currentPracticeLevel);else{practicePuzzles=null,currentPracticeLevel=gameSettings['difficulty'];const _0xc9e963=generateSudoku(gameSettings[_0x1ce3bd(0x234)]);given=_0xc9e963[_0x1ce3bd(0x225)][_0x1ce3bd(0x164)](),board=_0xc9e963[_0x1ce3bd(0x225)][_0x1ce3bd(0x164)](),solution=_0xc9e963[_0x1ce3bd(0x156)][_0x1ce3bd(0x164)](),targetNumberDisplay[_0x1ce3bd(0x210)]='ฝึกซ้อม:\x20'+gameSettings[_0x1ce3bd(0x234)];}hasMistake=![],selectedIdx=board[_0x1ce3bd(0x1a3)]((_0x3cba49,_0x3175ec)=>!given[_0x3175ec]);if(selectedIdx<0x0)selectedIdx=0x0;showView(_0x1ce3bd(0x16a)),gameBoard['classList']['remove'](_0x1ce3bd(0x191)),playerFinishedView[_0x1ce3bd(0x163)]['add'](_0x1ce3bd(0x191)),pickerEl[_0x1ce3bd(0x163)]['remove']('hidden'),$(_0x1ce3bd(0x18f))['classList']['remove'](_0x1ce3bd(0x191)),$(_0x1ce3bd(0x1e9))[_0x1ce3bd(0x163)][_0x1ce3bd(0x1db)](_0x1ce3bd(0x191)),renderSudoku(),startPracticeTimer();}function loadPracticePuzzle(_0x4b4490){const _0x291795=_0x574540,_0x536562=practicePuzzles[_0x4b4490];given=_0x536562[_0x291795(0x225)][_0x291795(0x164)](),board=_0x536562['puzzle'][_0x291795(0x164)](),solution=_0x536562[_0x291795(0x156)][_0x291795(0x164)](),hasMistake=![],selectedIdx=board[_0x291795(0x1a3)]((_0x73a47e,_0x1c5fd1)=>!given[_0x1c5fd1]);if(selectedIdx<0x0)selectedIdx=0x0;targetNumberDisplay[_0x291795(0x210)]=_0x291795(0x1ac)+_0x4b4490,renderSudoku();}function startPracticeTimer(){if(timerInterval)clearInterval(timerInterval);let _0x51d598=gameSettings['timeLimit'];const _0x174433=()=>{const _0x52f278=_0x4d2a,_0x5a5d65=String(Math['floor'](_0x51d598/0x3c))[_0x52f278(0x207)](0x2,'0'),_0x2cb0b8=String(_0x51d598%0x3c)['padStart'](0x2,'0');gameTimerEl[_0x52f278(0x210)]=_0x52f278(0x195)+_0x5a5d65+':'+_0x2cb0b8;};_0x174433(),timerInterval=setInterval(()=>{const _0x24f889=_0x4d2a;_0x51d598--,_0x174433(),_0x51d598<=0x0&&(clearInterval(timerInterval),gameBoard[_0x24f889(0x163)][_0x24f889(0x199)]('hidden'),playerFinishedView[_0x24f889(0x163)][_0x24f889(0x1db)]('hidden'),$(_0x24f889(0x154))[_0x24f889(0x210)]=_0x24f889(0x1fe),$('#player-finished-view\x20p')[_0x24f889(0x210)]='ลองใหม่อีกครั้งนะ');},0x3e8);}async function forceEndGame(){const _0x108fca=_0x574540;if(!isHost||!currentGameId)return;const _0x557413=doc(db,_0x108fca(0x1c1),currentGameId),_0x4c3439=await getDoc(_0x557413);_0x4c3439[_0x108fca(0x22b)]()&&_0x4c3439['data']()['status']==='playing'&&await updateDoc(_0x557413,{'status':'finished','winner':null});}async function returnToLobby(){const _0x55d701=_0x574540;if(!isHost||!currentGameId)return;const _0x250145=doc(db,_0x55d701(0x1c1),currentGameId);try{await updateDoc(_0x250145,{'status':_0x55d701(0x1f5),'players':{},'winner':deleteField(),'sudoku':deleteField(),'puzzles':deleteField(),'startTime':deleteField(),'gameMode':deleteField()}),showView('admin-lobby');}catch(_0x4c990a){console[_0x55d701(0x1ff)](_0x55d701(0x15c),_0x4c990a),toast(_0x55d701(0x175));}}async function handleJoinGame(){const _0x33e2c3=_0x574540,_0x524e84=$(_0x33e2c3(0x212))[_0x33e2c3(0x224)],_0xee70e6=$(_0x33e2c3(0x1c6))[_0x33e2c3(0x224)]['trim']();if(!_0x524e84||!_0xee70e6)return toast(_0x33e2c3(0x1be));currentGameId=_0x524e84,currentPlayerName=_0xee70e6;const _0xfa15a6=doc(db,_0x33e2c3(0x1c1),currentGameId);try{await runTransaction(db,async _0x576239=>{const _0x42aac1=_0x33e2c3,_0x209b2b=await _0x576239[_0x42aac1(0x19f)](_0xfa15a6);if(!_0x209b2b[_0x42aac1(0x22b)]())throw new Error(_0x42aac1(0x1d3));const _0x5876b4=_0x209b2b[_0x42aac1(0x172)]();if(_0x5876b4[_0x42aac1(0x1bb)]!==_0x42aac1(0x1f5))throw new Error(_0x42aac1(0x1d9));let _0x5b69a4=_0xee70e6;_0x5876b4['players']&&_0x5876b4[_0x42aac1(0x1a8)][_0x5b69a4]&&(_0x5b69a4=''+_0xee70e6+rnd(0xa,0x63),toast('ชื่อซ้ำ,\x20เปลี่ยนเป็น\x20'+_0x5b69a4+'\x20แทน')),currentPlayerName=_0x5b69a4,_0x576239[_0x42aac1(0x1ec)](_0xfa15a6,{[_0x42aac1(0x1dc)+_0x5b69a4]:{'joined':!![]}});}),isHost=![],document[_0x33e2c3(0x1c2)][_0x33e2c3(0x163)][_0x33e2c3(0x199)](_0x33e2c3(0x16d)),toast(_0x33e2c3(0x17c)),listenForGameUpdates(currentGameId);}catch(_0x92fa8){console[_0x33e2c3(0x1ff)](_0x33e2c3(0x15d),_0x92fa8),toast(_0x92fa8[_0x33e2c3(0x186)]);}}function listenForGameUpdates(_0x21416a){const _0x50d8c0=_0x574540;if(unsubscribeGameListener)unsubscribeGameListener();const _0x414ce0=doc(db,_0x50d8c0(0x1c1),_0x21416a);unsubscribeGameListener=onSnapshot(_0x414ce0,_0xa17ff9=>{const _0x2767ec=_0x50d8c0;if(!_0xa17ff9[_0x2767ec(0x22b)]()){toast(_0x2767ec(0x1ea));if(unsubscribeGameListener)unsubscribeGameListener();if(unsubscribePlayerStateListener)unsubscribePlayerStateListener();if(unsubscribeAllPlayerStates)unsubscribeAllPlayerStates();timerInterval&&(clearInterval(timerInterval),timerInterval=null);isHost=![],document['body'][_0x2767ec(0x163)]['remove'](_0x2767ec(0x16d)),showView('player-join');return;}const _0xc511c3=_0xa17ff9[_0x2767ec(0x172)]();latestGameData=_0xc511c3;const _0x3f552e=_0xc511c3[_0x2767ec(0x1bb)];previousGameStatus==='playing'&&_0x3f552e!==_0x2767ec(0x1c0)&&isHost&&(unsubscribeAllPlayerStates&&(unsubscribeAllPlayerStates(),unsubscribeAllPlayerStates=null));if(!isHost&&previousGameStatus===_0x2767ec(0x1ed)&&_0x3f552e==='lobby'){if(unsubscribeGameListener)unsubscribeGameListener();if(unsubscribePlayerStateListener)unsubscribePlayerStateListener();unsubscribePlayerStateListener=null;if(timerInterval)clearInterval(timerInterval);currentGameId=null,currentPlayerName=null,toast(_0x2767ec(0x1a4)),document['body']['classList'][_0x2767ec(0x1db)]('player-view'),showView(_0x2767ec(0x1fb)),previousGameStatus=null;return;}previousGameStatus=_0x3f552e;if(_0x3f552e==='lobby'){timerInterval&&(clearInterval(timerInterval),timerInterval=null);if(unsubscribePlayerStateListener)unsubscribePlayerStateListener();unsubscribePlayerStateListener=null;if(isHost)showView('admin-lobby'),renderLobbyPlayers(_0xc511c3['players']);else showView('player-wait');}else{if(_0x3f552e===_0x2767ec(0x1c0)){startOrUpdateTimer(_0xc511c3),showView(_0x2767ec(0x16a));if(isHost){if(!unsubscribeAllPlayerStates){const _0x49da64=collection(db,_0x2767ec(0x1c1),_0x21416a,_0x2767ec(0x155));unsubscribeAllPlayerStates=onSnapshot(_0x49da64,_0x1e1fb7=>{const _0x15e6de=_0x2767ec;_0x1e1fb7['docs'][_0x15e6de(0x1f2)](_0x21da32=>{const _0x17f516=_0x15e6de;allPlayerStates[_0x21da32['id']]=_0x21da32[_0x17f516(0x172)]();}),renderAdminGameView();});}renderAdminGameView();if(_0xc511c3[_0x2767ec(0x1f1)]['resultDisplayMode']===_0x2767ec(0x20c)){const _0x3b7a9a=Object[_0x2767ec(0x1c5)](_0xc511c3[_0x2767ec(0x1a8)]||{});_0x3b7a9a[_0x2767ec(0x184)]>0x0&&_0x3b7a9a[_0x2767ec(0x204)](_0x2859f5=>_0x2859f5[_0x2767ec(0x1b3)])&&forceEndGame();}}else renderPlayerGameView(_0xc511c3),listenForPlayerState(_0x21416a,currentPlayerName);}else{if(_0x3f552e==='finished'){timerInterval&&(clearInterval(timerInterval),timerInterval=null);if(unsubscribePlayerStateListener)unsubscribePlayerStateListener();renderGameOverView(_0xc511c3);}}}});}function listenForPlayerState(_0xfc750b,_0x5b0e5c){const _0x2866e3=_0x574540;if(unsubscribePlayerStateListener)return;const _0x3908bd=doc(db,_0x2866e3(0x1c1),_0xfc750b,'playerStates',_0x5b0e5c);unsubscribePlayerStateListener=onSnapshot(_0x3908bd,_0x1152b0=>{const _0x120c93=_0x2866e3;if(_0x1152b0[_0x120c93(0x22b)]()){const _0x32d302=_0x1152b0['data'](),_0x2378c5=(_0x32d302[_0x120c93(0x1fa)]||'')[_0x120c93(0x1da)]('')[_0x120c93(0x233)](_0x57b293=>parseInt(_0x57b293,0xa)||0x0);hasMistake=!!_0x32d302['hasMistake'],updateBoardFromState(_0x2378c5);}});}function renderLobbyPlayers(_0x2bb11c){const _0x276597=_0x574540,_0xf40c6c=Object[_0x276597(0x15e)](_0x2bb11c||{});lobbyPlayerCount[_0x276597(0x210)]=_0xf40c6c[_0x276597(0x184)],lobbyPlayerNameList[_0x276597(0x185)]=_0xf40c6c[_0x276597(0x184)]===0x0?_0x276597(0x161):_0xf40c6c['map'](_0x337149=>'<div\x20class=\x22lobby-player-tag\x22>'+_0x337149+_0x276597(0x1cf))['join']('');}function startOrUpdateTimer(_0x93bd40){const _0x519772=_0x574540;if(timerInterval)clearInterval(timerInterval);const _0x449681=_0x93bd40[_0x519772(0x1f1)]||gameSettings,_0x190eab=_0x93bd40[_0x519772(0x21f)][_0x519772(0x19e)]();timerInterval=setInterval(()=>{const _0x516903=_0x519772,_0x314bb2=Math[_0x516903(0x206)]((Date[_0x516903(0x1a0)]()-_0x190eab)/0x3e8),_0xffbd36=_0x449681[_0x516903(0x165)]-_0x314bb2;if(_0xffbd36<=0x0){clearInterval(timerInterval),gameTimerEl['textContent']='เวลา:\x2000:00';if(isHost)forceEndGame();}else{const _0x13c3b1=String(Math[_0x516903(0x206)](_0xffbd36/0x3c))['padStart'](0x2,'0'),_0x322ae9=String(_0xffbd36%0x3c)[_0x516903(0x207)](0x2,'0');gameTimerEl[_0x516903(0x210)]=_0x516903(0x195)+_0x13c3b1+':'+_0x322ae9;}},0x1f4);}function renderAdminGameView(){const _0x303687=_0x574540,_0xcc3ca2=latestGameData;if(!_0xcc3ca2||!_0xcc3ca2[_0x303687(0x1a8)])return;$(_0x303687(0x218))['classList'][_0x303687(0x1db)](_0x303687(0x191)),hostControls[_0x303687(0x163)][_0x303687(0x1db)](_0x303687(0x191));const _0x210d8e=_0xcc3ca2[_0x303687(0x1a8)]||{},_0x5b431c=Object[_0x303687(0x1e7)](_0x210d8e)[_0x303687(0x232)]((_0x20d51f,_0x4da347)=>{const _0x29e6d3=_0x303687,_0x58ab50=_0x20d51f[0x1],_0x4b1139=_0x4da347[0x1];if((_0x58ab50[_0x29e6d3(0x1b3)]?0x1:0x0)!==(_0x4b1139[_0x29e6d3(0x1b3)]?0x1:0x0))return(_0x4b1139['finishTime']?0x1:0x0)-(_0x58ab50['finishTime']?0x1:0x0);if((_0x58ab50[_0x29e6d3(0x221)]||0x0)!==(_0x4b1139['score']||0x0))return(_0x4b1139[_0x29e6d3(0x221)]||0x0)-(_0x58ab50[_0x29e6d3(0x221)]||0x0);const _0x9e90a4=(allPlayerStates?.[_0x20d51f[0x0]]?.[_0x29e6d3(0x1fa)]||'')[_0x29e6d3(0x1b7)](/0/g,'')[_0x29e6d3(0x184)],_0x378cea=(allPlayerStates?.[_0x4da347[0x0]]?.[_0x29e6d3(0x1fa)]||'')[_0x29e6d3(0x1b7)](/0/g,'')[_0x29e6d3(0x184)];return _0x378cea-_0x9e90a4;});playerList[_0x303687(0x185)]=_0x5b431c['map'](([_0x1b56c3,_0x417127])=>{const _0x6873b5=_0x303687,_0x4327c9=(allPlayerStates?.[_0x1b56c3]?.[_0x6873b5(0x1fa)]||'')[_0x6873b5(0x1b7)](/0/g,'')[_0x6873b5(0x184)];let _0x496593=_0x4327c9+'/16';if(_0x417127[_0x6873b5(0x1b3)])_0x496593=_0x6873b5(0x18a);else _0xcc3ca2[_0x6873b5(0x1f1)]['difficulty']===_0x6873b5(0x205)&&(_0x496593=_0x6873b5(0x1a1)+(_0x417127[_0x6873b5(0x158)]||_0x6873b5(0x230))+'\x20('+_0x4327c9+_0x6873b5(0x1d7));return _0x6873b5(0x177)+_0x1b56c3+_0x6873b5(0x188)+(_0x417127[_0x6873b5(0x221)]||0x0)+_0x6873b5(0x14f)+_0x496593+')</span></div>';})[_0x303687(0x208)]('');let _0x4a4d0b;if(_0xcc3ca2[_0x303687(0x1f1)][_0x303687(0x234)]===_0x303687(0x205)){const _0x3b2cf0=['easy','medium',_0x303687(0x183)];let _0x6b74e1='easy';const _0x5e4d4f=Object[_0x303687(0x1c5)](_0x210d8e);for(const _0x21f599 of _0x5e4d4f){if(_0x21f599[_0x303687(0x1b3)])continue;const _0x13d227=_0x21f599['currentLevel']||_0x303687(0x230);_0x3b2cf0[_0x303687(0x22a)](_0x13d227)>_0x3b2cf0['indexOf'](_0x6b74e1)&&(_0x6b74e1=_0x13d227);}_0x4a4d0b=_0xcc3ca2[_0x303687(0x1b0)]?_0xcc3ca2['puzzles'][_0x6b74e1]:null;}else _0x4a4d0b=_0xcc3ca2['sudoku'];if(!_0x4a4d0b)return;const _0x334cb6=_0x4a4d0b['puzzle']||[];given=_0x334cb6['slice'](),board=_0x334cb6['slice'](),solution=_0x4a4d0b[_0x303687(0x156)]||[],selectedIdx=-0x1,renderSudoku(),$$(_0x303687(0x1d2))[_0x303687(0x1f2)](_0x25b904=>_0x25b904[_0x303687(0x180)]['pointerEvents']='none'),pickerEl[_0x303687(0x163)][_0x303687(0x199)](_0x303687(0x191)),$(_0x303687(0x18f))[_0x303687(0x163)][_0x303687(0x199)](_0x303687(0x191)),$('#home-btn')[_0x303687(0x163)][_0x303687(0x199)](_0x303687(0x191));}function renderPlayerGameView(_0x8931aa){const _0x328a17=_0x574540;$('#toggle-sidebar-btn')[_0x328a17(0x163)][_0x328a17(0x199)](_0x328a17(0x191));const _0x47fde5=(_0x8931aa[_0x328a17(0x1a8)]||{})[currentPlayerName];if(!_0x47fde5)return;playerScoreDisplay[_0x328a17(0x210)]=_0x328a17(0x1b5)+(_0x47fde5[_0x328a17(0x221)]||0x0),playerScoreDisplay[_0x328a17(0x163)][_0x328a17(0x1db)](_0x328a17(0x191));let _0x2cc750;if(_0x8931aa[_0x328a17(0x1f1)]['difficulty']===_0x328a17(0x205)){const _0x3da72b=_0x47fde5[_0x328a17(0x158)]||_0x328a17(0x230);_0x2cc750=_0x8931aa[_0x328a17(0x1b0)][_0x3da72b],targetNumberDisplay[_0x328a17(0x210)]=_0x328a17(0x1a1)+_0x3da72b;}else _0x2cc750=_0x8931aa[_0x328a17(0x1e4)],targetNumberDisplay[_0x328a17(0x210)]=_0x328a17(0x152);if(!_0x2cc750)return;given=(_0x2cc750[_0x328a17(0x225)]||[])[_0x328a17(0x164)](),solution=(_0x2cc750[_0x328a17(0x156)]||[])['slice'](),board=given['slice'](),selectedIdx=board[_0x328a17(0x1a3)]((_0x528d4e,_0x239b0a)=>!given[_0x239b0a]);if(selectedIdx<0x0)selectedIdx=0x0;_0x47fde5[_0x328a17(0x1b3)]?(gameBoard[_0x328a17(0x163)]['add'](_0x328a17(0x191)),playerFinishedView[_0x328a17(0x163)][_0x328a17(0x1db)](_0x328a17(0x191))):(gameBoard[_0x328a17(0x163)][_0x328a17(0x1db)]('hidden'),playerFinishedView[_0x328a17(0x163)][_0x328a17(0x199)](_0x328a17(0x191)),renderSudoku());}function renderGameOverView(_0x1525c0){const _0x2f6ff1=_0x574540,_0x76fc1e=_0x1525c0[_0x2f6ff1(0x20f)],_0x176aad=$('#results-header');_0x76fc1e?_0x176aad['innerHTML']=_0x2f6ff1(0x15b)+_0x76fc1e+'!':_0x176aad[_0x2f6ff1(0x185)]=_0x2f6ff1(0x16c);const _0x3cbd67=_0x1525c0[_0x2f6ff1(0x1a8)]||{},_0x1be5b3=Object[_0x2f6ff1(0x1e7)](_0x3cbd67)[_0x2f6ff1(0x232)](([,_0x5b8e38],[,_0x5a38e6])=>{const _0x3f16c7=_0x2f6ff1;if((_0x5b8e38['score']||0x0)!==(_0x5a38e6[_0x3f16c7(0x221)]||0x0))return(_0x5a38e6[_0x3f16c7(0x221)]||0x0)-(_0x5b8e38[_0x3f16c7(0x221)]||0x0);if(_0x5a38e6['finishTime']&&_0x5b8e38[_0x3f16c7(0x1b3)])return _0x5b8e38[_0x3f16c7(0x1b3)][_0x3f16c7(0x19e)]()-_0x5a38e6['finishTime']['toMillis']();if(_0x5a38e6[_0x3f16c7(0x1b3)])return 0x1;if(_0x5b8e38[_0x3f16c7(0x1b3)])return-0x1;return(_0x5a38e6[_0x3f16c7(0x189)]||0x0)-(_0x5b8e38[_0x3f16c7(0x189)]||0x0);});podiumContainer[_0x2f6ff1(0x185)]='',otherRankingsList[_0x2f6ff1(0x185)]='';const _0x157ec3=_0x1be5b3['slice'](0x0,0x3),_0xc8f7ad=_0x1be5b3[_0x2f6ff1(0x164)](0x3);_0x157ec3[_0x2f6ff1(0x1f2)](([_0x4a0548,_0x58aa13],_0x1a70bf)=>{const _0x3b67b2=_0x2f6ff1,_0x4c50c0=_0x1a70bf+0x1,_0x36b49a=document[_0x3b67b2(0x21e)](_0x3b67b2(0x166));_0x36b49a[_0x3b67b2(0x1a7)]=_0x3b67b2(0x1af)+_0x4c50c0,_0x36b49a[_0x3b67b2(0x185)]=(_0x4c50c0===0x1&&_0x76fc1e?'<i\x20class=\x22fas\x20fa-crown\x22></i>':'')+_0x3b67b2(0x1e8)+_0x4a0548+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22player-score\x22>'+(_0x58aa13['score']||0x0)+_0x3b67b2(0x22e)+_0x4c50c0+_0x3b67b2(0x1cf),podiumContainer[_0x3b67b2(0x1ae)](_0x36b49a);});for(let _0x24e86e=_0x1be5b3[_0x2f6ff1(0x184)];_0x24e86e<0x3;_0x24e86e++){const _0x5812e9=_0x24e86e+0x1,_0x868394=document[_0x2f6ff1(0x21e)](_0x2f6ff1(0x166));_0x868394['className']=_0x2f6ff1(0x1af)+_0x5812e9,podiumContainer['appendChild'](_0x868394);}if(_0xc8f7ad['length']>0x0)otherRankingsContainer['classList']['remove'](_0x2f6ff1(0x191)),otherRankingsList[_0x2f6ff1(0x185)]=_0xc8f7ad[_0x2f6ff1(0x233)](([_0x5bd5e9,_0x45bf42],_0x225896)=>_0x2f6ff1(0x1df)+(_0x225896+0x4)+'.\x20'+_0x5bd5e9+'</span><span>'+(_0x45bf42[_0x2f6ff1(0x221)]||0x0)+'\x20คะแนน</span></li>')['join']('');else otherRankingsContainer[_0x2f6ff1(0x163)]['add'](_0x2f6ff1(0x191));if(isHost)$(_0x2f6ff1(0x1b2))[_0x2f6ff1(0x163)]['remove'](_0x2f6ff1(0x191));else $(_0x2f6ff1(0x1b2))['classList'][_0x2f6ff1(0x199)]('hidden');showView(_0x2f6ff1(0x219));}function renderPracticeGameOverView(){const _0x4de8f6=_0x574540,_0x36b091=gameTimerEl[_0x4de8f6(0x210)]['replace']('เวลา:\x20',''),_0x54e9ef=_0x36b091[_0x4de8f6(0x1da)](':'),_0x2296e1=parseInt(_0x54e9ef[0x0],0xa)*0x3c+parseInt(_0x54e9ef[0x1],0xa),_0x236000=gameSettings['timeLimit']-_0x2296e1,_0x2f8706=String(Math[_0x4de8f6(0x206)](_0x236000/0x3c))['padStart'](0x2,'0'),_0x5547d7=String(_0x236000%0x3c)[_0x4de8f6(0x207)](0x2,'0'),_0x339362=_0x2f8706+':'+_0x5547d7;resultsHeader[_0x4de8f6(0x185)]=_0x4de8f6(0x18d),podiumContainer['innerHTML']=_0x4de8f6(0x1ab)+gameSettings[_0x4de8f6(0x234)]+_0x4de8f6(0x1e0)+_0x339362+_0x4de8f6(0x17d),otherRankingsContainer[_0x4de8f6(0x163)][_0x4de8f6(0x199)](_0x4de8f6(0x191));const _0x420b53=$(_0x4de8f6(0x1b2));_0x420b53['textContent']=_0x4de8f6(0x190),_0x420b53[_0x4de8f6(0x163)][_0x4de8f6(0x1db)](_0x4de8f6(0x191)),_0x420b53[_0x4de8f6(0x1b8)]=()=>$(_0x4de8f6(0x1e9))[_0x4de8f6(0x213)](),showView(_0x4de8f6(0x219));}let syncTimer=null;function scheduleBoardSync(){if(isPracticeMode||!currentGameId||!currentPlayerName)return;if(syncTimer)clearTimeout(syncTimer);syncTimer=setTimeout(async()=>{const _0x37ee80=_0x4d2a;try{const _0x525b3f=doc(db,_0x37ee80(0x1c1),currentGameId,_0x37ee80(0x155),currentPlayerName);await updateDoc(_0x525b3f,{'board':board[_0x37ee80(0x208)](''),'hasMistake':hasMistake});}catch(_0x3535f4){console[_0x37ee80(0x22c)](_0x37ee80(0x19c),_0x3535f4);}},0xc8);}async function tryFinish(){const _0x102b5f=_0x574540;if(isPracticeMode){if(!isSolved())return;const _0x21037b=gameTimerEl['textContent'][_0x102b5f(0x1b7)]('เวลา:\x20',''),_0x3aed21=_0x21037b[_0x102b5f(0x1da)](':'),_0x1a4c53=parseInt(_0x3aed21[0x0],0xa)*0x3c+parseInt(_0x3aed21[0x1],0xa),_0x4a01ae=0x64+_0x1a4c53+(hasMistake?0x0:0x32);if(gameSettings[_0x102b5f(0x234)]==='mixed'){if(currentPracticeLevel===_0x102b5f(0x230)){currentPracticeLevel=_0x102b5f(0x1bc),toast(_0x102b5f(0x193),0x9c4),loadPracticePuzzle(_0x102b5f(0x1bc));return;}else{if(currentPracticeLevel===_0x102b5f(0x1bc)){currentPracticeLevel=_0x102b5f(0x183),toast('สุดยอด!\x20ด่านต่อไป:\x20ยาก',0x9c4),loadPracticePuzzle(_0x102b5f(0x183));return;}}}if(timerInterval)clearInterval(timerInterval);gameBoard[_0x102b5f(0x163)]['add'](_0x102b5f(0x191)),playerFinishedView['classList'][_0x102b5f(0x1db)]('hidden'),$(_0x102b5f(0x154))[_0x102b5f(0x210)]=_0x102b5f(0x14e),$(_0x102b5f(0x162))[_0x102b5f(0x210)]='คุณไขปริศนาสำเร็จ',$(_0x102b5f(0x1c4))[_0x102b5f(0x185)]=_0x102b5f(0x18c)+_0x4a01ae+_0x102b5f(0x22d),setTimeout(()=>{renderPracticeGameOverView();},0x7d0);return;}if(syncTimer)clearTimeout(syncTimer);const _0x3b6e60=doc(db,_0x102b5f(0x1c1),currentGameId);try{await runTransaction(db,async _0x17778a=>{const _0x298f02=_0x102b5f,_0x767010=await _0x17778a[_0x298f02(0x19f)](_0x3b6e60);if(!_0x767010['exists']())throw new Error(_0x298f02(0x17e));const _0x577106=_0x767010['data']();if(_0x577106[_0x298f02(0x1bb)]!==_0x298f02(0x1c0))return;const _0x20a45d=(_0x577106[_0x298f02(0x1a8)]||{})[currentPlayerName];if(!_0x20a45d)throw new Error(_0x298f02(0x1bf));if(_0x20a45d['finishTime'])return;const _0x9433fe=board;let _0x2b0d3b,_0x1b23f3=_0x298f02(0x1c7);_0x577106[_0x298f02(0x1f1)]['difficulty']===_0x298f02(0x205)?(_0x1b23f3=_0x20a45d[_0x298f02(0x158)]||'easy',_0x2b0d3b=_0x577106[_0x298f02(0x1b0)][_0x1b23f3][_0x298f02(0x156)]):_0x2b0d3b=_0x577106[_0x298f02(0x1e4)]['solution'];for(let _0x5e8d34=0x0;_0x5e8d34<0x10;_0x5e8d34++){if(_0x9433fe[_0x5e8d34]!==_0x2b0d3b[_0x5e8d34])return;}const _0x421a6c=_0x577106['startTime']['toMillis'](),_0x47d28b=Math[_0x298f02(0x206)]((Date[_0x298f02(0x1a0)]()-_0x421a6c)/0x3e8),_0x3d09dd=Math[_0x298f02(0x1d6)](0x0,_0x577106['gameMode'][_0x298f02(0x165)]-_0x47d28b),_0x4e3832=0x64+_0x3d09dd+(hasMistake?0x0:0x32),_0x1ea777={};if(_0x577106[_0x298f02(0x1f1)][_0x298f02(0x234)]===_0x298f02(0x205)){const _0x1ecaf0=doc(db,_0x298f02(0x1c1),currentGameId,_0x298f02(0x155),currentPlayerName);if(_0x1b23f3==='easy')_0x1ea777[_0x298f02(0x1dc)+currentPlayerName+'.currentLevel']='medium',_0x1ea777[_0x298f02(0x1dc)+currentPlayerName+_0x298f02(0x18e)]=increment(_0x4e3832),_0x17778a['set'](_0x1ecaf0,{'board':_0x577106[_0x298f02(0x1b0)]['medium']['puzzle'][_0x298f02(0x208)](''),'hasMistake':![]});else _0x1b23f3===_0x298f02(0x1bc)?(_0x1ea777[_0x298f02(0x1dc)+currentPlayerName+_0x298f02(0x20a)]=_0x298f02(0x183),_0x1ea777['players.'+currentPlayerName+_0x298f02(0x18e)]=increment(_0x4e3832),_0x17778a[_0x298f02(0x1ce)](_0x1ecaf0,{'board':_0x577106[_0x298f02(0x1b0)][_0x298f02(0x183)][_0x298f02(0x225)]['join'](''),'hasMistake':![]})):(_0x1ea777[_0x298f02(0x1dc)+currentPlayerName+_0x298f02(0x18e)]=increment(_0x4e3832),_0x1ea777[_0x298f02(0x1dc)+currentPlayerName+_0x298f02(0x16f)]=serverTimestamp(),_0x577106[_0x298f02(0x1f1)][_0x298f02(0x1cc)]==='immediate'&&(_0x1ea777[_0x298f02(0x1bb)]='finished',_0x1ea777[_0x298f02(0x20f)]=currentPlayerName));}else _0x1ea777['players.'+currentPlayerName+'.score']=increment(_0x4e3832),_0x1ea777[_0x298f02(0x1dc)+currentPlayerName+_0x298f02(0x16f)]=serverTimestamp(),_0x577106[_0x298f02(0x1f1)][_0x298f02(0x1cc)]===_0x298f02(0x196)&&(_0x1ea777[_0x298f02(0x1bb)]=_0x298f02(0x1ed),_0x1ea777[_0x298f02(0x20f)]=currentPlayerName);_0x17778a['update'](_0x3b6e60,_0x1ea777);});}catch(_0x2e4a4a){_0x2e4a4a[_0x102b5f(0x186)][_0x102b5f(0x1a2)](_0x102b5f(0x216))?(console[_0x102b5f(0x1fc)](_0x102b5f(0x1ef)),toast(_0x102b5f(0x17f))):(console[_0x102b5f(0x1ff)](_0x102b5f(0x22f),_0x2e4a4a),toast(_0x102b5f(0x16e)));}}$(_0x574540(0x1a6))[_0x574540(0x20b)]('click',()=>showView(_0x574540(0x231))),$(_0x574540(0x1e6))[_0x574540(0x20b)]('click',()=>showView(_0x574540(0x1fb))),$('#admin-login-btn')[_0x574540(0x20b)](_0x574540(0x213),async()=>{const _0x64f3fd=_0x574540;if($('#admin-password-input')[_0x64f3fd(0x224)]===_0x64f3fd(0x1f9))await createGameRoom();else toast(_0x64f3fd(0x179));}),$(_0x574540(0x1c9))['addEventListener'](_0x574540(0x213),handleJoinGame),$(_0x574540(0x1ee))['addEventListener'](_0x574540(0x213),()=>{const _0x523df1=_0x574540;isPracticeMode=!![],isHost=!![],showView(_0x523df1(0x1a5)),$(_0x523df1(0x21b))['classList'][_0x523df1(0x199)](_0x523df1(0x191)),$(_0x523df1(0x174))[_0x523df1(0x185)]=_0x523df1(0x1b1);}),$('#open-settings-btn')[_0x574540(0x20b)](_0x574540(0x213),()=>{const _0x11fed9=_0x574540;isPracticeMode=![],showView(_0x11fed9(0x1a5)),$(_0x11fed9(0x21b))[_0x11fed9(0x163)]['remove'](_0x11fed9(0x191)),$(_0x11fed9(0x174))[_0x11fed9(0x185)]=_0x11fed9(0x223);}),$(_0x574540(0x1f8))['addEventListener']('click',()=>{const _0x13b5fb=_0x574540;isHost&&!currentGameId&&isPracticeMode?(isPracticeMode=![],isHost=![],showView(_0x13b5fb(0x1fb))):showView(_0x13b5fb(0x167));}),$(_0x574540(0x174))['addEventListener'](_0x574540(0x213),()=>{isPracticeMode?startPracticeGame():handleStartGame();}),$('#end-game-btn')[_0x574540(0x20b)](_0x574540(0x213),forceEndGame),$('#back-to-lobby-btn')[_0x574540(0x20b)]('click',returnToLobby),$(_0x574540(0x1e9))['addEventListener']('click',()=>{const _0x24c004=_0x574540;if(unsubscribeGameListener)unsubscribeGameListener();unsubscribePlayerStateListener&&(unsubscribePlayerStateListener(),unsubscribePlayerStateListener=null);if(timerInterval)clearInterval(timerInterval);currentGameId=null,currentPlayerName=null,isHost=![],isPracticeMode=![],practicePuzzles=null,currentPracticeLevel=null,document[_0x24c004(0x1c2)][_0x24c004(0x163)][_0x24c004(0x1db)](_0x24c004(0x16d)),showView(_0x24c004(0x1fb)),$(_0x24c004(0x154))[_0x24c004(0x210)]=_0x24c004(0x200),$('#player-finished-view\x20p')[_0x24c004(0x210)]=_0x24c004(0x1aa);}),$(_0x574540(0x18f))[_0x574540(0x20b)](_0x574540(0x213),()=>{for(let _0x130c87=0x0;_0x130c87<0x10;_0x130c87++)board[_0x130c87]=given[_0x130c87];hasMistake=![],renderSudoku(),scheduleBoardSync();}),sudokuEl[_0x574540(0x20b)](_0x574540(0x213),_0x531cb0=>{const _0x380faa=_0x574540,_0x110b19=_0x531cb0['target']['closest']('.cell');if(!_0x110b19)return;const _0x4b29ca=parseInt(_0x110b19[_0x380faa(0x187)][_0x380faa(0x1b6)],0xa);if(!given[_0x4b29ca])selectCell(_0x4b29ca);}),$(_0x574540(0x218))[_0x574540(0x20b)](_0x574540(0x213),()=>{const _0x330716=_0x574540;$(_0x330716(0x1f6))['classList'][_0x330716(0x1de)]('sidebar-hidden');}),$(_0x574540(0x19b))[_0x574540(0x20b)](_0x574540(0x18b),_0x310959=>{const _0x47a7f9=_0x574540,_0x52f609=$('#time-limit-input');switch(_0x310959['target'][_0x47a7f9(0x224)]){case _0x47a7f9(0x230):_0x52f609[_0x47a7f9(0x224)]=0x1e;break;case _0x47a7f9(0x1bc):_0x52f609['value']=0x3c;break;case _0x47a7f9(0x183):_0x52f609[_0x47a7f9(0x224)]=0x78;break;case'mixed':_0x52f609[_0x47a7f9(0x224)]=0xd2;break;}}),window[_0x574540(0x20b)](_0x574540(0x19a),()=>{const _0x2ecf18=_0x574540;isHost&&currentGameId&&deleteDoc(doc(db,_0x2ecf18(0x1c1),currentGameId));}),initialize(),showView('player-join');
