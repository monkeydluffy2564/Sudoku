const _0x2d2c52=_0x3ae5;(function(_0x23c7aa,_0x38d6e7){const _0x59f4ff=_0x3ae5,_0x4ea994=_0x23c7aa();while(!![]){try{const _0x406203=-parseInt(_0x59f4ff(0x16e))/0x1+parseInt(_0x59f4ff(0x11d))/0x2+-parseInt(_0x59f4ff(0x171))/0x3*(parseInt(_0x59f4ff(0x155))/0x4)+parseInt(_0x59f4ff(0x18f))/0x5*(-parseInt(_0x59f4ff(0x192))/0x6)+-parseInt(_0x59f4ff(0x16f))/0x7+parseInt(_0x59f4ff(0x126))/0x8*(parseInt(_0x59f4ff(0x17a))/0x9)+-parseInt(_0x59f4ff(0x17e))/0xa*(-parseInt(_0x59f4ff(0x148))/0xb);if(_0x406203===_0x38d6e7)break;else _0x4ea994['push'](_0x4ea994['shift']());}catch(_0x43434f){_0x4ea994['push'](_0x4ea994['shift']());}}}(_0x1d2a,0x47828));import{initializeApp}from'https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js';import{getAuth,signInAnonymously,onAuthStateChanged}from'https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js';import{getFirestore,doc,getDoc,setDoc,updateDoc,onSnapshot,serverTimestamp,runTransaction,deleteDoc,deleteField,increment}from'https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js';const firebaseConfig={'apiKey':_0x2d2c52(0x1a4),'authDomain':_0x2d2c52(0x14e),'projectId':'game24-69666','storageBucket':_0x2d2c52(0x17c),'messagingSenderId':'989271279576','appId':_0x2d2c52(0x187),'measurementId':_0x2d2c52(0x194)},$=_0x3037f4=>document['querySelector'](_0x3037f4),$$=_0x14cbbb=>Array['from'](document['querySelectorAll'](_0x14cbbb)),playerJoinView=$(_0x2d2c52(0x131)),playerWaitView=$(_0x2d2c52(0x15c)),gameView=$('#game-view'),gameOverView=$(_0x2d2c52(0x12e)),sudokuEl=$(_0x2d2c52(0x129)),pickerEl=$('#picker'),toastEl=$(_0x2d2c52(0x153)),gameTimerEl=$('#game-timer'),puzzleProgressEl=$(_0x2d2c52(0x1a0)),playerScoreDisplay=$(_0x2d2c52(0x193)),gameBoard=$(_0x2d2c52(0x14a)),playerFinishedView=$(_0x2d2c52(0x198)),targetNumberDisplay=$('#target-number-display');let db,auth,userId,currentPlayerName,currentGameId=null,unsubscribeGameListener=null,timerInterval=null,previousGameStatus=null,isPracticeMode=![],given=new Array(0x10)[_0x2d2c52(0x169)](0x0),board=new Array(0x10)['fill'](0x0),solution=new Array(0x10)[_0x2d2c52(0x169)](0x0),selectedIdx=-0x1,hasMistake=![],gameSettings={'timeLimit':0x3c};function toast(_0x368719,_0x238538=0x7d0){const _0x1ce59a=_0x2d2c52;toastEl[_0x1ce59a(0x17b)]=_0x368719,toastEl[_0x1ce59a(0x167)][_0x1ce59a(0x175)](_0x1ce59a(0x132)),setTimeout(()=>toastEl[_0x1ce59a(0x167)][_0x1ce59a(0x184)](_0x1ce59a(0x132)),_0x238538);}const rnd=(_0x214449,_0x1ffbd8)=>Math[_0x2d2c52(0x146)](Math[_0x2d2c52(0x140)]()*(_0x1ffbd8-_0x214449+0x1))+_0x214449,themeKey=_0x2d2c52(0x19a);function applyTheme(_0x5cee07){const _0x5cc1d1=_0x2d2c52;document['documentElement'][_0x5cc1d1(0x133)](_0x5cc1d1(0x15b),_0x5cee07),localStorage[_0x5cc1d1(0x19c)](themeKey,_0x5cee07);}applyTheme(localStorage['getItem'](themeKey)||'contrast');function baseSolved(){return[0x1,0x2,0x3,0x4,0x3,0x4,0x1,0x2,0x2,0x1,0x4,0x3,0x4,0x3,0x2,0x1];}function shuffle(_0x2ce2ee){const _0x58a7cf=_0x2d2c52;for(let _0x415c3f=_0x2ce2ee[_0x58a7cf(0x18b)]-0x1;_0x415c3f>0x0;_0x415c3f--){const _0x330d59=Math['floor'](Math['random']()*(_0x415c3f+0x1));[_0x2ce2ee[_0x415c3f],_0x2ce2ee[_0x330d59]]=[_0x2ce2ee[_0x330d59],_0x2ce2ee[_0x415c3f]];}return _0x2ce2ee;}function applyPermutations(_0x3da666){const _0x24e226=_0x2d2c52;let _0x436cbb=_0x3da666['slice']();const _0x34bc94=(_0x52cba5,_0x1749bf)=>{for(let _0x5f4ab6=0x0;_0x5f4ab6<0x4;_0x5f4ab6++){const _0xaa8a4c=_0x52cba5*0x4+_0x5f4ab6,_0x1e2aaa=_0x1749bf*0x4+_0x5f4ab6;[_0x436cbb[_0xaa8a4c],_0x436cbb[_0x1e2aaa]]=[_0x436cbb[_0x1e2aaa],_0x436cbb[_0xaa8a4c]];}},_0x3a1808=(_0x2d25c8,_0x287ba1)=>{for(let _0x307368=0x0;_0x307368<0x4;_0x307368++){const _0x368c06=_0x307368*0x4+_0x2d25c8,_0x5ef1e1=_0x307368*0x4+_0x287ba1;[_0x436cbb[_0x368c06],_0x436cbb[_0x5ef1e1]]=[_0x436cbb[_0x5ef1e1],_0x436cbb[_0x368c06]];}};if(Math[_0x24e226(0x140)]()<0.5)_0x34bc94(0x0,0x1);if(Math['random']()<0.5)_0x34bc94(0x2,0x3);if(Math[_0x24e226(0x140)]()<0.5)_0x3a1808(0x0,0x1);if(Math[_0x24e226(0x140)]()<0.5)_0x3a1808(0x2,0x3);if(Math['random']()<0.5)for(let _0x3c7be2=0x0;_0x3c7be2<0x4;_0x3c7be2++){const _0x3b7deb=0x0*0x4+_0x3c7be2,_0x5cee14=0x2*0x4+_0x3c7be2;[_0x436cbb[_0x3b7deb],_0x436cbb[_0x5cee14]]=[_0x436cbb[_0x5cee14],_0x436cbb[_0x3b7deb]];const _0x46c513=0x1*0x4+_0x3c7be2,_0xce5e7d=0x3*0x4+_0x3c7be2;[_0x436cbb[_0x46c513],_0x436cbb[_0xce5e7d]]=[_0x436cbb[_0xce5e7d],_0x436cbb[_0x46c513]];}if(Math[_0x24e226(0x140)]()<0.5)for(let _0x201bd6=0x0;_0x201bd6<0x4;_0x201bd6++){const _0x2bc814=_0x201bd6*0x4+0x0,_0x1f2a2b=_0x201bd6*0x4+0x2;[_0x436cbb[_0x2bc814],_0x436cbb[_0x1f2a2b]]=[_0x436cbb[_0x1f2a2b],_0x436cbb[_0x2bc814]];const _0x3c0ef5=_0x201bd6*0x4+0x1,_0xccada2=_0x201bd6*0x4+0x3;[_0x436cbb[_0x3c0ef5],_0x436cbb[_0xccada2]]=[_0x436cbb[_0xccada2],_0x436cbb[_0x3c0ef5]];}const _0x4b7cf2=[0x0,...shuffle([0x1,0x2,0x3,0x4])];for(let _0x8d2f1a=0x0;_0x8d2f1a<0x10;_0x8d2f1a++)_0x436cbb[_0x8d2f1a]=_0x4b7cf2[_0x436cbb[_0x8d2f1a]];return _0x436cbb;}function countSolutions(_0x59384a){const _0x4df8fe=_0x2d2c52;let _0xc9a53e=_0x59384a[_0x4df8fe(0x173)](),_0x44fbb9=0x0;function _0x520a7c(_0x141e9b,_0x1a31cf){const _0xc50c4a=_0x4df8fe,_0x108603=Math[_0xc50c4a(0x146)](_0x141e9b/0x4),_0x23e01b=_0x141e9b%0x4;for(let _0x1512a=0x0;_0x1512a<0x4;_0x1512a++){if(_0xc9a53e[_0x108603*0x4+_0x1512a]===_0x1a31cf&&_0x1512a!==_0x23e01b)return![];if(_0xc9a53e[_0x1512a*0x4+_0x23e01b]===_0x1a31cf&&_0x1512a!==_0x108603)return![];}const _0x581704=Math[_0xc50c4a(0x146)](_0x108603/0x2)*0x2,_0x418e68=Math[_0xc50c4a(0x146)](_0x23e01b/0x2)*0x2;for(let _0x56ac08=_0x581704;_0x56ac08<_0x581704+0x2;_0x56ac08++)for(let _0x157f39=_0x418e68;_0x157f39<_0x418e68+0x2;_0x157f39++){const _0x398b4a=_0x56ac08*0x4+_0x157f39;if(_0x398b4a!==_0x141e9b&&_0xc9a53e[_0x398b4a]===_0x1a31cf)return![];}return!![];}function _0x5cac06(_0x15c6e3=0x0){while(_0x15c6e3<0x10&&_0xc9a53e[_0x15c6e3]!==0x0)_0x15c6e3++;if(_0x15c6e3===0x10)return _0x44fbb9++,_0x44fbb9;for(let _0x30d332=0x1;_0x30d332<=0x4;_0x30d332++){if(_0x520a7c(_0x15c6e3,_0x30d332)){_0xc9a53e[_0x15c6e3]=_0x30d332,_0x5cac06(_0x15c6e3+0x1);if(_0x44fbb9>0x1)return _0x44fbb9;_0xc9a53e[_0x15c6e3]=0x0;}}return _0x44fbb9;}return _0x5cac06(0x0);}function makePuzzleByClues(_0x385ba8,_0x2a5698){const _0x43a832=_0x2d2c52;let _0x3b8e2a=_0x385ba8[_0x43a832(0x173)]();const _0xe490a4=shuffle([...Array(0x10)[_0x43a832(0x12b)]()]);let _0x448d20=0x0;for(const _0x121b6f of _0xe490a4){if(0x10-_0x448d20<=_0x2a5698)break;const _0x40a9e2=_0x3b8e2a[_0x121b6f];_0x3b8e2a[_0x121b6f]=0x0,countSolutions(_0x3b8e2a)!==0x1?_0x3b8e2a[_0x121b6f]=_0x40a9e2:_0x448d20++;}return _0x3b8e2a;}function generateSudoku(_0x1a1d65){const _0x2a36d4=applyPermutations(baseSolved());let _0x330d1e={'easy':[0x9,0xa],'medium':[0x7,0x8],'hard':[0x5,0x6]}[_0x1a1d65]||[0x7,0x8];const _0x4b5d6e=rnd(_0x330d1e[0x0],_0x330d1e[0x1]);let _0x1d44df=makePuzzleByClues(_0x2a36d4,_0x4b5d6e);if(countSolutions(_0x1d44df)!==0x1)return generateSudoku(_0x1a1d65);return{'solution':_0x2a36d4,'puzzle':_0x1d44df};}function _0x3ae5(_0x4577b1,_0x4c3250){const _0x1d2add=_0x1d2a();return _0x3ae5=function(_0x3ae5a5,_0x2154ed){_0x3ae5a5=_0x3ae5a5-0x11d;let _0x42253d=_0x1d2add[_0x3ae5a5];return _0x42253d;},_0x3ae5(_0x4577b1,_0x4c3250);}function cellClasses(_0x205002){const _0x7c0b73=_0x2d2c52,_0x373ec2=Math[_0x7c0b73(0x146)](_0x205002/0x4),_0x141dc2=_0x205002%0x4,_0x5541b8=[];if(_0x141dc2===0x1)_0x5541b8[_0x7c0b73(0x14d)]('bR');if(_0x373ec2===0x1)_0x5541b8['push']('bB');return _0x5541b8['join']('\x20');}function renderSudoku(){const _0xefa16a=_0x2d2c52;sudokuEl[_0xefa16a(0x16c)]='';for(let _0x3a19f9=0x0;_0x3a19f9<0x10;_0x3a19f9++){const _0x28a3e2=board[_0x3a19f9],_0x3f95fe=document['createElement'](_0xefa16a(0x1a6));_0x3f95fe[_0xefa16a(0x139)]=_0xefa16a(0x189)+cellClasses(_0x3a19f9)+'\x20'+(given[_0x3a19f9]?_0xefa16a(0x191):''),_0x3f95fe[_0xefa16a(0x13f)][_0xefa16a(0x147)]=_0x3a19f9,_0x3f95fe[_0xefa16a(0x17b)]=_0x28a3e2?_0x28a3e2:'',!given[_0x3a19f9]&&_0x3f95fe[_0xefa16a(0x143)](_0xefa16a(0x19d),()=>selectCell(_0x3a19f9)),sudokuEl[_0xefa16a(0x137)](_0x3f95fe);}if(selectedIdx>=0x0)highlightRelatives(selectedIdx);markConflictsAll(),updateProgressText();}function selectCell(_0x1bc2f4){const _0xb95a5a=_0x2d2c52;selectedIdx=_0x1bc2f4,$$(_0xb95a5a(0x17d))[_0xb95a5a(0x124)](_0x47dad7=>_0x47dad7[_0xb95a5a(0x167)][_0xb95a5a(0x184)](_0xb95a5a(0x161),'hl'));const _0x1b9fb1=$$(_0xb95a5a(0x17d))[_0x1bc2f4];_0x1b9fb1[_0xb95a5a(0x167)][_0xb95a5a(0x175)](_0xb95a5a(0x161)),highlightRelatives(_0x1bc2f4);}function highlightRelatives(_0x35697e){const _0x1651a2=_0x2d2c52,_0x14469=Math['floor'](_0x35697e/0x4),_0x34c082=_0x35697e%0x4;$$(_0x1651a2(0x17d))[_0x1651a2(0x124)]((_0x6bf415,_0x2c1e5b)=>{const _0x260fb9=_0x1651a2,_0x5bb185=Math[_0x260fb9(0x146)](_0x2c1e5b/0x4),_0x1ba85b=_0x2c1e5b%0x4;(_0x5bb185===_0x14469||_0x1ba85b===_0x34c082||Math[_0x260fb9(0x146)](_0x5bb185/0x2)===Math[_0x260fb9(0x146)](_0x14469/0x2)&&Math[_0x260fb9(0x146)](_0x1ba85b/0x2)===Math['floor'](_0x34c082/0x2))&&_0x6bf415['classList'][_0x260fb9(0x175)]('hl');});}function setNumber(_0x50345a){const _0x31e4e3=_0x2d2c52;if(selectedIdx<0x0||given[selectedIdx])return;board[selectedIdx]=_0x50345a;_0x50345a!==0x0&&causesConflict(selectedIdx)&&(hasMistake=!![]);const _0x5805af=$$(_0x31e4e3(0x17d))[selectedIdx];_0x5805af[_0x31e4e3(0x17b)]=_0x50345a?_0x50345a:'',markConflictsAll(),updateProgressText(),scheduleBoardSync();if(isSolved())tryFinish();}function markConflictsAll(){const _0x22448a=_0x2d2c52;$$(_0x22448a(0x17d))['forEach'](_0x15b75c=>_0x15b75c[_0x22448a(0x167)][_0x22448a(0x184)](_0x22448a(0x178),'ok'));for(let _0x46fc8b=0x0;_0x46fc8b<0x10;_0x46fc8b++){if(board[_0x46fc8b]!==0x0&&causesConflict(_0x46fc8b))$$(_0x22448a(0x17d))[_0x46fc8b]['classList']['add'](_0x22448a(0x178));else board[_0x46fc8b]!==0x0&&$$(_0x22448a(0x17d))[_0x46fc8b][_0x22448a(0x167)][_0x22448a(0x175)]('ok');}}function causesConflict(_0x86e23a){const _0x4e0c61=_0x2d2c52,_0x1e6742=board[_0x86e23a];if(_0x1e6742===0x0)return![];const _0x2e9ba5=Math[_0x4e0c61(0x146)](_0x86e23a/0x4),_0x24a397=_0x86e23a%0x4;for(let _0x52345d=0x0;_0x52345d<0x4;_0x52345d++){if(_0x52345d!==_0x24a397&&board[_0x2e9ba5*0x4+_0x52345d]===_0x1e6742)return!![];if(_0x52345d!==_0x2e9ba5&&board[_0x52345d*0x4+_0x24a397]===_0x1e6742)return!![];}const _0x3e8ebc=Math['floor'](_0x2e9ba5/0x2)*0x2,_0x7785ac=Math['floor'](_0x24a397/0x2)*0x2;for(let _0x3fac95=_0x3e8ebc;_0x3fac95<_0x3e8ebc+0x2;_0x3fac95++)for(let _0x37715e=_0x7785ac;_0x37715e<_0x7785ac+0x2;_0x37715e++){const _0xefb5b2=_0x3fac95*0x4+_0x37715e;if(_0xefb5b2!==_0x86e23a&&board[_0xefb5b2]===_0x1e6742)return!![];}return![];}function isSolved(){for(let _0x102e36=0x0;_0x102e36<0x10;_0x102e36++)if(board[_0x102e36]!==solution[_0x102e36])return![];return!![];}function updateProgressText(){const _0x10dba1=_0x2d2c52,_0xf6efac=board[_0x10dba1(0x176)](_0x19e9d2=>_0x19e9d2!==0x0)[_0x10dba1(0x18b)];puzzleProgressEl[_0x10dba1(0x17b)]=_0x10dba1(0x181)+_0xf6efac+'/16';}pickerEl[_0x2d2c52(0x143)](_0x2d2c52(0x19d),_0x18eaae=>{const _0x236265=_0x2d2c52,_0x4e83cd=_0x18eaae[_0x236265(0x1a1)][_0x236265(0x157)](_0x236265(0x13c));if(!_0x4e83cd)return;setNumber(parseInt(_0x4e83cd[_0x236265(0x13f)]['n'],0xa));}),document[_0x2d2c52(0x143)]('keydown',_0x3495cf=>{const _0x4cba4a=_0x2d2c52;if(selectedIdx<0x0||!gameView[_0x4cba4a(0x167)][_0x4cba4a(0x165)](_0x4cba4a(0x149)))return;_0x3495cf[_0x4cba4a(0x136)]>='1'&&_0x3495cf['key']<='4'&&setNumber(parseInt(_0x3495cf[_0x4cba4a(0x136)],0xa));(_0x3495cf[_0x4cba4a(0x136)]===_0x4cba4a(0x163)||_0x3495cf['key']===_0x4cba4a(0x16a)||_0x3495cf['key']==='0')&&setNumber(0x0);const _0x4599d7=Math[_0x4cba4a(0x146)](selectedIdx/0x4),_0x21564d=selectedIdx%0x4;if(_0x3495cf[_0x4cba4a(0x136)]==='ArrowRight')selectCell(_0x4599d7*0x4+Math['min'](_0x21564d+0x1,0x3));if(_0x3495cf[_0x4cba4a(0x136)]===_0x4cba4a(0x145))selectCell(_0x4599d7*0x4+Math[_0x4cba4a(0x159)](_0x21564d-0x1,0x0));if(_0x3495cf[_0x4cba4a(0x136)]===_0x4cba4a(0x164))selectCell(Math[_0x4cba4a(0x150)]((_0x4599d7+0x1)*0x4+_0x21564d,0xf));if(_0x3495cf[_0x4cba4a(0x136)]===_0x4cba4a(0x1a3))selectCell(Math[_0x4cba4a(0x159)]((_0x4599d7-0x1)*0x4+_0x21564d,0x0));});async function initialize(){const _0x555b9e=_0x2d2c52;try{const _0xe2ebe4=initializeApp(firebaseConfig);db=getFirestore(_0xe2ebe4),auth=getAuth(_0xe2ebe4),onAuthStateChanged(auth,async _0x5617fd=>{!_0x5617fd&&await signInAnonymously(auth);});}catch(_0x1c0a7c){console[_0x555b9e(0x168)]('Firebase\x20init\x20failed:',_0x1c0a7c),toast(_0x555b9e(0x180));}}function showView(_0x59b369){const _0x3f637b=_0x2d2c52;[playerJoinView,playerWaitView,gameView,gameOverView][_0x3f637b(0x124)](_0x1337f5=>_0x1337f5[_0x3f637b(0x167)][_0x3f637b(0x175)](_0x3f637b(0x149)));if(_0x59b369===_0x3f637b(0x183))playerJoinView[_0x3f637b(0x167)][_0x3f637b(0x184)](_0x3f637b(0x149));else{if(_0x59b369===_0x3f637b(0x12c))playerWaitView['classList'][_0x3f637b(0x184)](_0x3f637b(0x149));else{if(_0x59b369===_0x3f637b(0x160))gameView[_0x3f637b(0x167)][_0x3f637b(0x184)](_0x3f637b(0x149));else{if(_0x59b369===_0x3f637b(0x151))gameOverView[_0x3f637b(0x167)][_0x3f637b(0x184)](_0x3f637b(0x149));}}}}function startPracticeGame(){const _0x41fead=_0x2d2c52;isPracticeMode=!![],gameSettings[_0x41fead(0x166)]=0xb4,document[_0x41fead(0x188)]['classList'][_0x41fead(0x175)](_0x41fead(0x11e)),playerScoreDisplay[_0x41fead(0x167)][_0x41fead(0x175)](_0x41fead(0x149));const _0x3e022d=generateSudoku(_0x41fead(0x18e));given=_0x3e022d[_0x41fead(0x12d)]['slice'](),board=_0x3e022d['puzzle']['slice'](),solution=_0x3e022d[_0x41fead(0x13e)]['slice'](),hasMistake=![],selectedIdx=board[_0x41fead(0x19f)]((_0x40a347,_0x2eeab7)=>!given[_0x2eeab7]);if(selectedIdx<0x0)selectedIdx=0x0;showView('game'),gameBoard['classList'][_0x41fead(0x184)](_0x41fead(0x149)),playerFinishedView[_0x41fead(0x167)][_0x41fead(0x175)](_0x41fead(0x149)),renderSudoku(),startPracticeTimer();}function startPracticeTimer(){const _0x4ca47b=_0x2d2c52;if(timerInterval)clearInterval(timerInterval);let _0x79cc42=gameSettings[_0x4ca47b(0x166)];const _0x4384b6=()=>{const _0x790b49=_0x4ca47b,_0x185631=String(Math[_0x790b49(0x146)](_0x79cc42/0x3c))[_0x790b49(0x134)](0x2,'0'),_0x1cf66c=String(_0x79cc42%0x3c)[_0x790b49(0x134)](0x2,'0');gameTimerEl[_0x790b49(0x17b)]=_0x790b49(0x120)+_0x185631+':'+_0x1cf66c;};_0x4384b6(),timerInterval=setInterval(()=>{const _0x5d9a37=_0x4ca47b;_0x79cc42--,_0x4384b6(),_0x79cc42<=0x0&&(clearInterval(timerInterval),gameBoard[_0x5d9a37(0x167)]['add'](_0x5d9a37(0x149)),playerFinishedView[_0x5d9a37(0x167)][_0x5d9a37(0x184)]('hidden'),$(_0x5d9a37(0x15f))[_0x5d9a37(0x17b)]=_0x5d9a37(0x18a),$('#player-finished-view\x20p')[_0x5d9a37(0x17b)]=_0x5d9a37(0x182));},0x3e8);}async function handleJoinGame(){const _0x4524d3=_0x2d2c52,_0x408bdc=$(_0x4524d3(0x185))[_0x4524d3(0x1a2)],_0x32774c=$(_0x4524d3(0x121))[_0x4524d3(0x1a2)]['trim']();if(!_0x408bdc||!_0x32774c)return toast(_0x4524d3(0x14f));currentGameId=_0x408bdc,currentPlayerName=_0x32774c;const _0x373fb2=doc(db,_0x4524d3(0x17f),currentGameId);try{await runTransaction(db,async _0x3f3b04=>{const _0x5cf94b=_0x4524d3,_0x3c55e3=await _0x3f3b04[_0x5cf94b(0x197)](_0x373fb2);if(!_0x3c55e3['exists']())throw new Error('ไม่พบห้องเกมนี้');const _0x28ab7e=_0x3c55e3[_0x5cf94b(0x174)]();if(_0x28ab7e[_0x5cf94b(0x179)]!==_0x5cf94b(0x172))throw new Error('ไม่สามารถเข้าร่วมได้\x20เกมเริ่มไปแล้ว');let _0x5a003f=_0x32774c;_0x28ab7e[_0x5cf94b(0x12f)]&&_0x28ab7e['players'][_0x5a003f]&&(_0x5a003f=''+_0x32774c+rnd(0xa,0x63),toast('ชื่อซ้ำ,\x20เปลี่ยนเป็น\x20'+_0x5a003f+_0x5cf94b(0x18c))),currentPlayerName=_0x5a003f,_0x3f3b04['update'](_0x373fb2,{[_0x5cf94b(0x177)+_0x5a003f]:{'joined':!![]}});}),document[_0x4524d3(0x188)][_0x4524d3(0x167)][_0x4524d3(0x175)](_0x4524d3(0x11e)),toast(_0x4524d3(0x16b)),listenForGameUpdates(currentGameId);}catch(_0x2f98e6){console[_0x4524d3(0x168)](_0x4524d3(0x154),_0x2f98e6),toast(_0x2f98e6['message']);}}function listenForGameUpdates(_0x235811){const _0x1314ae=_0x2d2c52;if(unsubscribeGameListener)unsubscribeGameListener();const _0x3c9335=doc(db,_0x1314ae(0x17f),_0x235811);unsubscribeGameListener=onSnapshot(_0x3c9335,_0x5dea65=>{const _0x5313d0=_0x1314ae;if(!_0x5dea65['exists']()){toast(_0x5313d0(0x190));if(unsubscribeGameListener)unsubscribeGameListener();timerInterval&&(clearInterval(timerInterval),timerInterval=null);showView(_0x5313d0(0x183));return;}const _0x2792cd=_0x5dea65[_0x5313d0(0x174)](),_0xa8014d=_0x2792cd['status'];if(_0xa8014d==='lobby')timerInterval&&(clearInterval(timerInterval),timerInterval=null),showView('player-wait');else{if(_0xa8014d===_0x5313d0(0x122))startOrUpdateTimer(_0x2792cd),showView(_0x5313d0(0x160)),renderPlayerGameView(_0x2792cd);else _0xa8014d===_0x5313d0(0x142)&&(timerInterval&&(clearInterval(timerInterval),timerInterval=null),showView(_0x5313d0(0x151)),gameOverView['innerHTML']=_0x5313d0(0x1a5),$(_0x5313d0(0x19b))[_0x5313d0(0x143)]('click',()=>$(_0x5313d0(0x16d))['click']()));}});}function startOrUpdateTimer(_0x171e87){const _0x9fe09=_0x2d2c52;if(timerInterval)clearInterval(timerInterval);const _0x1cee86=_0x171e87['gameMode']||{'timeLimit':0x3c},_0x1f1e21=_0x171e87[_0x9fe09(0x195)][_0x9fe09(0x13a)]();timerInterval=setInterval(()=>{const _0x455ccd=_0x9fe09,_0x286a4b=Math[_0x455ccd(0x146)]((Date[_0x455ccd(0x15d)]()-_0x1f1e21)/0x3e8),_0x58a575=_0x1cee86[_0x455ccd(0x166)]-_0x286a4b;if(_0x58a575<=0x0)clearInterval(timerInterval),gameTimerEl['textContent']=_0x455ccd(0x130);else{const _0x520e42=String(Math[_0x455ccd(0x146)](_0x58a575/0x3c))['padStart'](0x2,'0'),_0x2123a3=String(_0x58a575%0x3c)[_0x455ccd(0x134)](0x2,'0');gameTimerEl['textContent']='เวลา:\x20'+_0x520e42+':'+_0x2123a3;}},0x1f4);}function renderPlayerGameView(_0x1015b4){const _0x1cc3e4=_0x2d2c52,_0x59016d=(_0x1015b4[_0x1cc3e4(0x12f)]||{})[currentPlayerName];if(!_0x59016d)return;playerScoreDisplay['textContent']='คะแนน:\x20'+(_0x59016d[_0x1cc3e4(0x19e)]||0x0),playerScoreDisplay[_0x1cc3e4(0x167)][_0x1cc3e4(0x184)](_0x1cc3e4(0x149));let _0xcfcd53;if(_0x1015b4[_0x1cc3e4(0x162)]['difficulty']==='mixed'){const _0x3330fa=_0x59016d[_0x1cc3e4(0x13d)]||_0x1cc3e4(0x141);_0xcfcd53=_0x1015b4[_0x1cc3e4(0x11f)][_0x3330fa],targetNumberDisplay['textContent']=_0x1cc3e4(0x152)+_0x3330fa;}else _0xcfcd53=_0x1015b4[_0x1cc3e4(0x170)],targetNumberDisplay[_0x1cc3e4(0x17b)]=_0x1cc3e4(0x125);if(!_0xcfcd53)return;const _0x3f24aa=_0xcfcd53[_0x1cc3e4(0x12d)]||[];given=_0x3f24aa[_0x1cc3e4(0x173)](),solution=_0xcfcd53[_0x1cc3e4(0x13e)]||[],board=(_0x59016d[_0x1cc3e4(0x15a)]||_0x3f24aa['join'](''))[_0x1cc3e4(0x138)]('')[_0x1cc3e4(0x123)](_0x160d62=>parseInt(_0x160d62,0xa)||0x0),hasMistake=!!_0x59016d[_0x1cc3e4(0x196)],selectedIdx=board[_0x1cc3e4(0x19f)]((_0x5ef6fa,_0xed781c)=>!given[_0xed781c]);if(selectedIdx<0x0)selectedIdx=0x0;_0x59016d[_0x1cc3e4(0x128)]?(gameBoard[_0x1cc3e4(0x167)][_0x1cc3e4(0x175)](_0x1cc3e4(0x149)),playerFinishedView[_0x1cc3e4(0x167)][_0x1cc3e4(0x184)](_0x1cc3e4(0x149)),$('#player-finished-view\x20p')[_0x1cc3e4(0x17b)]=_0x1cc3e4(0x144)):(gameBoard[_0x1cc3e4(0x167)][_0x1cc3e4(0x184)]('hidden'),playerFinishedView[_0x1cc3e4(0x167)][_0x1cc3e4(0x175)]('hidden'),renderSudoku());}let syncTimer=null;function scheduleBoardSync(){const _0x259f05=_0x2d2c52;if(isPracticeMode)return;const _0x438763=board[_0x259f05(0x176)](_0x1e87b3=>_0x1e87b3!==0x0)[_0x259f05(0x18b)];if(syncTimer)clearTimeout(syncTimer);syncTimer=setTimeout(async()=>{const _0x3c67aa=_0x259f05;try{await updateDoc(doc(db,'games',currentGameId),{[_0x3c67aa(0x177)+currentPlayerName+_0x3c67aa(0x12a)]:board[_0x3c67aa(0x199)](''),[_0x3c67aa(0x177)+currentPlayerName+'.hasMistake']:hasMistake,[_0x3c67aa(0x177)+currentPlayerName+_0x3c67aa(0x14b)]:_0x438763});}catch(_0x47eeac){console['warn']('board\x20sync\x20failed',_0x47eeac);}},0x96);}async function tryFinish(){const _0x384160=_0x2d2c52;if(isPracticeMode){if(!isSolved())return;if(timerInterval)clearInterval(timerInterval);gameBoard[_0x384160(0x167)]['add'](_0x384160(0x149)),playerFinishedView[_0x384160(0x167)][_0x384160(0x184)](_0x384160(0x149));const _0x19d256=0x64+(hasMistake?0x0:0x32);$(_0x384160(0x15e))[_0x384160(0x16c)]='<p\x20class=\x22text-lg\x20mt-4\x22>ทำได้เยี่ยมมาก!</p>';return;}if(syncTimer)clearTimeout(syncTimer);const _0x20463f=doc(db,_0x384160(0x17f),currentGameId);try{await runTransaction(db,async _0xac854f=>{const _0x56f192=_0x384160,_0x380b26=await _0xac854f[_0x56f192(0x197)](_0x20463f);if(!_0x380b26[_0x56f192(0x135)]()||_0x380b26['data']()[_0x56f192(0x179)]!==_0x56f192(0x122))return;const _0x5781f8=_0x380b26[_0x56f192(0x174)](),_0x33cfe2=(_0x5781f8['players']||{})[currentPlayerName];if(!_0x33cfe2)return;let _0x257555;_0x5781f8[_0x56f192(0x162)][_0x56f192(0x14c)]==='mixed'?_0x257555=_0x5781f8[_0x56f192(0x11f)][_0x33cfe2[_0x56f192(0x13d)]||_0x56f192(0x141)][_0x56f192(0x13e)]:_0x257555=_0x5781f8['sudoku']['solution'];for(let _0x342e03=0x0;_0x342e03<0x10;_0x342e03++){if(board[_0x342e03]!==_0x257555[_0x342e03])return;}const _0x196659=_0x5781f8[_0x56f192(0x195)][_0x56f192(0x13a)](),_0x4a3858=Math['floor']((Date[_0x56f192(0x15d)]()-_0x196659)/0x3e8),_0x3fd80f=Math[_0x56f192(0x159)](0x0,_0x5781f8[_0x56f192(0x162)]['timeLimit']-_0x4a3858),_0x303768=0x64+_0x3fd80f+(hasMistake?0x0:0x32),_0x1678db={['players.'+currentPlayerName+_0x56f192(0x156)]:increment(_0x303768),['players.'+currentPlayerName+'.finishTime']:serverTimestamp()};_0x5781f8[_0x56f192(0x162)][_0x56f192(0x127)]===_0x56f192(0x186)&&(_0x1678db['status']='finished',_0x1678db['winner']=currentPlayerName),_0xac854f[_0x56f192(0x18d)](_0x20463f,_0x1678db);});}catch(_0x17e85b){console[_0x384160(0x168)](_0x384160(0x13b),_0x17e85b);}}$('#join-game-btn')[_0x2d2c52(0x143)](_0x2d2c52(0x19d),handleJoinGame),$(_0x2d2c52(0x158))[_0x2d2c52(0x143)]('click',startPracticeGame),$(_0x2d2c52(0x16d))['addEventListener'](_0x2d2c52(0x19d),()=>{const _0x24286a=_0x2d2c52;if(unsubscribeGameListener)unsubscribeGameListener();if(timerInterval)clearInterval(timerInterval);currentGameId=null,currentPlayerName=null,isPracticeMode=![],document[_0x24286a(0x188)][_0x24286a(0x167)][_0x24286a(0x184)](_0x24286a(0x11e)),showView('player-join');}),$('#reset-btn')['addEventListener'](_0x2d2c52(0x19d),()=>{for(let _0x2adfb1=0x0;_0x2adfb1<0x10;_0x2adfb1++)board[_0x2adfb1]=given[_0x2adfb1];hasMistake=![],renderSudoku(),scheduleBoardSync();}),initialize(),showView(_0x2d2c52(0x183));function _0x1d2a(){const _0x428c15=['รอผลการแข่งขันสักครู่...','ArrowLeft','floor','idx','33WUATTu','hidden','#game-board','.filled','difficulty','push','game24-69666.firebaseapp.com','กรุณากรอกข้อมูลให้ครบถ้วน','min','game-over','ด่าน\x20','#toast','Error\x20joining\x20game:','231380LgFmWc','.score','closest','#start-practice-btn','max','board','data-theme','#player-wait-view','now','#practice-score-display','#player-finished-view\x20h2','game','selected','gameMode','Backspace','ArrowDown','contains','timeLimit','classList','error','fill','Delete','เข้าร่วมสำเร็จ!\x20รอสักครู่...','innerHTML','#home-btn','581119habGTF','2921310PDfpFs','sudoku','9LbmJfL','lobby','slice','data','add','filter','players.','conflict','status','367101FNLihh','textContent','game24-69666.firebasestorage.app','.cell','5299570kuRGwT','games','การเชื่อมต่อล้มเหลว','เติมแล้ว\x20','ลองใหม่อีกครั้งนะ','player-join','remove','#game-code-input','immediate','1:989271279576:web:43115bbaeeae31160954ad','body','cell\x20','หมดเวลา!','length','\x20แทน','update','medium','3490ZhfoMj','ห้องเกมถูกปิดแล้ว','given','4434jmxZkC','#player-score-display','G-B1ZTE90SGG','startTime','hasMistake','get','#player-finished-view','join','g24_theme_mp','#home-btn-gameover','setItem','click','score','findIndex','#puzzle-progress','target','value','ArrowUp','AIzaSyAJsk4l8I8uCYpJY8jZLAlRW1w2qLWN-2o','<div\x20class=\x22modal-content\x22><h2>เกมจบแล้ว!</h2><p>ขอบคุณที่เข้าร่วม</p><button\x20id=\x22home-btn-gameover\x22>กลับหน้าหลัก</button></div>','div','129054UtytOS','player-view','puzzles','เวลา:\x20','#player-name-input','playing','map','forEach','Sudoku\x204x4','64VYKqNv','resultDisplayMode','finishTime','#sudoku','.board','keys','player-wait','puzzle','#game-over-view','players','เวลา:\x2000:00','#player-join-view','show','setAttribute','padStart','exists','key','appendChild','split','className','toMillis','Finish\x20attempt\x20failed:','.pick','currentLevel','solution','dataset','random','easy','finished','addEventListener'];_0x1d2a=function(){return _0x428c15;};return _0x1d2a();}