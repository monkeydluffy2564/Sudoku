const _0x4410c0=_0x8851;(function(_0x34cf1f,_0x31dcb6){const _0x374cd0=_0x8851,_0x46f978=_0x34cf1f();while(!![]){try{const _0x328525=parseInt(_0x374cd0(0xe3))/0x1+-parseInt(_0x374cd0(0x131))/0x2+-parseInt(_0x374cd0(0x147))/0x3*(-parseInt(_0x374cd0(0x190))/0x4)+parseInt(_0x374cd0(0x133))/0x5+-parseInt(_0x374cd0(0x15e))/0x6*(-parseInt(_0x374cd0(0x17a))/0x7)+parseInt(_0x374cd0(0x14c))/0x8*(parseInt(_0x374cd0(0x172))/0x9)+-parseInt(_0x374cd0(0x138))/0xa;if(_0x328525===_0x31dcb6)break;else _0x46f978['push'](_0x46f978['shift']());}catch(_0x55abc3){_0x46f978['push'](_0x46f978['shift']());}}}(_0x2abd,0x54219));import{initializeApp}from'https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js';import{getAuth,signInAnonymously,onAuthStateChanged}from'https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js';import{getFirestore,doc,getDoc,setDoc,updateDoc,onSnapshot,serverTimestamp,runTransaction,deleteDoc,deleteField,increment,collection}from'https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js';const firebaseConfig={'apiKey':_0x4410c0(0x166),'authDomain':_0x4410c0(0xe2),'projectId':_0x4410c0(0x120),'storageBucket':_0x4410c0(0x134),'messagingSenderId':_0x4410c0(0x17d),'appId':_0x4410c0(0xc5),'measurementId':_0x4410c0(0xdd)},$=_0x5e276c=>document[_0x4410c0(0xfc)](_0x5e276c),$$=_0x5c00e2=>Array[_0x4410c0(0xd9)](document[_0x4410c0(0x136)](_0x5c00e2)),playerJoinView=$(_0x4410c0(0x16e)),playerWaitView=$(_0x4410c0(0x171)),adminLobbyView=$(_0x4410c0(0x102)),gameView=$('#game-view'),adminLoginModal=$(_0x4410c0(0x18d)),adminSettingsModal=$('#admin-settings-modal'),gameOverView=$(_0x4410c0(0xb4)),sudokuEl=$('#sudoku'),pickerEl=$(_0x4410c0(0x127)),playerList=$(_0x4410c0(0x151)),lobbyPlayerNameList=$('#lobby-player-name-list'),lobbyPlayerCount=$(_0x4410c0(0x123)),hostControls=$('#host-controls'),toastEl=$(_0x4410c0(0x161)),gameCodeDisplay=$(_0x4410c0(0x10f)),gameTimerEl=$('#game-timer'),puzzleProgressEl=$('#puzzle-progress'),playerScoreDisplay=$(_0x4410c0(0x13e)),gameBoard=$('#game-board'),playerFinishedView=$('#player-finished-view'),podiumContainer=$(_0x4410c0(0xf6)),otherRankingsList=$('#other-rankings-list'),otherRankingsContainer=$(_0x4410c0(0x141)),targetNumberDisplay=$(_0x4410c0(0xee));let db,auth,userId,currentPlayerName,isHost=![],currentGameId=null,unsubscribeGameListener=null,unsubscribePlayerStateListener=null,timerInterval=null,allPlayerStates={},unsubscribeAllPlayerStates=null,latestGameData={},previousGameStatus=null,isPracticeMode=![],practicePuzzles=null,currentPracticeLevel=null,N=0x4,boxR=0x2,boxC=0x2,given=[],board=[],solution=[],selectedIdx=-0x1,hasMistake=![],gameSettings={'timeLimit':0x3c,'resultDisplayMode':'immediate','difficulty':'medium','boardSize':0x4,'numQuestions':0x1};function toast(_0x5dcda1,_0x4c4c2d=0x7d0){const _0x4ee153=_0x4410c0;toastEl['textContent']=_0x5dcda1,toastEl[_0x4ee153(0x176)]['add'](_0x4ee153(0x180)),setTimeout(()=>toastEl[_0x4ee153(0x176)]['remove'](_0x4ee153(0x180)),_0x4c4c2d);}const rnd=(_0x5a6f9e,_0x19ec40)=>Math['floor'](Math[_0x4410c0(0xe5)]()*(_0x19ec40-_0x5a6f9e+0x1))+_0x5a6f9e;function shuffle(_0x56c3f3){const _0x4a3e04=_0x4410c0;for(let _0xf4dc47=_0x56c3f3[_0x4a3e04(0xe9)]-0x1;_0xf4dc47>0x0;_0xf4dc47--){const _0x41bb54=Math[_0x4a3e04(0xbf)](Math['random']()*(_0xf4dc47+0x1));[_0x56c3f3[_0xf4dc47],_0x56c3f3[_0x41bb54]]=[_0x56c3f3[_0x41bb54],_0x56c3f3[_0xf4dc47]];}return _0x56c3f3;}const themeKey=_0x4410c0(0x16b),themeSelect=$(_0x4410c0(0x115));function applyTheme(_0x363737){const _0xbec1d0=_0x4410c0;document[_0xbec1d0(0xc1)][_0xbec1d0(0xec)](_0xbec1d0(0xca),_0x363737),localStorage[_0xbec1d0(0x18f)](themeKey,_0x363737);}const savedTheme=localStorage[_0x4410c0(0x16a)](themeKey),initialTheme=savedTheme||'contrast';applyTheme(initialTheme);themeSelect&&themeSelect[_0x4410c0(0x10d)]('change',()=>applyTheme(themeSelect['value']));function setBoardSize(_0x5e8096){const _0x395f29=_0x4410c0;document[_0x395f29(0xd0)][_0x395f29(0x176)][_0x395f29(0x100)]('board-size-4',_0x395f29(0xf1),_0x395f29(0x101)),document[_0x395f29(0xd0)][_0x395f29(0x176)][_0x395f29(0xdb)](_0x395f29(0x155)+_0x5e8096),N=parseInt(_0x5e8096,0xa);if(N===0x4)boxR=0x2,boxC=0x2;else{if(N===0x6)boxR=0x2,boxC=0x3;else N===0x9?(boxR=0x3,boxC=0x3):(N=0x4,boxR=0x2,boxC=0x2);}const _0x33a261=N*N;given=new Array(_0x33a261)['fill'](0x0),board=new Array(_0x33a261)[_0x395f29(0x132)](0x0),solution=new Array(_0x33a261)[_0x395f29(0x132)](0x0);}function makeBaseSolved(_0x5a1fd5,_0x532084,_0x42dfae){const _0x5e5f8c=_0x4410c0,_0x3f184f=new Array(_0x5a1fd5*_0x5a1fd5);for(let _0x237b90=0x0;_0x237b90<_0x5a1fd5;_0x237b90++){for(let _0x346c98=0x0;_0x346c98<_0x5a1fd5;_0x346c98++){const _0x250cf9=(_0x237b90*_0x42dfae+Math[_0x5e5f8c(0xbf)](_0x237b90/_0x532084)+_0x346c98)%_0x5a1fd5+0x1;_0x3f184f[_0x237b90*_0x5a1fd5+_0x346c98]=_0x250cf9;}}return _0x3f184f;}function applyPermutations(_0x4f0f2f,_0x1ce184,_0x26786d,_0x2deeef){const _0x58b977=_0x4410c0;let _0xad430f=_0x4f0f2f[_0x58b977(0x159)]();const _0x2fcc25=(_0x189255,_0x962bd4)=>{for(let _0xdb13a=0x0;_0xdb13a<_0x1ce184;_0xdb13a++){const _0x52847b=_0x189255*_0x1ce184+_0xdb13a,_0x497f0a=_0x962bd4*_0x1ce184+_0xdb13a;[_0xad430f[_0x52847b],_0xad430f[_0x497f0a]]=[_0xad430f[_0x497f0a],_0xad430f[_0x52847b]];}},_0x98b75f=(_0x2725f0,_0x1dfd99)=>{for(let _0x613e48=0x0;_0x613e48<_0x1ce184;_0x613e48++){const _0x287a07=_0x613e48*_0x1ce184+_0x2725f0,_0x2ff86b=_0x613e48*_0x1ce184+_0x1dfd99;[_0xad430f[_0x287a07],_0xad430f[_0x2ff86b]]=[_0xad430f[_0x2ff86b],_0xad430f[_0x287a07]];}};for(let _0x22566b=0x0;_0x22566b<_0x1ce184;_0x22566b+=_0x26786d){if(Math[_0x58b977(0xe5)]()<0.5){const _0x477832=_0x22566b+rnd(0x0,_0x26786d-0x1),_0x353f53=_0x22566b+rnd(0x0,_0x26786d-0x1);if(_0x477832!==_0x353f53)_0x2fcc25(_0x477832,_0x353f53);}}for(let _0x5caa6b=0x0;_0x5caa6b<_0x1ce184;_0x5caa6b+=_0x2deeef){if(Math['random']()<0.5){const _0x39d977=_0x5caa6b+rnd(0x0,_0x2deeef-0x1),_0x187860=_0x5caa6b+rnd(0x0,_0x2deeef-0x1);if(_0x39d977!==_0x187860)_0x98b75f(_0x39d977,_0x187860);}}if(Math[_0x58b977(0xe5)]()<0.5){const _0x113c58=rnd(0x0,_0x1ce184/_0x26786d-0x1),_0x30b98f=rnd(0x0,_0x1ce184/_0x26786d-0x1);if(_0x113c58!==_0x30b98f){for(let _0x4af2fc=0x0;_0x4af2fc<_0x26786d;_0x4af2fc++)_0x2fcc25(_0x113c58*_0x26786d+_0x4af2fc,_0x30b98f*_0x26786d+_0x4af2fc);}}if(Math[_0x58b977(0xe5)]()<0.5){const _0x1527f1=rnd(0x0,_0x1ce184/_0x2deeef-0x1),_0x58adbb=rnd(0x0,_0x1ce184/_0x2deeef-0x1);if(_0x1527f1!==_0x58adbb){for(let _0x58917c=0x0;_0x58917c<_0x2deeef;_0x58917c++)_0x98b75f(_0x1527f1*_0x2deeef+_0x58917c,_0x58adbb*_0x2deeef+_0x58917c);}}const _0x256594=[...Array(_0x1ce184)[_0x58b977(0x12d)]()][_0x58b977(0x174)](_0x397eaf=>_0x397eaf+0x1);shuffle(_0x256594);for(let _0x369a8d=0x0;_0x369a8d<_0x1ce184*_0x1ce184;_0x369a8d++)_0xad430f[_0x369a8d]=_0x256594[_0xad430f[_0x369a8d]-0x1];return _0xad430f;}function candidatesAt(_0xe1c60b,_0x17f107){const _0x34212b=_0x4410c0;if(_0xe1c60b[_0x17f107]!==0x0)return[];const _0x4d1a23=Math[_0x34212b(0xbf)](_0x17f107/N),_0x46c1a3=_0x17f107%N,_0x2270f7=new Set();for(let _0x5ece3c=0x0;_0x5ece3c<N;_0x5ece3c++){_0x2270f7[_0x34212b(0xdb)](_0xe1c60b[_0x4d1a23*N+_0x5ece3c]),_0x2270f7[_0x34212b(0xdb)](_0xe1c60b[_0x5ece3c*N+_0x46c1a3]);}const _0x3feb6a=Math[_0x34212b(0xbf)](_0x4d1a23/boxR)*boxR,_0x1f9c71=Math[_0x34212b(0xbf)](_0x46c1a3/boxC)*boxC;for(let _0x32dd72=_0x3feb6a;_0x32dd72<_0x3feb6a+boxR;_0x32dd72++)for(let _0x1338f9=_0x1f9c71;_0x1338f9<_0x1f9c71+boxC;_0x1338f9++){_0x2270f7[_0x34212b(0xdb)](_0xe1c60b[_0x32dd72*N+_0x1338f9]);}const _0x4ef8fa=[];for(let _0x21580b=0x1;_0x21580b<=N;_0x21580b++)if(!_0x2270f7['has'](_0x21580b))_0x4ef8fa[_0x34212b(0x10b)](_0x21580b);return _0x4ef8fa;}function countSolutions(_0x488c07){const _0x26342c=_0x4410c0,_0x38b6a9=_0x488c07[_0x26342c(0x159)]();let _0x19986d=0x0;const _0x33744f=[...Array(N*N)[_0x26342c(0x12d)]()][_0x26342c(0x126)](_0x501afa=>_0x38b6a9[_0x501afa]===0x0);_0x33744f[_0x26342c(0xbb)]((_0x581c17,_0x50161c)=>candidatesAt(_0x38b6a9,_0x581c17)['length']-candidatesAt(_0x38b6a9,_0x50161c)['length']);function _0x34239f(_0x40741b){const _0x37687e=_0x26342c;if(_0x19986d>0x1)return;if(_0x40741b>=_0x33744f[_0x37687e(0xe9)]){_0x19986d++;return;}const _0x55e097=_0x33744f[_0x40741b],_0x472227=candidatesAt(_0x38b6a9,_0x55e097);for(const _0x40d7ca of _0x472227){_0x38b6a9[_0x55e097]=_0x40d7ca,_0x34239f(_0x40741b+0x1);if(_0x19986d>0x1){_0x38b6a9[_0x55e097]=0x0;return;}_0x38b6a9[_0x55e097]=0x0;}}return _0x34239f(0x0),_0x19986d;}function makePuzzleByClues(_0x3faaf2,_0x2fed57){const _0x907e0a=_0x4410c0;let _0x407a59=_0x3faaf2['slice']();const _0x3e962a=shuffle([...Array(N*N)[_0x907e0a(0x12d)]()]);let _0x4bb02a=0x0;const _0x4bd820=N*N;for(const _0x5f34b6 of _0x3e962a){if(_0x4bd820-_0x4bb02a<=_0x2fed57)break;const _0x36a7d5=_0x407a59[_0x5f34b6];_0x407a59[_0x5f34b6]=0x0,countSolutions(_0x407a59)!==0x1?_0x407a59[_0x5f34b6]=_0x36a7d5:_0x4bb02a++;}return _0x407a59;}function generateSudoku(_0x54d2e3){const _0x42d419=_0x4410c0,_0x581d98=makeBaseSolved(N,boxR,boxC),_0x19a7c9=applyPermutations(_0x581d98,N,boxR,boxC),_0x511722=N===0x4?{'easy':[0x9,0xa],'medium':[0x7,0x8],'hard':[0x5,0x6]}:N===0x6?{'easy':[0x18,0x1a],'medium':[0x14,0x17],'hard':[0x10,0x13]}:{'easy':[0x24,0x28],'medium':[0x1e,0x23],'hard':[0x18,0x1d]},[_0x32cd1d,_0x12c7b7]=_0x511722[_0x54d2e3]||_0x511722[_0x42d419(0xd2)],_0x43ccd5=rnd(_0x32cd1d,_0x12c7b7);let _0x47994d=makePuzzleByClues(_0x19a7c9,_0x43ccd5);if(countSolutions(_0x47994d)!==0x1)return generateSudoku(_0x54d2e3);return{'solution':_0x19a7c9,'puzzle':_0x47994d};}function cellClasses(_0x1b3ac3){const _0x2c06d9=_0x4410c0,_0x4904eb=Math[_0x2c06d9(0xbf)](_0x1b3ac3/N),_0x396e4a=_0x1b3ac3%N,_0x2cc800=[_0x2c06d9(0xc6)];if((_0x396e4a+0x1)%boxC===0x0&&_0x396e4a!==N-0x1)_0x2cc800[_0x2c06d9(0x10b)]('bR');if((_0x4904eb+0x1)%boxR===0x0&&_0x4904eb!==N-0x1)_0x2cc800[_0x2c06d9(0x10b)]('bB');return _0x2cc800[_0x2c06d9(0x162)]('\x20');}function updateBoardFromState(_0x37a3ae){const _0x469efe=_0x4410c0;for(let _0x470323=0x0;_0x470323<N*N;_0x470323++){if(board[_0x470323]!==_0x37a3ae[_0x470323]){const _0x112139=sudokuEl[_0x469efe(0xfc)]('[data-idx=\x22'+_0x470323+'\x22]');_0x112139&&(_0x112139[_0x469efe(0x13a)]=_0x37a3ae[_0x470323]?_0x37a3ae[_0x470323]:'');}}board=_0x37a3ae,markConflictsAll(),updateProgressText();}function renderPicker(){const _0xb2da2c=_0x4410c0;pickerEl[_0xb2da2c(0xf3)]='';for(let _0x386523=0x1;_0x386523<=N;_0x386523++){const _0x2da003=document[_0xb2da2c(0x157)](_0xb2da2c(0x193));_0x2da003['className']=_0xb2da2c(0x15a),_0x2da003[_0xb2da2c(0xf5)]['n']=_0x386523,_0x2da003[_0xb2da2c(0x13a)]=_0x386523,pickerEl['appendChild'](_0x2da003);}const _0x2e6576=document[_0xb2da2c(0x157)](_0xb2da2c(0x193));_0x2e6576['className']=_0xb2da2c(0x191),_0x2e6576['dataset']['n']=0x0,_0x2e6576[_0xb2da2c(0x110)]='ลบ',_0x2e6576[_0xb2da2c(0xf3)]='<i\x20class=\x22fa-solid\x20fa-eraser\x22></i>',pickerEl[_0xb2da2c(0xb9)](_0x2e6576);}function renderSudoku(){const _0x1a6486=_0x4410c0;sudokuEl[_0x1a6486(0xba)][_0x1a6486(0xfb)]=_0x1a6486(0xc8)+N+_0x1a6486(0x16c),sudokuEl[_0x1a6486(0xf3)]='';for(let _0x469c57=0x0;_0x469c57<N*N;_0x469c57++){const _0x286e9c=board[_0x469c57],_0x535462=document[_0x1a6486(0x157)](_0x1a6486(0x14b));_0x535462['className']=cellClasses(_0x469c57)+'\x20'+(given[_0x469c57]?_0x1a6486(0x192):''),_0x535462[_0x1a6486(0xf5)][_0x1a6486(0x13b)]=_0x469c57,_0x535462[_0x1a6486(0x13a)]=_0x286e9c?_0x286e9c:'',!given[_0x469c57]&&_0x535462['addEventListener']('click',()=>selectCell(_0x469c57)),sudokuEl[_0x1a6486(0xb9)](_0x535462);}if(selectedIdx>=0x0)highlightRelatives(selectedIdx);markConflictsAll(),updateProgressText(),renderPicker();}function selectCell(_0x50dd88){const _0x3dde0a=_0x4410c0;selectedIdx=_0x50dd88,$$('.cell')['forEach'](_0x16d69b=>_0x16d69b[_0x3dde0a(0x176)]['remove'](_0x3dde0a(0x183),'hl'));const _0x44a2d9=sudokuEl[_0x3dde0a(0xfc)]('[data-idx=\x22'+_0x50dd88+'\x22]');_0x44a2d9&&(_0x44a2d9['classList']['add'](_0x3dde0a(0x183)),highlightRelatives(_0x50dd88));}function highlightRelatives(_0x8b01e9){const _0x2c3205=_0x4410c0,_0x2f9fd1=Math[_0x2c3205(0xbf)](_0x8b01e9/N),_0x3a792b=_0x8b01e9%N;$$('.cell')['forEach']((_0x139444,_0x59e348)=>{const _0x51a92c=_0x2c3205,_0x4c17ea=Math[_0x51a92c(0xbf)](_0x59e348/N),_0x4a5702=_0x59e348%N,_0x18063c=Math[_0x51a92c(0xbf)](_0x4c17ea/boxR)===Math[_0x51a92c(0xbf)](_0x2f9fd1/boxR)&&Math[_0x51a92c(0xbf)](_0x4a5702/boxC)===Math[_0x51a92c(0xbf)](_0x3a792b/boxC);(_0x4c17ea===_0x2f9fd1||_0x4a5702===_0x3a792b||_0x18063c)&&_0x139444[_0x51a92c(0x176)][_0x51a92c(0xdb)]('hl');});}function setNumber(_0x54db44){const _0x4c3d4f=_0x4410c0;if(selectedIdx<0x0||given[selectedIdx])return;const _0x47def8=sudokuEl[_0x4c3d4f(0xfc)](_0x4c3d4f(0x13c)+selectedIdx+'\x22]');if(!_0x47def8)return;_0x47def8[_0x4c3d4f(0x13a)]=_0x54db44?_0x54db44:'',board[selectedIdx]=_0x54db44;_0x54db44!==0x0&&causesConflict(selectedIdx)&&(hasMistake=!![]);markConflictsAll(),updateProgressText(),scheduleBoardSync();if(isSolved())tryFinish();}function markConflictsAll(){const _0x1ef001=_0x4410c0;$$(_0x1ef001(0x17e))['forEach']((_0x1a2e1a,_0x17c7e2)=>{const _0x4e59a7=_0x1ef001;_0x1a2e1a['classList'][_0x4e59a7(0x100)]('conflict','ok');if(board[_0x17c7e2]!==0x0&&causesConflict(_0x17c7e2))_0x1a2e1a[_0x4e59a7(0x176)][_0x4e59a7(0xdb)](_0x4e59a7(0x14f));else{if(board[_0x17c7e2]!==0x0)_0x1a2e1a[_0x4e59a7(0x176)]['add']('ok');}});}function causesConflict(_0x21c07a){const _0x7cff03=_0x4410c0,_0x3611bb=board[_0x21c07a];if(_0x3611bb===0x0)return![];const _0x3b4d00=Math[_0x7cff03(0xbf)](_0x21c07a/N),_0x242405=_0x21c07a%N;for(let _0x292b7f=0x0;_0x292b7f<N;_0x292b7f++){if(_0x292b7f!==_0x242405&&board[_0x3b4d00*N+_0x292b7f]===_0x3611bb)return!![];if(_0x292b7f!==_0x3b4d00&&board[_0x292b7f*N+_0x242405]===_0x3611bb)return!![];}const _0x1883ce=Math[_0x7cff03(0xbf)](_0x3b4d00/boxR)*boxR,_0x40d6bb=Math[_0x7cff03(0xbf)](_0x242405/boxC)*boxC;for(let _0x3a6588=_0x1883ce;_0x3a6588<_0x1883ce+boxR;_0x3a6588++)for(let _0x5778a6=_0x40d6bb;_0x5778a6<_0x40d6bb+boxC;_0x5778a6++){const _0x51e408=_0x3a6588*N+_0x5778a6;if(_0x51e408!==_0x21c07a&&board[_0x51e408]===_0x3611bb)return!![];}return![];}function isSolved(){for(let _0x474521=0x0;_0x474521<N*N;_0x474521++)if(board[_0x474521]!==solution[_0x474521])return![];return!![];}function updateProgressText(){const _0x334f1d=_0x4410c0,_0x29d2af=board[_0x334f1d(0x126)](_0x29f0ca=>_0x29f0ca!==0x0)[_0x334f1d(0xe9)];puzzleProgressEl['textContent']=_0x334f1d(0x156)+_0x29d2af+'/'+N*N;}pickerEl[_0x4410c0(0x10d)]('click',_0x4382dc=>{const _0x250535=_0x4410c0,_0x273ebd=_0x4382dc['target'][_0x250535(0x144)](_0x250535(0xbe));if(!_0x273ebd)return;setNumber(parseInt(_0x273ebd[_0x250535(0xf5)]['n'],0xa));}),document[_0x4410c0(0x10d)](_0x4410c0(0x125),_0x4ee924=>{const _0x4172ea=_0x4410c0;if(selectedIdx<0x0)return;const _0xd36370=parseInt(_0x4ee924[_0x4172ea(0x13f)],0xa);if(!isNaN(_0xd36370)&&_0xd36370>=0x1&&_0xd36370<=N)setNumber(_0xd36370);(_0x4ee924['key']===_0x4172ea(0xea)||_0x4ee924[_0x4172ea(0x13f)]===_0x4172ea(0x16d)||_0x4ee924[_0x4172ea(0x13f)]==='0')&&setNumber(0x0);const _0x5af5d1=Math[_0x4172ea(0xbf)](selectedIdx/N),_0x2590ee=selectedIdx%N;if(_0x4ee924['key']===_0x4172ea(0x163))selectCell(_0x5af5d1*N+Math[_0x4172ea(0xbd)](_0x2590ee+0x1,N-0x1));if(_0x4ee924[_0x4172ea(0x13f)]===_0x4172ea(0x14e))selectCell(_0x5af5d1*N+Math[_0x4172ea(0xbc)](_0x2590ee-0x1,0x0));if(_0x4ee924[_0x4172ea(0x13f)]==='ArrowDown')selectCell(Math['min']((_0x5af5d1+0x1)*N+_0x2590ee,N*N-0x1));if(_0x4ee924[_0x4172ea(0x13f)]==='ArrowUp')selectCell(Math[_0x4172ea(0xbc)]((_0x5af5d1-0x1)*N+_0x2590ee,0x0));});async function initialize(){const _0x39127b=_0x4410c0;try{const _0x1ffde1=initializeApp(firebaseConfig);db=getFirestore(_0x1ffde1),auth=getAuth(_0x1ffde1),onAuthStateChanged(auth,async _0x541f70=>{!_0x541f70&&await signInAnonymously(auth);});}catch(_0x1896d4){console[_0x39127b(0xdf)](_0x39127b(0xb6),_0x1896d4),toast(_0x39127b(0xfa));}}function showView(_0x576f63){const _0x38a85f=_0x4410c0;[playerJoinView,playerWaitView,adminLoginModal,adminLobbyView,gameView,gameOverView,adminSettingsModal][_0x38a85f(0xef)](_0x1dbc7f=>_0x1dbc7f['classList'][_0x38a85f(0xdb)](_0x38a85f(0x17b)));const _0xcc0e36=$(_0x38a85f(0x139));if(_0x576f63===_0x38a85f(0x129)||_0x576f63===_0x38a85f(0xe7))_0xcc0e36[_0x38a85f(0x176)][_0x38a85f(0x100)](_0x38a85f(0x17b));else isHost?_0xcc0e36[_0x38a85f(0x176)][_0x38a85f(0x100)](_0x38a85f(0x17b)):_0xcc0e36[_0x38a85f(0x176)][_0x38a85f(0xdb)]('hidden');if(_0x576f63===_0x38a85f(0x129))playerJoinView['classList'][_0x38a85f(0x100)](_0x38a85f(0x17b));else{if(_0x576f63===_0x38a85f(0xf2))playerWaitView[_0x38a85f(0x176)][_0x38a85f(0x100)](_0x38a85f(0x17b));else{if(_0x576f63===_0x38a85f(0xe7))adminLoginModal[_0x38a85f(0x176)]['remove'](_0x38a85f(0x17b));else{if(_0x576f63==='admin-lobby')adminLobbyView[_0x38a85f(0x176)][_0x38a85f(0x100)](_0x38a85f(0x17b));else{if(_0x576f63===_0x38a85f(0x18b))adminSettingsModal['classList']['remove']('hidden');else{if(_0x576f63===_0x38a85f(0x194))gameView[_0x38a85f(0x176)][_0x38a85f(0x100)](_0x38a85f(0x17b));else{if(_0x576f63===_0x38a85f(0xe8))gameOverView['classList'][_0x38a85f(0x100)](_0x38a85f(0x17b));}}}}}}}async function createGameRoom(){const _0x357738=_0x4410c0;isHost=!![],document['body'][_0x357738(0x176)][_0x357738(0x100)](_0x357738(0x119)),showView(_0x357738(0x16f)),gameCodeDisplay['textContent']='...';const _0x8e050e=rnd(0xa,0x63)[_0x357738(0x111)]();currentGameId=_0x8e050e;const _0x241e22={'hostId':auth[_0x357738(0x117)]['uid'],'status':_0x357738(0xf4),'players':{},'createdAt':serverTimestamp()};await setDoc(doc(db,_0x357738(0x173),currentGameId),_0x241e22),gameCodeDisplay[_0x357738(0x13a)]=currentGameId,listenForGameUpdates(currentGameId);}async function handleStartGame(){const _0x560f02=_0x4410c0;if(!isHost||!currentGameId)return;gameSettings[_0x560f02(0xf7)]=parseInt($(_0x560f02(0x10e))[_0x560f02(0x189)],0xa),gameSettings[_0x560f02(0x142)]=document[_0x560f02(0xfc)](_0x560f02(0xf8))[_0x560f02(0x189)],gameSettings[_0x560f02(0x158)]=Math[_0x560f02(0xbc)](0xa,parseInt($('#time-limit-input')['value']||'60',0xa)),gameSettings['difficulty']=$(_0x560f02(0x14a))[_0x560f02(0x189)],setBoardSize(gameSettings[_0x560f02(0xf7)]);const _0x4dad36=doc(db,_0x560f02(0x173),currentGameId);try{await runTransaction(db,async _0x61fdc1=>{const _0x266058=_0x560f02,_0x46ff57=await _0x61fdc1[_0x266058(0x181)](_0x4dad36);if(!_0x46ff57[_0x266058(0x13d)]())throw _0x266058(0xf9);const _0x7a31b3={'status':_0x266058(0x121),'startTime':serverTimestamp(),'gameMode':gameSettings,'sudoku':generateSudoku(gameSettings[_0x266058(0x148)])},_0x473d68=_0x7a31b3[_0x266058(0xff)][_0x266058(0x113)],_0x9d20f=_0x46ff57[_0x266058(0xd8)]()[_0x266058(0x11d)]||{};for(const _0x398e80 in _0x9d20f){_0x7a31b3['players.'+_0x398e80+_0x266058(0x106)]=0x0,_0x7a31b3[_0x266058(0xb8)+_0x398e80+_0x266058(0x103)]=null,_0x7a31b3[_0x266058(0xb8)+_0x398e80+_0x266058(0x15f)]=_0x473d68[_0x266058(0x126)](_0x3767a2=>_0x3767a2!==0x0)['length'];const _0xb414ca=doc(db,_0x266058(0x173),currentGameId,'playerStates',_0x398e80),_0x5097c5={'board':_0x473d68[_0x266058(0x162)](','),'hasMistake':![]};_0x61fdc1[_0x266058(0x152)](_0xb414ca,_0x5097c5);}_0x61fdc1['update'](_0x4dad36,_0x7a31b3);}),showView(_0x560f02(0x194));}catch(_0x31e80a){console[_0x560f02(0xdf)](_0x560f02(0x104),_0x31e80a),toast(_0x560f02(0x12e));}}function startPracticeGame(){const _0x3dae77=_0x4410c0;isPracticeMode=!![],gameSettings[_0x3dae77(0xf7)]=parseInt($(_0x3dae77(0x10e))[_0x3dae77(0x189)],0xa),gameSettings[_0x3dae77(0x158)]=Math[_0x3dae77(0xbc)](0xa,parseInt($(_0x3dae77(0x116))[_0x3dae77(0x189)]||'60',0xa)),gameSettings['difficulty']=$(_0x3dae77(0x14a))[_0x3dae77(0x189)],setBoardSize(gameSettings[_0x3dae77(0xf7)]),document[_0x3dae77(0xd0)][_0x3dae77(0x176)][_0x3dae77(0xdb)]('player-view'),hostControls[_0x3dae77(0x176)][_0x3dae77(0xdb)](_0x3dae77(0x17b)),playerScoreDisplay['classList'][_0x3dae77(0xdb)](_0x3dae77(0x17b)),$('#toggle-sidebar-btn')[_0x3dae77(0x176)][_0x3dae77(0xdb)](_0x3dae77(0x17b)),practicePuzzles=null,currentPracticeLevel=gameSettings[_0x3dae77(0x148)];const _0x5d01bc=generateSudoku(gameSettings[_0x3dae77(0x148)]);given=_0x5d01bc[_0x3dae77(0x113)][_0x3dae77(0x159)](),board=_0x5d01bc[_0x3dae77(0x113)][_0x3dae77(0x159)](),solution=_0x5d01bc[_0x3dae77(0x146)]['slice'](),targetNumberDisplay[_0x3dae77(0x13a)]=_0x3dae77(0x150)+N+'×'+N,hasMistake=![],selectedIdx=board['findIndex']((_0x33eb6e,_0x243072)=>!given[_0x243072]);if(selectedIdx<0x0)selectedIdx=0x0;showView(_0x3dae77(0x194)),gameBoard[_0x3dae77(0x176)][_0x3dae77(0x100)]('hidden'),playerFinishedView[_0x3dae77(0x176)][_0x3dae77(0xdb)]('hidden'),pickerEl['classList']['remove'](_0x3dae77(0x17b)),$(_0x3dae77(0x108))[_0x3dae77(0x176)][_0x3dae77(0x100)](_0x3dae77(0x17b)),$(_0x3dae77(0xd4))['classList'][_0x3dae77(0x100)](_0x3dae77(0x17b)),renderSudoku(),startPracticeTimer();}function startPracticeTimer(){const _0x27edc0=_0x4410c0;if(timerInterval)clearInterval(timerInterval);let _0x35b4cf=gameSettings[_0x27edc0(0x158)];const _0x135ee4=()=>{const _0x31dc24=_0x27edc0,_0x594b35=String(Math[_0x31dc24(0xbf)](_0x35b4cf/0x3c))[_0x31dc24(0x149)](0x2,'0'),_0x1cf4b2=String(_0x35b4cf%0x3c)[_0x31dc24(0x149)](0x2,'0');gameTimerEl[_0x31dc24(0x13a)]=_0x31dc24(0x17f)+_0x594b35+':'+_0x1cf4b2;};_0x135ee4(),timerInterval=setInterval(()=>{const _0x3611c8=_0x27edc0;_0x35b4cf--,_0x135ee4(),_0x35b4cf<=0x0&&(clearInterval(timerInterval),gameBoard[_0x3611c8(0x176)]['add']('hidden'),playerFinishedView[_0x3611c8(0x176)][_0x3611c8(0x100)](_0x3611c8(0x17b)),$(_0x3611c8(0xc4))[_0x3611c8(0x13a)]=_0x3611c8(0x140),$(_0x3611c8(0xd7))[_0x3611c8(0x13a)]=_0x3611c8(0xd3));},0x3e8);}async function forceEndGame(){const _0x417a9b=_0x4410c0;if(!isHost||!currentGameId)return;const _0x4fc023=doc(db,_0x417a9b(0x173),currentGameId),_0xf15c40=await getDoc(_0x4fc023);_0xf15c40[_0x417a9b(0x13d)]()&&_0xf15c40['data']()[_0x417a9b(0x186)]===_0x417a9b(0x121)&&await updateDoc(_0x4fc023,{'status':_0x417a9b(0x154),'winner':null});}async function returnToLobby(){const _0x5817ef=_0x4410c0;if(!isHost||!currentGameId)return;const _0x277eaf=doc(db,_0x5817ef(0x173),currentGameId);try{await updateDoc(_0x277eaf,{'status':'lobby','players':{},'winner':deleteField(),'sudoku':deleteField(),'puzzles':deleteField(),'startTime':deleteField(),'gameMode':deleteField()}),showView('admin-lobby');}catch(_0x50c9dc){console[_0x5817ef(0xdf)](_0x5817ef(0x112),_0x50c9dc),toast('เกิดข้อผิดพลาดในการกลับสู่ล็อบบี้');}}async function handleJoinGame(){const _0x1c6d14=_0x4410c0,_0x2ad952=$(_0x1c6d14(0xb3))[_0x1c6d14(0x189)],_0x339ef7=$('#player-name-input')[_0x1c6d14(0x189)][_0x1c6d14(0x188)]();if(!_0x2ad952||!_0x339ef7)return toast(_0x1c6d14(0xeb));currentGameId=_0x2ad952,currentPlayerName=_0x339ef7;const _0x1a0528=doc(db,_0x1c6d14(0x173),currentGameId);try{await runTransaction(db,async _0x3cf79a=>{const _0x27fd14=_0x1c6d14,_0x767a2f=await _0x3cf79a[_0x27fd14(0x181)](_0x1a0528);if(!_0x767a2f['exists']())throw new Error('ไม่พบห้องเกมนี้');const _0x475129=_0x767a2f[_0x27fd14(0xd8)]();if(_0x475129['status']!==_0x27fd14(0xf4))throw new Error(_0x27fd14(0x164));let _0x25ecf8=_0x339ef7;_0x475129[_0x27fd14(0x11d)]&&_0x475129[_0x27fd14(0x11d)][_0x25ecf8]&&(_0x25ecf8=''+_0x339ef7+rnd(0xa,0x63),toast('ชื่อซ้ำ,\x20เปลี่ยนเป็น\x20'+_0x25ecf8+'\x20แทน')),currentPlayerName=_0x25ecf8,_0x3cf79a[_0x27fd14(0xcd)](_0x1a0528,{[_0x27fd14(0xb8)+_0x25ecf8]:{'joined':!![]}});}),isHost=![],document[_0x1c6d14(0xd0)][_0x1c6d14(0x176)]['add'](_0x1c6d14(0x119)),toast(_0x1c6d14(0xe6)),listenForGameUpdates(currentGameId);}catch(_0x31de54){console[_0x1c6d14(0xdf)](_0x1c6d14(0xfd),_0x31de54),toast(_0x31de54['message']);}}function listenForGameUpdates(_0x5410ce){if(unsubscribeGameListener)unsubscribeGameListener();const _0x823042=doc(db,'games',_0x5410ce);unsubscribeGameListener=onSnapshot(_0x823042,_0x792a9c=>{const _0x2cc436=_0x8851;if(!_0x792a9c[_0x2cc436(0x13d)]()){toast(_0x2cc436(0x169));if(unsubscribeGameListener)unsubscribeGameListener();if(unsubscribePlayerStateListener)unsubscribePlayerStateListener();if(unsubscribeAllPlayerStates)unsubscribeAllPlayerStates();timerInterval&&(clearInterval(timerInterval),timerInterval=null);isHost=![],document[_0x2cc436(0xd0)]['classList'][_0x2cc436(0x100)](_0x2cc436(0x119)),showView(_0x2cc436(0x129));return;}const _0x21d865=_0x792a9c[_0x2cc436(0xd8)]();latestGameData=_0x21d865;const _0x482b45=_0x21d865[_0x2cc436(0x186)];previousGameStatus===_0x2cc436(0x121)&&_0x482b45!==_0x2cc436(0x121)&&isHost&&(unsubscribeAllPlayerStates&&(unsubscribeAllPlayerStates(),unsubscribeAllPlayerStates=null));if(!isHost&&previousGameStatus==='finished'&&_0x482b45===_0x2cc436(0xf4)){if(unsubscribeGameListener)unsubscribeGameListener();if(unsubscribePlayerStateListener)unsubscribePlayerStateListener();unsubscribePlayerStateListener=null;if(timerInterval)clearInterval(timerInterval);currentGameId=null,currentPlayerName=null,toast(_0x2cc436(0x17c)),document['body']['classList'][_0x2cc436(0x100)](_0x2cc436(0x119)),showView(_0x2cc436(0x129)),previousGameStatus=null;return;}previousGameStatus=_0x482b45;if(_0x482b45==='lobby'){timerInterval&&(clearInterval(timerInterval),timerInterval=null);if(unsubscribePlayerStateListener)unsubscribePlayerStateListener();unsubscribePlayerStateListener=null;if(isHost)showView(_0x2cc436(0x16f)),renderLobbyPlayers(_0x21d865[_0x2cc436(0x11d)]);else showView('player-wait');}else{if(_0x482b45===_0x2cc436(0x121)){startOrUpdateTimer(_0x21d865),showView('game');if(isHost){if(!unsubscribeAllPlayerStates){const _0x484bf3=collection(db,_0x2cc436(0x173),_0x5410ce,_0x2cc436(0x12f));unsubscribeAllPlayerStates=onSnapshot(_0x484bf3,_0x2ea86e=>{const _0x489f21=_0x2cc436;_0x2ea86e[_0x489f21(0xb7)][_0x489f21(0xef)](_0x154dd3=>{const _0x2f8130=_0x489f21;allPlayerStates[_0x154dd3['id']]=_0x154dd3[_0x2f8130(0xd8)]();}),renderAdminGameView();});}renderAdminGameView();if(_0x21d865[_0x2cc436(0x153)][_0x2cc436(0x142)]===_0x2cc436(0xc0)){const _0x56bb94=Object[_0x2cc436(0x11a)](_0x21d865[_0x2cc436(0x11d)]||{});_0x56bb94[_0x2cc436(0xe9)]>0x0&&_0x56bb94['every'](_0x2c577c=>_0x2c577c[_0x2cc436(0x128)])&&forceEndGame();}}else renderPlayerGameView(_0x21d865),listenForPlayerState(_0x5410ce,currentPlayerName);}else{if(_0x482b45===_0x2cc436(0x154)){timerInterval&&(clearInterval(timerInterval),timerInterval=null);if(unsubscribePlayerStateListener)unsubscribePlayerStateListener();renderGameOverView(_0x21d865);}}}});}function listenForPlayerState(_0x2ce3a5,_0x506d8b){const _0x42ef1f=_0x4410c0;if(unsubscribePlayerStateListener)return;const _0x170c9a=doc(db,_0x42ef1f(0x173),_0x2ce3a5,_0x42ef1f(0x12f),_0x506d8b);unsubscribePlayerStateListener=onSnapshot(_0x170c9a,_0x44a057=>{const _0x30b7ed=_0x42ef1f;if(_0x44a057[_0x30b7ed(0x13d)]()){const _0x2d1fb6=_0x44a057[_0x30b7ed(0xd8)](),_0x4944a3=(_0x2d1fb6['board']||'')[_0x30b7ed(0xe4)](',')[_0x30b7ed(0x174)](_0x212b24=>parseInt(_0x212b24,0xa)||0x0);hasMistake=!!_0x2d1fb6[_0x30b7ed(0xd6)],updateBoardFromState(_0x4944a3);}});}function renderLobbyPlayers(_0x522b71){const _0x3193b8=_0x4410c0,_0x24df0f=Object[_0x3193b8(0x12d)](_0x522b71||{});lobbyPlayerCount[_0x3193b8(0x13a)]=_0x24df0f[_0x3193b8(0xe9)],lobbyPlayerNameList[_0x3193b8(0xf3)]=_0x24df0f[_0x3193b8(0xe9)]===0x0?'<p\x20class=\x22text-gray-500\x20text-center\x20w-full\x22>ยังไม่มีใครเข้าร่วม...</p>':_0x24df0f[_0x3193b8(0x174)](_0x4b5958=>'<div\x20class=\x22lobby-player-tag\x22>'+_0x4b5958+_0x3193b8(0xda))['join']('');}function _0x2abd(){const _0x437da0=['#player-wait-view','72bzJRjG','games','map','#admin-back-btn','classList','sidebar-hidden','เสร็จแล้ว!','includes','959WLZRGz','hidden','แอดมินได้สร้างห้องใหม่แล้ว','989271279576','.cell','เวลา:\x20','show','get','</strong></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>เวลาที่ใช้:\x20<strong\x20class=\x22text-xl\x22\x20style=\x22color:\x20var(--accent);\x22>','selected','pointerEvents','<li><span>','status','toggle','trim','value','winner','admin-settings','onclick','#admin-login-modal','รอผลการแข่งขันสักครู่...','setItem','4dYMZWh','pick\x20erase','given','button','game','findIndex','#game-code-input','#game-over-view','คุณไขปริศนาสำเร็จ','Firebase\x20init\x20failed:','docs','players.','appendChild','style','sort','max','min','.pick','floor','wait','documentElement','#admin-password-input','#back-to-lobby-btn','#player-finished-view\x20h2','1:989271279576:web:43115bbaeeae31160954ad','cell','เกมจบแล้ว\x20มีผู้ชนะแล้ว!','repeat(','#cancel-settings-btn','data-theme',')</span></div>','board\x20sync\x20failed','update','#practice-score-display','เกิดข้อผิดพลาดในการจบเกม','body','filled','medium','ลองใหม่อีกครั้งนะ','#home-btn','<i\x20class=\x22fas\x20fa-crown\x22></i>','hasMistake','#player-finished-view\x20p','data','from','</div>','add','toMillis','G-B1ZTE90SGG','.app','error','เยี่ยมมาก!','</span><span>','game24-69666.firebaseapp.com','97461yRPQqB','split','random','เข้าร่วมสำเร็จ!\x20รอสักครู่...','admin-login','game-over','length','Backspace','กรุณากรอกข้อมูลให้ครบถ้วน','setAttribute','message','#target-number-display','forEach','className','board-size-6','player-wait','innerHTML','lobby','dataset','#podium-container','boardSize','input[name=\x22resultDisplayMode\x22]:checked','Game\x20does\x20not\x20exist!','การเชื่อมต่อล้มเหลว','gridTemplateColumns','querySelector','Error\x20joining\x20game:','#competition-settings','sudoku','remove','board-size-9','#admin-lobby-view','.finishTime','Error\x20starting\x20game:','click','.score','<i\x20class=\x22fas\x20fa-play\x20mr-2\x22></i>เริ่มแข่งขัน','#reset-btn','#sudoku\x20.cell','เวลา:\x2000:00','push','none','addEventListener','#board-size-select','#game-code-display','title','toString','Error\x20returning\x20to\x20lobby:','puzzle','podium-stand\x20podium-','#themeSelect','#time-limit-input','currentUser','</span><span\x20class=\x22player-progress\x22>','player-view','values','board','startTime','players','คะแนน:\x20','8989','game24-69666','playing','target','#lobby-player-count','score','keydown','filter','#picker','finishTime','player-join','Sudoku\x20','now','<div\x20class=\x22player-row\x22><span\x20class=\x22player-name\x22>','keys','เกิดข้อผิดพลาดในการเริ่มเกม','playerStates','<i\x20class=\x22fas\x20fa-crown\x20mr-2\x22></i>ผู้ชนะคือ\x20','168504bZtyPv','fill','2068350suMANc','game24-69666.firebasestorage.app','entries','querySelectorAll','รหัสผ่านไม่ถูกต้อง','12534210AGqofO','#admin-icon-btn','textContent','idx','[data-idx=\x22','exists','#player-score-display','key','หมดเวลา!','#other-rankings-container','resultDisplayMode','#end-game-btn','closest','#start-practice-btn','solution','1664439vnlTqo','difficulty','padStart','#difficulty-select','div','174368MhpmqM','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22text-lg\x20mt-4\x22>คะแนนรอบนี้:</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22text-4xl\x20font-bold\x22\x20style=\x22color:\x20var(--accent);\x22>','ArrowLeft','conflict','ฝึกซ้อม\x20','#player-list','set','gameMode','finished','board-size-','เติมแล้ว\x20','createElement','timeLimit','slice','pick','replace','<i\x20class=\x22fas\x20fa-play\x20mr-2\x22></i>เริ่มฝึกซ้อม','Finish\x20attempt\x20failed:','19356OalRKD','.filled','#admin-login-btn','#toast','join','ArrowRight','ไม่สามารถเข้าร่วมได้\x20เกมเริ่มไปแล้ว','#start-game-btn','AIzaSyAJsk4l8I8uCYpJY8jZLAlRW1w2qLWN-2o','\x20คะแนน</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22rank\x22>','Game\x20not\x20found','ห้องเกมถูกปิดแล้ว','getItem','g24_theme_mp',',\x201fr)','Delete','#player-join-view','admin-lobby','กลับไปหน้าแรก'];_0x2abd=function(){return _0x437da0;};return _0x2abd();}function startOrUpdateTimer(_0x1ce4f2){const _0x16bcd5=_0x4410c0;if(timerInterval)clearInterval(timerInterval);const _0x377c5d=_0x1ce4f2[_0x16bcd5(0x153)]||gameSettings,_0x47480a=_0x1ce4f2['startTime'][_0x16bcd5(0xdc)]();timerInterval=setInterval(()=>{const _0xc2605e=_0x16bcd5,_0x3a6124=Math[_0xc2605e(0xbf)]((Date[_0xc2605e(0x12b)]()-_0x47480a)/0x3e8),_0x3702fe=_0x377c5d['timeLimit']-_0x3a6124;if(_0x3702fe<=0x0){clearInterval(timerInterval),gameTimerEl[_0xc2605e(0x13a)]=_0xc2605e(0x10a);if(isHost)forceEndGame();}else{const _0x313c5f=String(Math[_0xc2605e(0xbf)](_0x3702fe/0x3c))[_0xc2605e(0x149)](0x2,'0'),_0x251e01=String(_0x3702fe%0x3c)[_0xc2605e(0x149)](0x2,'0');gameTimerEl[_0xc2605e(0x13a)]='เวลา:\x20'+_0x313c5f+':'+_0x251e01;}},0x1f4);}function renderAdminGameView(){const _0x2ef536=_0x4410c0,_0x4da633=latestGameData;if(!_0x4da633||!_0x4da633['players'])return;setBoardSize(_0x4da633[_0x2ef536(0x153)][_0x2ef536(0xf7)]),targetNumberDisplay[_0x2ef536(0x13a)]='Sudoku\x20'+N+'×'+N,$('#toggle-sidebar-btn')[_0x2ef536(0x176)][_0x2ef536(0x100)]('hidden'),hostControls[_0x2ef536(0x176)][_0x2ef536(0x100)](_0x2ef536(0x17b));const _0x17db7b=_0x4da633[_0x2ef536(0x11d)]||{},_0x7f0b1d=Object[_0x2ef536(0x135)](_0x17db7b)[_0x2ef536(0xbb)]((_0x2b2975,_0x115157)=>{const _0x4a0f7a=_0x2ef536,_0x18a03e=_0x2b2975[0x1],_0xd0d7ea=_0x115157[0x1];if((_0x18a03e['finishTime']?0x1:0x0)!==(_0xd0d7ea[_0x4a0f7a(0x128)]?0x1:0x0))return(_0xd0d7ea[_0x4a0f7a(0x128)]?0x1:0x0)-(_0x18a03e[_0x4a0f7a(0x128)]?0x1:0x0);if((_0x18a03e[_0x4a0f7a(0x124)]||0x0)!==(_0xd0d7ea[_0x4a0f7a(0x124)]||0x0))return(_0xd0d7ea[_0x4a0f7a(0x124)]||0x0)-(_0x18a03e['score']||0x0);const _0x3010ac=(allPlayerStates?.[_0x2b2975[0x0]]?.['board']||'')['split'](',')['filter'](_0x2701f6=>_0x2701f6!=='0')[_0x4a0f7a(0xe9)],_0x2b8849=(allPlayerStates?.[_0x115157[0x0]]?.[_0x4a0f7a(0x11b)]||'')[_0x4a0f7a(0xe4)](',')[_0x4a0f7a(0x126)](_0x58bd7c=>_0x58bd7c!=='0')[_0x4a0f7a(0xe9)];return _0x2b8849-_0x3010ac;});playerList['innerHTML']=_0x7f0b1d[_0x2ef536(0x174)](([_0x221aec,_0x58b3e7])=>{const _0x5a8695=_0x2ef536,_0x381b37=allPlayerStates?.[_0x221aec]?.[_0x5a8695(0x11b)]||'',_0x4f13fc=_0x381b37?_0x381b37['split'](',')[_0x5a8695(0x126)](_0x22ade3=>_0x22ade3!=='0'&&_0x22ade3!=='')[_0x5a8695(0xe9)]:0x0;let _0x2fe661=_0x58b3e7[_0x5a8695(0x128)]?'เสร็จแล้ว':_0x4f13fc+'/'+N*N;return _0x5a8695(0x12c)+_0x221aec+_0x5a8695(0x118)+(_0x58b3e7[_0x5a8695(0x124)]||0x0)+'\x20คะแนน\x20('+_0x2fe661+_0x5a8695(0xcb);})[_0x2ef536(0x162)]('');const _0x4b4534=_0x4da633['sudoku'];if(!_0x4b4534)return;given=(_0x4b4534[_0x2ef536(0x113)]||[])['slice'](),board=given[_0x2ef536(0x159)](),solution=(_0x4b4534[_0x2ef536(0x146)]||[])[_0x2ef536(0x159)](),selectedIdx=-0x1,renderSudoku(),$$(_0x2ef536(0x109))['forEach'](_0x18a997=>_0x18a997['style'][_0x2ef536(0x184)]=_0x2ef536(0x10c)),pickerEl[_0x2ef536(0x176)][_0x2ef536(0xdb)](_0x2ef536(0x17b)),$(_0x2ef536(0x108))[_0x2ef536(0x176)]['add'](_0x2ef536(0x17b)),$(_0x2ef536(0xd4))['classList'][_0x2ef536(0xdb)](_0x2ef536(0x17b));}function _0x8851(_0x1c3dd5,_0x7ffc82){const _0x2abdca=_0x2abd();return _0x8851=function(_0x88513d,_0x55a85c){_0x88513d=_0x88513d-0xb3;let _0x364a58=_0x2abdca[_0x88513d];return _0x364a58;},_0x8851(_0x1c3dd5,_0x7ffc82);}function renderPlayerGameView(_0x446a72){const _0xef5fb9=_0x4410c0;$('#toggle-sidebar-btn')[_0xef5fb9(0x176)][_0xef5fb9(0xdb)](_0xef5fb9(0x17b));const _0x1701b8=(_0x446a72[_0xef5fb9(0x11d)]||{})[currentPlayerName];if(!_0x1701b8)return;setBoardSize(_0x446a72['gameMode']['boardSize']),targetNumberDisplay[_0xef5fb9(0x13a)]=_0xef5fb9(0x12a)+N+'×'+N,playerScoreDisplay[_0xef5fb9(0x13a)]=_0xef5fb9(0x11e)+(_0x1701b8['score']||0x0),playerScoreDisplay['classList'][_0xef5fb9(0x100)](_0xef5fb9(0x17b));const _0x117337=_0x446a72[_0xef5fb9(0xff)];if(!_0x117337)return;given=(_0x117337['puzzle']||[])[_0xef5fb9(0x159)](),solution=(_0x117337[_0xef5fb9(0x146)]||[])[_0xef5fb9(0x159)](),board=given[_0xef5fb9(0x159)](),selectedIdx=board[_0xef5fb9(0x195)]((_0x2fbd67,_0x239d77)=>!given[_0x239d77]);if(selectedIdx<0x0)selectedIdx=0x0;_0x1701b8['finishTime']?(gameBoard['classList'][_0xef5fb9(0xdb)](_0xef5fb9(0x17b)),playerFinishedView['classList'][_0xef5fb9(0x100)]('hidden')):(gameBoard['classList'][_0xef5fb9(0x100)](_0xef5fb9(0x17b)),playerFinishedView['classList'][_0xef5fb9(0xdb)](_0xef5fb9(0x17b)),renderSudoku());}function renderGameOverView(_0x3b4b73){const _0x371775=_0x4410c0,_0x44042a=_0x3b4b73[_0x371775(0x18a)],_0x548c84=$('#results-header');_0x44042a?_0x548c84['innerHTML']=_0x371775(0x130)+_0x44042a+'!':_0x548c84['innerHTML']='<i\x20class=\x22fas\x20fa-trophy\x20mr-2\x22></i>หมดเวลา!';const _0x41c3e8=_0x3b4b73[_0x371775(0x11d)]||{},_0x259e06=Object[_0x371775(0x135)](_0x41c3e8)[_0x371775(0xbb)](([,_0x5dfd35],[,_0x4464af])=>{const _0x239220=_0x371775;if((_0x5dfd35[_0x239220(0x124)]||0x0)!==(_0x4464af['score']||0x0))return(_0x4464af[_0x239220(0x124)]||0x0)-(_0x5dfd35[_0x239220(0x124)]||0x0);if(_0x4464af[_0x239220(0x128)]&&_0x5dfd35['finishTime'])return _0x5dfd35[_0x239220(0x128)]['toMillis']()-_0x4464af['finishTime'][_0x239220(0xdc)]();if(_0x4464af[_0x239220(0x128)])return 0x1;if(_0x5dfd35[_0x239220(0x128)])return-0x1;return(_0x4464af[_0x239220(0xd1)]||0x0)-(_0x5dfd35[_0x239220(0xd1)]||0x0);});podiumContainer['innerHTML']='',otherRankingsList[_0x371775(0xf3)]='';const _0x20f709=_0x259e06[_0x371775(0x159)](0x0,0x3),_0x3c831d=_0x259e06['slice'](0x3);_0x20f709[_0x371775(0xef)](([_0x3427a0,_0x356e1],_0x3f5312)=>{const _0x55c7e7=_0x371775,_0x213ad6=_0x3f5312+0x1,_0x23380d=document[_0x55c7e7(0x157)](_0x55c7e7(0x14b));_0x23380d[_0x55c7e7(0xf0)]=_0x55c7e7(0x114)+_0x213ad6,_0x23380d[_0x55c7e7(0xf3)]=(_0x213ad6===0x1&&_0x44042a?_0x55c7e7(0xd5):'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22player-name\x22>'+_0x3427a0+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22player-score\x22>'+(_0x356e1['score']||0x0)+_0x55c7e7(0x167)+_0x213ad6+_0x55c7e7(0xda),podiumContainer[_0x55c7e7(0xb9)](_0x23380d);});for(let _0x2fa9a1=_0x259e06[_0x371775(0xe9)];_0x2fa9a1<0x3;_0x2fa9a1++){const _0x4e3e84=_0x2fa9a1+0x1,_0x489ad0=document[_0x371775(0x157)](_0x371775(0x14b));_0x489ad0[_0x371775(0xf0)]=_0x371775(0x114)+_0x4e3e84,podiumContainer[_0x371775(0xb9)](_0x489ad0);}if(_0x3c831d[_0x371775(0xe9)]>0x0)otherRankingsContainer[_0x371775(0x176)][_0x371775(0x100)]('hidden'),otherRankingsList[_0x371775(0xf3)]=_0x3c831d[_0x371775(0x174)](([_0x41f5b9,_0x1c0297],_0x2c07c2)=>_0x371775(0x185)+(_0x2c07c2+0x4)+'.\x20'+_0x41f5b9+_0x371775(0xe1)+(_0x1c0297[_0x371775(0x124)]||0x0)+'\x20คะแนน</span></li>')[_0x371775(0x162)]('');else otherRankingsContainer[_0x371775(0x176)]['add'](_0x371775(0x17b));if(isHost)$(_0x371775(0xc3))['classList']['remove'](_0x371775(0x17b));else $(_0x371775(0xc3))[_0x371775(0x176)][_0x371775(0xdb)](_0x371775(0x17b));showView(_0x371775(0xe8));}function renderPracticeGameOverView(){const _0x42de81=_0x4410c0,_0x299398=gameTimerEl['textContent'][_0x42de81(0x15b)](_0x42de81(0x17f),''),_0x5b9f92=_0x299398[_0x42de81(0xe4)](':'),_0x3d0b7c=parseInt(_0x5b9f92[0x0],0xa)*0x3c+parseInt(_0x5b9f92[0x1],0xa),_0x542396=gameSettings['timeLimit']-_0x3d0b7c,_0x1f9ef4=String(Math[_0x42de81(0xbf)](_0x542396/0x3c))['padStart'](0x2,'0'),_0xeac17e=String(_0x542396%0x3c)[_0x42de81(0x149)](0x2,'0'),_0x576d70=_0x1f9ef4+':'+_0xeac17e;resultsHeader['innerHTML']='<i\x20class=\x22fas\x20fa-check-circle\x20mr-2\x22></i>ฝึกซ้อมสำเร็จ!',podiumContainer[_0x42de81(0xf3)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22text-center\x20text-lg\x20space-y-4\x20my-8\x20p-6\x20rounded-lg\x22\x20style=\x22background:\x20var(--card-bg);\x20border:\x202px\x20solid\x20var(--card-border);\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>ขนาด:\x20<strong\x20class=\x22text-xl\x22\x20style=\x22color:\x20var(--accent);\x22>'+N+'×'+N+'</strong></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>ความยาก:\x20<strong\x20class=\x22text-xl\x22\x20style=\x22color:\x20var(--accent);\x22>'+gameSettings['difficulty']+_0x42de81(0x182)+_0x576d70+'</strong></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',otherRankingsContainer[_0x42de81(0x176)]['add']('hidden');const _0x547c52=$(_0x42de81(0xc3));_0x547c52['textContent']=_0x42de81(0x170),_0x547c52[_0x42de81(0x176)][_0x42de81(0x100)](_0x42de81(0x17b)),_0x547c52[_0x42de81(0x18c)]=()=>$(_0x42de81(0xd4))[_0x42de81(0x105)](),showView(_0x42de81(0xe8));}let syncTimer=null;function scheduleBoardSync(){if(isPracticeMode||!currentGameId||!currentPlayerName)return;if(syncTimer)clearTimeout(syncTimer);syncTimer=setTimeout(async()=>{const _0xf625a=_0x8851;try{const _0x544d26=doc(db,'games',currentGameId,_0xf625a(0x12f),currentPlayerName);await updateDoc(_0x544d26,{'board':board[_0xf625a(0x162)](','),'hasMistake':hasMistake});}catch(_0x12972e){console['warn'](_0xf625a(0xcc),_0x12972e);}},0x12c);}async function tryFinish(){const _0x54fbc9=_0x4410c0;if(!isSolved())return;if(isPracticeMode){if(timerInterval)clearInterval(timerInterval);const _0x5dcd43=gameTimerEl[_0x54fbc9(0x13a)][_0x54fbc9(0x15b)](_0x54fbc9(0x17f),''),_0x39d4fb=_0x5dcd43[_0x54fbc9(0xe4)](':'),_0x250c9d=parseInt(_0x39d4fb[0x0],0xa)*0x3c+parseInt(_0x39d4fb[0x1],0xa),_0xf6613b=0x64+_0x250c9d+(hasMistake?0x0:0x32);gameBoard[_0x54fbc9(0x176)][_0x54fbc9(0xdb)]('hidden'),playerFinishedView['classList'][_0x54fbc9(0x100)](_0x54fbc9(0x17b)),$(_0x54fbc9(0xc4))['textContent']=_0x54fbc9(0xe0),$(_0x54fbc9(0xd7))['textContent']=_0x54fbc9(0xb5),$(_0x54fbc9(0xce))[_0x54fbc9(0xf3)]=_0x54fbc9(0x14d)+_0xf6613b+'</div>',setTimeout(renderPracticeGameOverView,0x7d0);return;}if(syncTimer)clearTimeout(syncTimer);const _0x1f8672=doc(db,_0x54fbc9(0x173),currentGameId);try{await runTransaction(db,async _0x7dcaed=>{const _0x584f0f=_0x54fbc9,_0x3f5df9=await _0x7dcaed['get'](_0x1f8672);if(!_0x3f5df9[_0x584f0f(0x13d)]())throw new Error(_0x584f0f(0x168));const _0x4addfc=_0x3f5df9[_0x584f0f(0xd8)]();if(_0x4addfc[_0x584f0f(0x186)]!==_0x584f0f(0x121))return;const _0x2748aa=(_0x4addfc['players']||{})[currentPlayerName];if(!_0x2748aa||_0x2748aa['finishTime'])return;const _0x4cfe2e=_0x4addfc[_0x584f0f(0x11c)][_0x584f0f(0xdc)](),_0xe99a40=Math[_0x584f0f(0xbf)]((Date[_0x584f0f(0x12b)]()-_0x4cfe2e)/0x3e8),_0x36af4f=Math[_0x584f0f(0xbc)](0x0,_0x4addfc['gameMode'][_0x584f0f(0x158)]-_0xe99a40),_0x4377fa=0x64+_0x36af4f+(hasMistake?0x0:0x32),_0x2aac03={};_0x2aac03[_0x584f0f(0xb8)+currentPlayerName+_0x584f0f(0x106)]=increment(_0x4377fa),_0x2aac03[_0x584f0f(0xb8)+currentPlayerName+_0x584f0f(0x103)]=serverTimestamp(),_0x4addfc[_0x584f0f(0x153)][_0x584f0f(0x142)]==='immediate'&&(_0x2aac03[_0x584f0f(0x186)]=_0x584f0f(0x154),_0x2aac03[_0x584f0f(0x18a)]=currentPlayerName),_0x7dcaed['update'](_0x1f8672,_0x2aac03);});}catch(_0x14ed8b){_0x14ed8b[_0x54fbc9(0xed)][_0x54fbc9(0x179)]('aborted')?toast(_0x54fbc9(0xc7)):(console[_0x54fbc9(0xdf)](_0x54fbc9(0x15d),_0x14ed8b),toast(_0x54fbc9(0xcf)));}}$('#admin-icon-btn')[_0x4410c0(0x10d)]('click',()=>showView(_0x4410c0(0xe7))),$(_0x4410c0(0x175))[_0x4410c0(0x10d)](_0x4410c0(0x105),()=>showView(_0x4410c0(0x129))),$(_0x4410c0(0x160))[_0x4410c0(0x10d)](_0x4410c0(0x105),async()=>{const _0x344541=_0x4410c0;if($(_0x344541(0xc2))['value']===_0x344541(0x11f))await createGameRoom();else toast(_0x344541(0x137));}),$('#join-game-btn')[_0x4410c0(0x10d)](_0x4410c0(0x105),handleJoinGame),$(_0x4410c0(0x145))[_0x4410c0(0x10d)](_0x4410c0(0x105),()=>{const _0x5b2bdf=_0x4410c0;isPracticeMode=!![],isHost=!![],showView('admin-settings'),$(_0x5b2bdf(0xfe))[_0x5b2bdf(0x176)][_0x5b2bdf(0xdb)](_0x5b2bdf(0x17b)),$(_0x5b2bdf(0x165))[_0x5b2bdf(0xf3)]=_0x5b2bdf(0x15c);}),$('#open-settings-btn')['addEventListener'](_0x4410c0(0x105),()=>{const _0x105d50=_0x4410c0;isPracticeMode=![],showView(_0x105d50(0x18b)),$(_0x105d50(0xfe))[_0x105d50(0x176)][_0x105d50(0x100)](_0x105d50(0x17b)),$(_0x105d50(0x165))[_0x105d50(0xf3)]=_0x105d50(0x107);}),$(_0x4410c0(0xc9))['addEventListener'](_0x4410c0(0x105),()=>{const _0x3983c3=_0x4410c0;isHost&&!currentGameId&&isPracticeMode?(isPracticeMode=![],isHost=![],showView(_0x3983c3(0x129))):showView(_0x3983c3(0x16f));}),$('#start-game-btn')['addEventListener'](_0x4410c0(0x105),()=>{isPracticeMode?startPracticeGame():handleStartGame();}),$(_0x4410c0(0x143))[_0x4410c0(0x10d)](_0x4410c0(0x105),forceEndGame),$('#back-to-lobby-btn')[_0x4410c0(0x10d)]('click',returnToLobby),$(_0x4410c0(0xd4))[_0x4410c0(0x10d)]('click',()=>{const _0x58934a=_0x4410c0;if(unsubscribeGameListener)unsubscribeGameListener();unsubscribePlayerStateListener&&(unsubscribePlayerStateListener(),unsubscribePlayerStateListener=null);if(timerInterval)clearInterval(timerInterval);currentGameId=null,currentPlayerName=null,isHost=![],isPracticeMode=![],practicePuzzles=null,currentPracticeLevel=null,document[_0x58934a(0xd0)]['classList']['remove'](_0x58934a(0x119)),showView(_0x58934a(0x129)),$(_0x58934a(0xc4))[_0x58934a(0x13a)]=_0x58934a(0x178),$(_0x58934a(0xd7))[_0x58934a(0x13a)]=_0x58934a(0x18e);}),$(_0x4410c0(0x108))[_0x4410c0(0x10d)](_0x4410c0(0x105),()=>{for(let _0x47297d=0x0;_0x47297d<N*N;_0x47297d++)board[_0x47297d]=given[_0x47297d];hasMistake=![],renderSudoku(),scheduleBoardSync();}),sudokuEl['addEventListener'](_0x4410c0(0x105),_0x1307c8=>{const _0x522adb=_0x4410c0,_0x267be3=_0x1307c8[_0x522adb(0x122)][_0x522adb(0x144)](_0x522adb(0x17e));if(!_0x267be3)return;const _0x2a2a88=parseInt(_0x267be3['dataset'][_0x522adb(0x13b)],0xa);if(!given[_0x2a2a88])selectCell(_0x2a2a88);}),$('#toggle-sidebar-btn')[_0x4410c0(0x10d)](_0x4410c0(0x105),()=>{const _0x5073f2=_0x4410c0;$(_0x5073f2(0xde))[_0x5073f2(0x176)][_0x5073f2(0x187)](_0x5073f2(0x177));}),window['addEventListener']('beforeunload',()=>{isHost&&currentGameId&&deleteDoc(doc(db,'games',currentGameId));}),setBoardSize(0x4),initialize(),showView(_0x4410c0(0x129));
