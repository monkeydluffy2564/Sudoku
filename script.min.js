const _0x1f61ea=_0x38b4;(function(_0x247852,_0x5b875a){const _0x1d0164=_0x38b4,_0x216bb2=_0x247852();while(!![]){try{const _0x51de26=-parseInt(_0x1d0164(0x1eb))/0x1+-parseInt(_0x1d0164(0x1e8))/0x2*(parseInt(_0x1d0164(0x1b6))/0x3)+-parseInt(_0x1d0164(0x1df))/0x4*(-parseInt(_0x1d0164(0x166))/0x5)+parseInt(_0x1d0164(0x1cf))/0x6*(-parseInt(_0x1d0164(0x189))/0x7)+-parseInt(_0x1d0164(0x1dc))/0x8*(-parseInt(_0x1d0164(0x186))/0x9)+-parseInt(_0x1d0164(0x1ea))/0xa*(-parseInt(_0x1d0164(0x1bb))/0xb)+parseInt(_0x1d0164(0x21b))/0xc*(parseInt(_0x1d0164(0x1bc))/0xd);if(_0x51de26===_0x5b875a)break;else _0x216bb2['push'](_0x216bb2['shift']());}catch(_0x58746b){_0x216bb2['push'](_0x216bb2['shift']());}}}(_0x372e,0x9e0bb));import{initializeApp}from'https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js';import{getAuth,signInAnonymously,onAuthStateChanged}from'https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js';import{getFirestore,doc,getDoc,setDoc,updateDoc,onSnapshot,serverTimestamp,runTransaction,deleteDoc,deleteField,increment,collection}from'https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js';const firebaseConfig={'apiKey':_0x1f61ea(0x1fc),'authDomain':_0x1f61ea(0x216),'projectId':_0x1f61ea(0x178),'storageBucket':_0x1f61ea(0x1d6),'messagingSenderId':_0x1f61ea(0x194),'appId':_0x1f61ea(0x1b0),'measurementId':_0x1f61ea(0x1f9)},$=_0x5e7730=>document[_0x1f61ea(0x165)](_0x5e7730),$$=_0x281638=>Array['from'](document['querySelectorAll'](_0x281638)),playerJoinView=$(_0x1f61ea(0x1fa)),playerWaitView=$(_0x1f61ea(0x217)),adminLobbyView=$('#admin-lobby-view'),gameView=$(_0x1f61ea(0x1ef)),adminLoginModal=$(_0x1f61ea(0x153)),adminSettingsModal=$(_0x1f61ea(0x15f)),gameOverView=$(_0x1f61ea(0x1fd)),sudokuEl=$(_0x1f61ea(0x145)),pickerEl=$(_0x1f61ea(0x18f)),playerList=$(_0x1f61ea(0x187)),lobbyPlayerNameList=$(_0x1f61ea(0x170)),lobbyPlayerCount=$(_0x1f61ea(0x177)),hostControls=$('#host-controls'),toastEl=$('#toast'),gameCodeDisplay=$(_0x1f61ea(0x174)),gameTimerEl=$(_0x1f61ea(0x1e0)),puzzleProgressEl=$(_0x1f61ea(0x21a)),playerScoreDisplay=$(_0x1f61ea(0x160)),gameBoard=$(_0x1f61ea(0x14f)),playerFinishedView=$(_0x1f61ea(0x19e)),podiumContainer=$(_0x1f61ea(0x1b4)),otherRankingsList=$(_0x1f61ea(0x1c4)),otherRankingsContainer=$('#other-rankings-container'),targetNumberDisplay=$(_0x1f61ea(0x151));let db,auth,userId,currentPlayerName,isHost=![],currentGameId=null,unsubscribeGameListener=null,unsubscribePlayerStateListener=null,timerInterval=null,allPlayerStates={},unsubscribeAllPlayerStates=null,latestGameData={},previousGameStatus=null,isPracticeMode=![],practicePuzzles=null,currentPracticeLevel=null,N=0x4,boxR=0x2,boxC=0x2,given=[],board=[],solution=[],selectedIdx=-0x1,hasMistake=![],gameSettings={'timeLimit':0x3c,'resultDisplayMode':_0x1f61ea(0x222),'difficulty':'medium','boardSize':0x4,'numQuestions':0x1};function toast(_0x21eb7c,_0x4e4f6d=0x7d0){const _0x5a1583=_0x1f61ea;toastEl[_0x5a1583(0x1f1)]=_0x21eb7c,toastEl[_0x5a1583(0x16d)]['add'](_0x5a1583(0x154)),setTimeout(()=>toastEl[_0x5a1583(0x16d)][_0x5a1583(0x18d)](_0x5a1583(0x154)),_0x4e4f6d);}const rnd=(_0x183995,_0x2822d2)=>Math[_0x1f61ea(0x1d3)](Math[_0x1f61ea(0x1b9)]()*(_0x2822d2-_0x183995+0x1))+_0x183995;function shuffle(_0x1b9e44){const _0x338d88=_0x1f61ea;for(let _0x2ddfef=_0x1b9e44[_0x338d88(0x1f8)]-0x1;_0x2ddfef>0x0;_0x2ddfef--){const _0x51b76c=Math[_0x338d88(0x1d3)](Math[_0x338d88(0x1b9)]()*(_0x2ddfef+0x1));[_0x1b9e44[_0x2ddfef],_0x1b9e44[_0x51b76c]]=[_0x1b9e44[_0x51b76c],_0x1b9e44[_0x2ddfef]];}return _0x1b9e44;}const themeKey=_0x1f61ea(0x1a7),themeSelect=$('#themeSelect');function applyTheme(_0x29b946){const _0x1a07f0=_0x1f61ea;document['documentElement'][_0x1a07f0(0x1b1)](_0x1a07f0(0x1a3),_0x29b946),localStorage[_0x1a07f0(0x196)](themeKey,_0x29b946);}const savedTheme=localStorage[_0x1f61ea(0x1ec)](themeKey),initialTheme=savedTheme||_0x1f61ea(0x17a);applyTheme(initialTheme);themeSelect&&themeSelect[_0x1f61ea(0x1ca)](_0x1f61ea(0x1e5),()=>applyTheme(themeSelect[_0x1f61ea(0x1be)]));function setBoardSize(_0x3f1057){const _0x49902f=_0x1f61ea;N=parseInt(_0x3f1057,0xa);if(N===0x4)boxR=0x2,boxC=0x2;else{if(N===0x6)boxR=0x2,boxC=0x3;else N===0x9?(boxR=0x3,boxC=0x3):(N=0x4,boxR=0x2,boxC=0x2);}const _0x40236a=N*N;given=new Array(_0x40236a)['fill'](0x0),board=new Array(_0x40236a)[_0x49902f(0x198)](0x0),solution=new Array(_0x40236a)[_0x49902f(0x198)](0x0);}function makeBaseSolved(_0x53a7c9,_0x57f937,_0x2709fa){const _0x1a301a=_0x1f61ea,_0x3fc9c1=new Array(_0x53a7c9*_0x53a7c9);for(let _0x20d08b=0x0;_0x20d08b<_0x53a7c9;_0x20d08b++){for(let _0xc3e8d6=0x0;_0xc3e8d6<_0x53a7c9;_0xc3e8d6++){const _0x11cae7=(_0x20d08b*_0x2709fa+Math[_0x1a301a(0x1d3)](_0x20d08b/_0x57f937)+_0xc3e8d6)%_0x53a7c9+0x1;_0x3fc9c1[_0x20d08b*_0x53a7c9+_0xc3e8d6]=_0x11cae7;}}return _0x3fc9c1;}function applyPermutations(_0x44201a,_0x226a7b,_0xa8e2b5,_0x3df154){const _0xd3bc4b=_0x1f61ea;let _0x1cfd29=_0x44201a[_0xd3bc4b(0x1f3)]();const _0x495db7=(_0x2ea2ac,_0x108ef2)=>{for(let _0x4ddfd5=0x0;_0x4ddfd5<_0x226a7b;_0x4ddfd5++){const _0x372a00=_0x2ea2ac*_0x226a7b+_0x4ddfd5,_0x932083=_0x108ef2*_0x226a7b+_0x4ddfd5;[_0x1cfd29[_0x372a00],_0x1cfd29[_0x932083]]=[_0x1cfd29[_0x932083],_0x1cfd29[_0x372a00]];}},_0x330b7c=(_0x193d0a,_0x39c4c6)=>{for(let _0x10ddd4=0x0;_0x10ddd4<_0x226a7b;_0x10ddd4++){const _0x4af5af=_0x10ddd4*_0x226a7b+_0x193d0a,_0x3385bc=_0x10ddd4*_0x226a7b+_0x39c4c6;[_0x1cfd29[_0x4af5af],_0x1cfd29[_0x3385bc]]=[_0x1cfd29[_0x3385bc],_0x1cfd29[_0x4af5af]];}};for(let _0x4f5cbe=0x0;_0x4f5cbe<_0x226a7b;_0x4f5cbe+=_0xa8e2b5){if(Math[_0xd3bc4b(0x1b9)]()<0.5){const _0x20b609=_0x4f5cbe+rnd(0x0,_0xa8e2b5-0x1),_0x445171=_0x4f5cbe+rnd(0x0,_0xa8e2b5-0x1);if(_0x20b609!==_0x445171)_0x495db7(_0x20b609,_0x445171);}}for(let _0xb9c737=0x0;_0xb9c737<_0x226a7b;_0xb9c737+=_0x3df154){if(Math[_0xd3bc4b(0x1b9)]()<0.5){const _0x587934=_0xb9c737+rnd(0x0,_0x3df154-0x1),_0x2f876f=_0xb9c737+rnd(0x0,_0x3df154-0x1);if(_0x587934!==_0x2f876f)_0x330b7c(_0x587934,_0x2f876f);}}if(Math[_0xd3bc4b(0x1b9)]()<0.5){const _0xb95b4e=rnd(0x0,_0x226a7b/_0xa8e2b5-0x1),_0x14a68a=rnd(0x0,_0x226a7b/_0xa8e2b5-0x1);if(_0xb95b4e!==_0x14a68a){for(let _0x2864e6=0x0;_0x2864e6<_0xa8e2b5;_0x2864e6++)_0x495db7(_0xb95b4e*_0xa8e2b5+_0x2864e6,_0x14a68a*_0xa8e2b5+_0x2864e6);}}if(Math[_0xd3bc4b(0x1b9)]()<0.5){const _0x6f0e1b=rnd(0x0,_0x226a7b/_0x3df154-0x1),_0x1a060b=rnd(0x0,_0x226a7b/_0x3df154-0x1);if(_0x6f0e1b!==_0x1a060b){for(let _0x5c3a46=0x0;_0x5c3a46<_0x3df154;_0x5c3a46++)_0x330b7c(_0x6f0e1b*_0x3df154+_0x5c3a46,_0x1a060b*_0x3df154+_0x5c3a46);}}const _0x3b627a=[...Array(_0x226a7b)[_0xd3bc4b(0x140)]()][_0xd3bc4b(0x221)](_0x3eac7f=>_0x3eac7f+0x1);shuffle(_0x3b627a);for(let _0x338b0b=0x0;_0x338b0b<_0x226a7b*_0x226a7b;_0x338b0b++)_0x1cfd29[_0x338b0b]=_0x3b627a[_0x1cfd29[_0x338b0b]-0x1];return _0x1cfd29;}function candidatesAt(_0x43864d,_0x357547){const _0x598429=_0x1f61ea;if(_0x43864d[_0x357547]!==0x0)return[];const _0x283e7c=Math['floor'](_0x357547/N),_0x53e036=_0x357547%N,_0x4ae18b=new Set();for(let _0x239d2a=0x0;_0x239d2a<N;_0x239d2a++){_0x4ae18b[_0x598429(0x1ba)](_0x43864d[_0x283e7c*N+_0x239d2a]),_0x4ae18b[_0x598429(0x1ba)](_0x43864d[_0x239d2a*N+_0x53e036]);}const _0x556df7=Math['floor'](_0x283e7c/boxR)*boxR,_0x2dbe63=Math[_0x598429(0x1d3)](_0x53e036/boxC)*boxC;for(let _0x4de5ca=_0x556df7;_0x4de5ca<_0x556df7+boxR;_0x4de5ca++)for(let _0x12657c=_0x2dbe63;_0x12657c<_0x2dbe63+boxC;_0x12657c++){_0x4ae18b[_0x598429(0x1ba)](_0x43864d[_0x4de5ca*N+_0x12657c]);}const _0x4cae93=[];for(let _0x2e4360=0x1;_0x2e4360<=N;_0x2e4360++)if(!_0x4ae18b[_0x598429(0x1bf)](_0x2e4360))_0x4cae93['push'](_0x2e4360);return _0x4cae93;}function countSolutions(_0x282d96){const _0x2ca884=_0x1f61ea,_0x2845ac=_0x282d96['slice']();let _0x1ff0ba=0x0;const _0x56d85d=[...Array(N*N)[_0x2ca884(0x140)]()]['filter'](_0x2202c1=>_0x2845ac[_0x2202c1]===0x0);_0x56d85d[_0x2ca884(0x201)]((_0x306c6e,_0x976f3)=>candidatesAt(_0x2845ac,_0x306c6e)[_0x2ca884(0x1f8)]-candidatesAt(_0x2845ac,_0x976f3)['length']);function _0x44ac44(_0x16a5de){if(_0x1ff0ba>0x1)return;if(_0x16a5de>=_0x56d85d['length']){_0x1ff0ba++;return;}const _0x4a3531=_0x56d85d[_0x16a5de],_0x5556f1=candidatesAt(_0x2845ac,_0x4a3531);for(const _0xe08119 of _0x5556f1){_0x2845ac[_0x4a3531]=_0xe08119,_0x44ac44(_0x16a5de+0x1);if(_0x1ff0ba>0x1){_0x2845ac[_0x4a3531]=0x0;return;}_0x2845ac[_0x4a3531]=0x0;}}return _0x44ac44(0x0),_0x1ff0ba;}function makePuzzleByClues(_0x487b55,_0x589c19){const _0x16c578=_0x1f61ea;let _0x182d26=_0x487b55[_0x16c578(0x1f3)]();const _0x32d3be=shuffle([...Array(N*N)[_0x16c578(0x140)]()]);let _0x566ab7=0x0;const _0x2d48d4=N*N;for(const _0x19976f of _0x32d3be){if(_0x2d48d4-_0x566ab7<=_0x589c19)break;const _0x542409=_0x182d26[_0x19976f];_0x182d26[_0x19976f]=0x0,countSolutions(_0x182d26)!==0x1?_0x182d26[_0x19976f]=_0x542409:_0x566ab7++;}return _0x182d26;}function generateSudoku(_0x3616ec){const _0x316ffb=_0x1f61ea,_0x4cce17=makeBaseSolved(N,boxR,boxC),_0x98b15a=applyPermutations(_0x4cce17,N,boxR,boxC),_0x472aa6=N===0x4?{'easy':[0x9,0xa],'medium':[0x7,0x8],'hard':[0x5,0x6]}:N===0x6?{'easy':[0x18,0x1a],'medium':[0x14,0x17],'hard':[0x10,0x13]}:{'easy':[0x24,0x28],'medium':[0x1e,0x23],'hard':[0x18,0x1d]},[_0x4e2ab4,_0x47c98b]=_0x472aa6[_0x3616ec]||_0x472aa6[_0x316ffb(0x21f)],_0x12815b=rnd(_0x4e2ab4,_0x47c98b);let _0x52b94a=makePuzzleByClues(_0x98b15a,_0x12815b);if(countSolutions(_0x52b94a)!==0x1)return generateSudoku(_0x3616ec);return{'solution':_0x98b15a,'puzzle':_0x52b94a};}function _0x372e(){const _0x156cb4=['#competition-settings','#player-finished-view','Error\x20joining\x20game:','toMillis','resultDisplayMode','button','data-theme','.filled',',\x201fr)','createElement','g24_theme_mp','finished','#end-game-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22player-name\x22>','Game\x20does\x20not\x20exist!','\x20คะแนน\x20(','#start-practice-btn','#admin-icon-btn','warn','1:989271279576:web:43115bbaeeae31160954ad','setAttribute','trim','entries','#podium-container','\x20แทน','24BXGnHR','Firebase\x20init\x20failed:','input[name=\x22resultDisplayMode\x22]:checked','random','add','11050930QKPODe','13KPwnBi','conflict','value','has','difficulty','#player-finished-view\x20h2','playing','.pick','#other-rankings-list','get','เวลา:\x20','คะแนน:\x20','#cancel-settings-btn','selected','addEventListener','title','#home-btn','player-view','data','6yAjjPf','timeLimit','hasMistake','ลองใหม่อีกครั้งนะ','floor','hidden','#player-name-input','game24-69666.firebasestorage.app','games','style','filled','message','.finishTime','853144vnQycN','Delete','#practice-score-display','8hkkyKR','#game-timer','Backspace','values','player-join','<div\x20class=\x22lobby-player-tag\x22>','change','status','#game-code-input','113086IWorxI','gridTemplateColumns','10ygGbrx','946022BjLSop','getItem','every','admin-login','#game-view','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22text-lg\x20mt-4\x22>คะแนนรอบนี้:</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22text-4xl\x20font-bold\x22\x20style=\x22color:\x20var(--accent);\x22>','textContent','#sudoku\x20.cell','slice','#admin-password-input','Error\x20returning\x20to\x20lobby:','score','Sudoku\x20','length','G-B1ZTE90SGG','#player-join-view','<i\x20class=\x22fas\x20fa-check-circle\x20mr-2\x22></i>ฝึกซ้อมสำเร็จ!','AIzaSyAJsk4l8I8uCYpJY8jZLAlRW1w2qLWN-2o','#game-over-view','รหัสผ่านไม่ถูกต้อง','innerHTML','กลับไปหน้าแรก','sort','<i\x20class=\x22fas\x20fa-play\x20mr-2\x22></i>เริ่มฝึกซ้อม','game-over','filter','#difficulty-select','className','div','winner','game','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22text-center\x20text-lg\x20space-y-4\x20my-8\x20p-6\x20rounded-lg\x22\x20style=\x22background:\x20var(--card-bg);\x20border:\x202px\x20solid\x20var(--card-border);\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>ขนาด:\x20<strong\x20class=\x22text-xl\x22\x20style=\x22color:\x20var(--accent);\x22>','exists','finishTime','aborted','max','body','เวลา:\x2000:00','idx','คุณไขปริศนาสำเร็จ','error','key','playerStates','game24-69666.firebaseapp.com','#player-wait-view','Error\x20starting\x20game:','keydown','#puzzle-progress','5022060JZjFDq','<i\x20class=\x22fas\x20fa-trophy\x20mr-2\x22></i>หมดเวลา!','#toggle-sidebar-btn','none','medium','<i\x20class=\x22fas\x20fa-crown\x22></i>','map','immediate','players','admin-settings','solution','</span><span>','keys','#back-to-lobby-btn','#open-settings-btn','[data-idx=\x22','Finish\x20attempt\x20failed:','#sudoku','หมดเวลา!','closest','<div\x20class=\x22player-row\x22><span\x20class=\x22player-name\x22>','</strong></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','\x20คะแนน</span></li>','เติมแล้ว\x20','#reset-btn','<i\x20class=\x22fa-solid\x20fa-eraser\x22></i>','update','#game-board','click','#target-number-display','#start-game-btn','#admin-login-modal','show','split','puzzle','gameMode','join','<p\x20class=\x22text-gray-500\x20text-center\x20w-full\x22>ยังไม่มีใครเข้าร่วม...</p>','เสร็จแล้ว','replace','ArrowRight','min','appendChild','#admin-settings-modal','#player-score-display','เข้าร่วมสำเร็จ!\x20รอสักครู่...','given','dataset','#player-finished-view\x20p','querySelector','552520NmlUnC','board','เกมจบแล้ว\x20มีผู้ชนะแล้ว!','padStart','pick\x20erase','Game\x20not\x20found','repeat(','classList','toggle','lobby','#lobby-player-name-list','#admin-back-btn','<li><span>','player-wait','#game-code-display','sudoku','#board-size-select','#lobby-player-count','game24-69666','target','contrast','ห้องเกมถูกปิดแล้ว','.app','</strong></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>ความยาก:\x20<strong\x20class=\x22text-xl\x22\x20style=\x22color:\x20var(--accent);\x22>','board\x20sync\x20failed','docs','เยี่ยมมาก!','รอผลการแข่งขันสักครู่...','</div>','ไม่สามารถเข้าร่วมได้\x20เกมเริ่มไปแล้ว','<i\x20class=\x22fas\x20fa-crown\x20mr-2\x22></i>ผู้ชนะคือ\x20','forEach','81LKZQyw','#player-list','8989','3907463zIxgpe','.cell','onclick','.score','remove','แอดมินได้สร้างห้องใหม่แล้ว','#picker','players.','admin-lobby','ArrowUp','push','989271279576','\x20คะแนน</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22rank\x22>','setItem','findIndex','fill','wait','podium-stand\x20podium-','#time-limit-input','boardSize'];_0x372e=function(){return _0x156cb4;};return _0x372e();}function cellClasses(_0xd1704d){const _0x49c535=_0x1f61ea,_0x5b66f6=Math['floor'](_0xd1704d/N),_0x24433d=_0xd1704d%N,_0x1a1e38=['cell'];if((_0x24433d+0x1)%boxC===0x0&&_0x24433d!==N-0x1)_0x1a1e38[_0x49c535(0x193)]('bR');if((_0x5b66f6+0x1)%boxR===0x0&&_0x5b66f6!==N-0x1)_0x1a1e38[_0x49c535(0x193)]('bB');return _0x1a1e38[_0x49c535(0x158)]('\x20');}function updateBoardFromState(_0x4bdf44){const _0x106806=_0x1f61ea;for(let _0x4be064=0x0;_0x4be064<N*N;_0x4be064++){if(board[_0x4be064]!==_0x4bdf44[_0x4be064]){const _0x39710b=sudokuEl[_0x106806(0x165)](_0x106806(0x143)+_0x4be064+'\x22]');_0x39710b&&(_0x39710b[_0x106806(0x1f1)]=_0x4bdf44[_0x4be064]?_0x4bdf44[_0x4be064]:'');}}board=_0x4bdf44,markConflictsAll(),updateProgressText();}function renderPicker(){const _0x24a736=_0x1f61ea;pickerEl['innerHTML']='';for(let _0x2453f0=0x1;_0x2453f0<=N;_0x2453f0++){const _0x6adf00=document[_0x24a736(0x1a6)](_0x24a736(0x1a2));_0x6adf00[_0x24a736(0x206)]='pick',_0x6adf00[_0x24a736(0x163)]['n']=_0x2453f0,_0x6adf00[_0x24a736(0x1f1)]=_0x2453f0,pickerEl['appendChild'](_0x6adf00);}const _0x57505d=document[_0x24a736(0x1a6)]('button');_0x57505d[_0x24a736(0x206)]=_0x24a736(0x16a),_0x57505d['dataset']['n']=0x0,_0x57505d[_0x24a736(0x1cb)]='ลบ',_0x57505d[_0x24a736(0x1ff)]=_0x24a736(0x14d),pickerEl[_0x24a736(0x15e)](_0x57505d);}function renderSudoku(){const _0x123626=_0x1f61ea;sudokuEl[_0x123626(0x1d8)][_0x123626(0x1e9)]=_0x123626(0x16c)+N+_0x123626(0x1a5),sudokuEl['innerHTML']='';for(let _0x5adc2a=0x0;_0x5adc2a<N*N;_0x5adc2a++){const _0x3505d8=board[_0x5adc2a],_0x187060=document[_0x123626(0x1a6)](_0x123626(0x207));_0x187060[_0x123626(0x206)]=cellClasses(_0x5adc2a)+'\x20'+(given[_0x5adc2a]?_0x123626(0x162):''),_0x187060[_0x123626(0x163)]['idx']=_0x5adc2a,_0x187060[_0x123626(0x1f1)]=_0x3505d8?_0x3505d8:'',!given[_0x5adc2a]&&_0x187060[_0x123626(0x1ca)](_0x123626(0x150),()=>selectCell(_0x5adc2a)),sudokuEl[_0x123626(0x15e)](_0x187060);}if(selectedIdx>=0x0)highlightRelatives(selectedIdx);markConflictsAll(),updateProgressText(),renderPicker();}function selectCell(_0x1742eb){const _0x5d6a24=_0x1f61ea;selectedIdx=_0x1742eb,$$('.cell')['forEach'](_0x202080=>_0x202080[_0x5d6a24(0x16d)]['remove'](_0x5d6a24(0x1c9),'hl'));const _0x10e404=sudokuEl[_0x5d6a24(0x165)]('[data-idx=\x22'+_0x1742eb+'\x22]');_0x10e404&&(_0x10e404[_0x5d6a24(0x16d)][_0x5d6a24(0x1ba)]('selected'),highlightRelatives(_0x1742eb));}function highlightRelatives(_0x410194){const _0x10e062=_0x1f61ea,_0x378aad=Math['floor'](_0x410194/N),_0x4b9a26=_0x410194%N;$$(_0x10e062(0x18a))['forEach']((_0x3a6ddf,_0x2f85b4)=>{const _0x18cc42=_0x10e062,_0x666e72=Math['floor'](_0x2f85b4/N),_0x937222=_0x2f85b4%N,_0x1eeabf=Math[_0x18cc42(0x1d3)](_0x666e72/boxR)===Math[_0x18cc42(0x1d3)](_0x378aad/boxR)&&Math[_0x18cc42(0x1d3)](_0x937222/boxC)===Math[_0x18cc42(0x1d3)](_0x4b9a26/boxC);(_0x666e72===_0x378aad||_0x937222===_0x4b9a26||_0x1eeabf)&&_0x3a6ddf[_0x18cc42(0x16d)][_0x18cc42(0x1ba)]('hl');});}function setNumber(_0x135564){const _0x27ab6c=_0x1f61ea;if(selectedIdx<0x0||given[selectedIdx])return;const _0x5459eb=sudokuEl[_0x27ab6c(0x165)](_0x27ab6c(0x143)+selectedIdx+'\x22]');if(!_0x5459eb)return;_0x5459eb[_0x27ab6c(0x1f1)]=_0x135564?_0x135564:'',board[selectedIdx]=_0x135564;_0x135564!==0x0&&causesConflict(selectedIdx)&&(hasMistake=!![]);markConflictsAll(),updateProgressText(),scheduleBoardSync();if(isSolved())tryFinish();}function markConflictsAll(){const _0x14b98b=_0x1f61ea;$$(_0x14b98b(0x18a))['forEach']((_0x9bbcb7,_0x7580a7)=>{const _0x476727=_0x14b98b;_0x9bbcb7[_0x476727(0x16d)][_0x476727(0x18d)]('conflict','ok');if(board[_0x7580a7]!==0x0&&causesConflict(_0x7580a7))_0x9bbcb7['classList'][_0x476727(0x1ba)](_0x476727(0x1bd));else{if(board[_0x7580a7]!==0x0)_0x9bbcb7[_0x476727(0x16d)][_0x476727(0x1ba)]('ok');}});}function causesConflict(_0x5e2227){const _0x3974c1=_0x1f61ea,_0xcc5641=board[_0x5e2227];if(_0xcc5641===0x0)return![];const _0x5d05cb=Math['floor'](_0x5e2227/N),_0x7ead1c=_0x5e2227%N;for(let _0x4d3dd3=0x0;_0x4d3dd3<N;_0x4d3dd3++){if(_0x4d3dd3!==_0x7ead1c&&board[_0x5d05cb*N+_0x4d3dd3]===_0xcc5641)return!![];if(_0x4d3dd3!==_0x5d05cb&&board[_0x4d3dd3*N+_0x7ead1c]===_0xcc5641)return!![];}const _0x1d837e=Math['floor'](_0x5d05cb/boxR)*boxR,_0x1bcf83=Math[_0x3974c1(0x1d3)](_0x7ead1c/boxC)*boxC;for(let _0x4611de=_0x1d837e;_0x4611de<_0x1d837e+boxR;_0x4611de++)for(let _0x40d567=_0x1bcf83;_0x40d567<_0x1bcf83+boxC;_0x40d567++){const _0x4f3c6f=_0x4611de*N+_0x40d567;if(_0x4f3c6f!==_0x5e2227&&board[_0x4f3c6f]===_0xcc5641)return!![];}return![];}function isSolved(){for(let _0x9145dd=0x0;_0x9145dd<N*N;_0x9145dd++)if(board[_0x9145dd]!==solution[_0x9145dd])return![];return!![];}function updateProgressText(){const _0x592b3b=_0x1f61ea,_0x4ad643=board[_0x592b3b(0x204)](_0x427540=>_0x427540!==0x0)[_0x592b3b(0x1f8)];puzzleProgressEl[_0x592b3b(0x1f1)]=_0x592b3b(0x14b)+_0x4ad643+'/'+N*N;}pickerEl[_0x1f61ea(0x1ca)](_0x1f61ea(0x150),_0x507bf1=>{const _0x20fd11=_0x1f61ea,_0x5cbb12=_0x507bf1[_0x20fd11(0x179)]['closest'](_0x20fd11(0x1c3));if(!_0x5cbb12)return;setNumber(parseInt(_0x5cbb12[_0x20fd11(0x163)]['n'],0xa));}),document[_0x1f61ea(0x1ca)](_0x1f61ea(0x219),_0x1adb61=>{const _0x2fca5b=_0x1f61ea;if(selectedIdx<0x0)return;const _0x50246a=parseInt(_0x1adb61['key'],0xa);if(!isNaN(_0x50246a)&&_0x50246a>=0x1&&_0x50246a<=N)setNumber(_0x50246a);(_0x1adb61[_0x2fca5b(0x214)]===_0x2fca5b(0x1e1)||_0x1adb61[_0x2fca5b(0x214)]===_0x2fca5b(0x1dd)||_0x1adb61[_0x2fca5b(0x214)]==='0')&&setNumber(0x0);const _0x5f3b00=Math[_0x2fca5b(0x1d3)](selectedIdx/N),_0x10edbb=selectedIdx%N;if(_0x1adb61[_0x2fca5b(0x214)]===_0x2fca5b(0x15c))selectCell(_0x5f3b00*N+Math[_0x2fca5b(0x15d)](_0x10edbb+0x1,N-0x1));if(_0x1adb61['key']==='ArrowLeft')selectCell(_0x5f3b00*N+Math[_0x2fca5b(0x20e)](_0x10edbb-0x1,0x0));if(_0x1adb61[_0x2fca5b(0x214)]==='ArrowDown')selectCell(Math[_0x2fca5b(0x15d)]((_0x5f3b00+0x1)*N+_0x10edbb,N*N-0x1));if(_0x1adb61[_0x2fca5b(0x214)]===_0x2fca5b(0x192))selectCell(Math[_0x2fca5b(0x20e)]((_0x5f3b00-0x1)*N+_0x10edbb,0x0));});async function initialize(){const _0x416b63=_0x1f61ea;try{const _0x260cc4=initializeApp(firebaseConfig);db=getFirestore(_0x260cc4),auth=getAuth(_0x260cc4),onAuthStateChanged(auth,async _0x1962e4=>{!_0x1962e4&&await signInAnonymously(auth);});}catch(_0x3c4125){console[_0x416b63(0x213)](_0x416b63(0x1b7),_0x3c4125),toast('การเชื่อมต่อล้มเหลว');}}function showView(_0x986737){const _0x21cee3=_0x1f61ea;[playerJoinView,playerWaitView,adminLoginModal,adminLobbyView,gameView,gameOverView,adminSettingsModal][_0x21cee3(0x185)](_0x577139=>_0x577139[_0x21cee3(0x16d)][_0x21cee3(0x1ba)](_0x21cee3(0x1d4)));const _0x39b0c4=$(_0x21cee3(0x1ae));if(_0x986737===_0x21cee3(0x1e3)||_0x986737==='admin-login')_0x39b0c4[_0x21cee3(0x16d)][_0x21cee3(0x18d)]('hidden');else isHost?_0x39b0c4[_0x21cee3(0x16d)][_0x21cee3(0x18d)]('hidden'):_0x39b0c4['classList'][_0x21cee3(0x1ba)](_0x21cee3(0x1d4));if(_0x986737===_0x21cee3(0x1e3))playerJoinView['classList'][_0x21cee3(0x18d)](_0x21cee3(0x1d4));else{if(_0x986737===_0x21cee3(0x173))playerWaitView[_0x21cee3(0x16d)][_0x21cee3(0x18d)](_0x21cee3(0x1d4));else{if(_0x986737===_0x21cee3(0x1ee))adminLoginModal[_0x21cee3(0x16d)][_0x21cee3(0x18d)](_0x21cee3(0x1d4));else{if(_0x986737===_0x21cee3(0x191))adminLobbyView['classList'][_0x21cee3(0x18d)]('hidden');else{if(_0x986737===_0x21cee3(0x13d))adminSettingsModal[_0x21cee3(0x16d)][_0x21cee3(0x18d)]('hidden');else{if(_0x986737===_0x21cee3(0x209))gameView[_0x21cee3(0x16d)][_0x21cee3(0x18d)](_0x21cee3(0x1d4));else{if(_0x986737===_0x21cee3(0x203))gameOverView[_0x21cee3(0x16d)]['remove'](_0x21cee3(0x1d4));}}}}}}}async function createGameRoom(){const _0x33ae34=_0x1f61ea;isHost=!![],document[_0x33ae34(0x20f)][_0x33ae34(0x16d)][_0x33ae34(0x18d)](_0x33ae34(0x1cd)),showView(_0x33ae34(0x191)),gameCodeDisplay[_0x33ae34(0x1f1)]='...';const _0x3cf737=rnd(0xa,0x63)['toString']();currentGameId=_0x3cf737;const _0x209379={'hostId':auth['currentUser']['uid'],'status':_0x33ae34(0x16f),'players':{},'createdAt':serverTimestamp()};await setDoc(doc(db,_0x33ae34(0x1d7),currentGameId),_0x209379),gameCodeDisplay['textContent']=currentGameId,listenForGameUpdates(currentGameId);}async function handleStartGame(){const _0x2482d8=_0x1f61ea;if(!isHost||!currentGameId)return;gameSettings[_0x2482d8(0x19c)]=parseInt($('#board-size-select')[_0x2482d8(0x1be)],0xa),gameSettings['resultDisplayMode']=document['querySelector'](_0x2482d8(0x1b8))[_0x2482d8(0x1be)],gameSettings['timeLimit']=Math[_0x2482d8(0x20e)](0xa,parseInt($(_0x2482d8(0x19b))[_0x2482d8(0x1be)]||'60',0xa)),gameSettings['difficulty']=$(_0x2482d8(0x205))['value'],setBoardSize(gameSettings['boardSize']);const _0x25a717=doc(db,_0x2482d8(0x1d7),currentGameId);try{await runTransaction(db,async _0x21bdda=>{const _0x2f70ee=_0x2482d8,_0x150243=await _0x21bdda['get'](_0x25a717);if(!_0x150243['exists']())throw _0x2f70ee(0x1ab);const _0x517908={'status':_0x2f70ee(0x1c2),'startTime':serverTimestamp(),'gameMode':gameSettings,'sudoku':generateSudoku(gameSettings['difficulty'])},_0x5bc3dd=_0x517908[_0x2f70ee(0x175)][_0x2f70ee(0x156)],_0x3e0803=_0x150243[_0x2f70ee(0x1ce)]()[_0x2f70ee(0x13c)]||{};for(const _0x60c999 in _0x3e0803){_0x517908[_0x2f70ee(0x190)+_0x60c999+_0x2f70ee(0x18c)]=0x0,_0x517908[_0x2f70ee(0x190)+_0x60c999+_0x2f70ee(0x1db)]=null,_0x517908['players.'+_0x60c999+_0x2f70ee(0x1a4)]=_0x5bc3dd[_0x2f70ee(0x204)](_0xfcf6d5=>_0xfcf6d5!==0x0)['length'];const _0x6e9108=doc(db,'games',currentGameId,_0x2f70ee(0x215),_0x60c999),_0x2dce8f={'board':_0x5bc3dd[_0x2f70ee(0x158)](','),'hasMistake':![]};_0x21bdda['set'](_0x6e9108,_0x2dce8f);}_0x21bdda[_0x2f70ee(0x14e)](_0x25a717,_0x517908);}),showView('game');}catch(_0x2c5292){console[_0x2482d8(0x213)](_0x2482d8(0x218),_0x2c5292),toast('เกิดข้อผิดพลาดในการเริ่มเกม');}}function startPracticeGame(){const _0x58d3e8=_0x1f61ea;isPracticeMode=!![],gameSettings[_0x58d3e8(0x19c)]=parseInt($(_0x58d3e8(0x176))[_0x58d3e8(0x1be)],0xa),gameSettings[_0x58d3e8(0x1d0)]=Math['max'](0xa,parseInt($(_0x58d3e8(0x19b))[_0x58d3e8(0x1be)]||'60',0xa)),gameSettings['difficulty']=$(_0x58d3e8(0x205))[_0x58d3e8(0x1be)],setBoardSize(gameSettings[_0x58d3e8(0x19c)]),document['body'][_0x58d3e8(0x16d)][_0x58d3e8(0x1ba)](_0x58d3e8(0x1cd)),hostControls['classList'][_0x58d3e8(0x1ba)]('hidden'),playerScoreDisplay[_0x58d3e8(0x16d)][_0x58d3e8(0x1ba)]('hidden'),$('#toggle-sidebar-btn')[_0x58d3e8(0x16d)]['add'](_0x58d3e8(0x1d4)),practicePuzzles=null,currentPracticeLevel=gameSettings[_0x58d3e8(0x1c0)];const _0x44bbc2=generateSudoku(gameSettings[_0x58d3e8(0x1c0)]);given=_0x44bbc2['puzzle'][_0x58d3e8(0x1f3)](),board=_0x44bbc2['puzzle'][_0x58d3e8(0x1f3)](),solution=_0x44bbc2[_0x58d3e8(0x13e)][_0x58d3e8(0x1f3)](),targetNumberDisplay[_0x58d3e8(0x1f1)]='ฝึกซ้อม\x20'+N+'×'+N,hasMistake=![],selectedIdx=board['findIndex']((_0x361bfc,_0x7b7004)=>!given[_0x7b7004]);if(selectedIdx<0x0)selectedIdx=0x0;showView(_0x58d3e8(0x209)),gameBoard[_0x58d3e8(0x16d)]['remove'](_0x58d3e8(0x1d4)),playerFinishedView[_0x58d3e8(0x16d)][_0x58d3e8(0x1ba)](_0x58d3e8(0x1d4)),pickerEl[_0x58d3e8(0x16d)][_0x58d3e8(0x18d)](_0x58d3e8(0x1d4)),$(_0x58d3e8(0x14c))[_0x58d3e8(0x16d)]['remove'](_0x58d3e8(0x1d4)),$(_0x58d3e8(0x1cc))[_0x58d3e8(0x16d)][_0x58d3e8(0x18d)](_0x58d3e8(0x1d4)),renderSudoku(),startPracticeTimer();}function startPracticeTimer(){const _0x1cb8fc=_0x1f61ea;if(timerInterval)clearInterval(timerInterval);let _0x56a89e=gameSettings[_0x1cb8fc(0x1d0)];const _0xa78cd9=()=>{const _0x4041f5=_0x1cb8fc,_0x5f0e0a=String(Math['floor'](_0x56a89e/0x3c))[_0x4041f5(0x169)](0x2,'0'),_0x35326=String(_0x56a89e%0x3c)[_0x4041f5(0x169)](0x2,'0');gameTimerEl[_0x4041f5(0x1f1)]=_0x4041f5(0x1c6)+_0x5f0e0a+':'+_0x35326;};_0xa78cd9(),timerInterval=setInterval(()=>{const _0xc51e2e=_0x1cb8fc;_0x56a89e--,_0xa78cd9(),_0x56a89e<=0x0&&(clearInterval(timerInterval),gameBoard[_0xc51e2e(0x16d)][_0xc51e2e(0x1ba)](_0xc51e2e(0x1d4)),playerFinishedView[_0xc51e2e(0x16d)][_0xc51e2e(0x18d)](_0xc51e2e(0x1d4)),$(_0xc51e2e(0x1c1))[_0xc51e2e(0x1f1)]=_0xc51e2e(0x146),$(_0xc51e2e(0x164))[_0xc51e2e(0x1f1)]=_0xc51e2e(0x1d2));},0x3e8);}async function forceEndGame(){const _0x4cf6db=_0x1f61ea;if(!isHost||!currentGameId)return;const _0x2d99e1=doc(db,_0x4cf6db(0x1d7),currentGameId),_0x58f5ed=await getDoc(_0x2d99e1);_0x58f5ed[_0x4cf6db(0x20b)]()&&_0x58f5ed['data']()[_0x4cf6db(0x1e6)]===_0x4cf6db(0x1c2)&&await updateDoc(_0x2d99e1,{'status':_0x4cf6db(0x1a8),'winner':null});}async function returnToLobby(){const _0x4e9961=_0x1f61ea;if(!isHost||!currentGameId)return;const _0x116b6f=doc(db,_0x4e9961(0x1d7),currentGameId);try{await updateDoc(_0x116b6f,{'status':'lobby','players':{},'winner':deleteField(),'sudoku':deleteField(),'puzzles':deleteField(),'startTime':deleteField(),'gameMode':deleteField()}),showView(_0x4e9961(0x191));}catch(_0x23ad0d){console[_0x4e9961(0x213)](_0x4e9961(0x1f5),_0x23ad0d),toast('เกิดข้อผิดพลาดในการกลับสู่ล็อบบี้');}}async function handleJoinGame(){const _0x37f4fa=_0x1f61ea,_0x2ad2fd=$(_0x37f4fa(0x1e7))[_0x37f4fa(0x1be)],_0xac8eeb=$(_0x37f4fa(0x1d5))[_0x37f4fa(0x1be)][_0x37f4fa(0x1b2)]();if(!_0x2ad2fd||!_0xac8eeb)return toast('กรุณากรอกข้อมูลให้ครบถ้วน');currentGameId=_0x2ad2fd,currentPlayerName=_0xac8eeb;const _0x56870c=doc(db,_0x37f4fa(0x1d7),currentGameId);try{await runTransaction(db,async _0x150cad=>{const _0x5cb2ed=_0x37f4fa,_0x1a755d=await _0x150cad[_0x5cb2ed(0x1c5)](_0x56870c);if(!_0x1a755d[_0x5cb2ed(0x20b)]())throw new Error('ไม่พบห้องเกมนี้');const _0x1b644c=_0x1a755d['data']();if(_0x1b644c['status']!==_0x5cb2ed(0x16f))throw new Error(_0x5cb2ed(0x183));let _0x29bca0=_0xac8eeb;_0x1b644c['players']&&_0x1b644c[_0x5cb2ed(0x13c)][_0x29bca0]&&(_0x29bca0=''+_0xac8eeb+rnd(0xa,0x63),toast('ชื่อซ้ำ,\x20เปลี่ยนเป็น\x20'+_0x29bca0+_0x5cb2ed(0x1b5))),currentPlayerName=_0x29bca0,_0x150cad[_0x5cb2ed(0x14e)](_0x56870c,{[_0x5cb2ed(0x190)+_0x29bca0]:{'joined':!![]}});}),isHost=![],document['body']['classList'][_0x37f4fa(0x1ba)](_0x37f4fa(0x1cd)),toast(_0x37f4fa(0x161)),listenForGameUpdates(currentGameId);}catch(_0x590001){console[_0x37f4fa(0x213)](_0x37f4fa(0x19f),_0x590001),toast(_0x590001[_0x37f4fa(0x1da)]);}}function listenForGameUpdates(_0x281455){const _0x3fc2fa=_0x1f61ea;if(unsubscribeGameListener)unsubscribeGameListener();const _0x321e38=doc(db,_0x3fc2fa(0x1d7),_0x281455);unsubscribeGameListener=onSnapshot(_0x321e38,_0x4f74ac=>{const _0x5c6418=_0x3fc2fa;if(!_0x4f74ac[_0x5c6418(0x20b)]()){toast(_0x5c6418(0x17b));if(unsubscribeGameListener)unsubscribeGameListener();if(unsubscribePlayerStateListener)unsubscribePlayerStateListener();if(unsubscribeAllPlayerStates)unsubscribeAllPlayerStates();timerInterval&&(clearInterval(timerInterval),timerInterval=null);isHost=![],document[_0x5c6418(0x20f)][_0x5c6418(0x16d)][_0x5c6418(0x18d)](_0x5c6418(0x1cd)),showView('player-join');return;}const _0x5e4d65=_0x4f74ac[_0x5c6418(0x1ce)]();latestGameData=_0x5e4d65;const _0x301441=_0x5e4d65[_0x5c6418(0x1e6)];previousGameStatus===_0x5c6418(0x1c2)&&_0x301441!==_0x5c6418(0x1c2)&&isHost&&(unsubscribeAllPlayerStates&&(unsubscribeAllPlayerStates(),unsubscribeAllPlayerStates=null));if(!isHost&&previousGameStatus==='finished'&&_0x301441===_0x5c6418(0x16f)){if(unsubscribeGameListener)unsubscribeGameListener();if(unsubscribePlayerStateListener)unsubscribePlayerStateListener();unsubscribePlayerStateListener=null;if(timerInterval)clearInterval(timerInterval);currentGameId=null,currentPlayerName=null,toast(_0x5c6418(0x18e)),document['body'][_0x5c6418(0x16d)]['remove'](_0x5c6418(0x1cd)),showView(_0x5c6418(0x1e3)),previousGameStatus=null;return;}previousGameStatus=_0x301441;if(_0x301441===_0x5c6418(0x16f)){timerInterval&&(clearInterval(timerInterval),timerInterval=null);if(unsubscribePlayerStateListener)unsubscribePlayerStateListener();unsubscribePlayerStateListener=null;if(isHost)showView(_0x5c6418(0x191)),renderLobbyPlayers(_0x5e4d65[_0x5c6418(0x13c)]);else showView(_0x5c6418(0x173));}else{if(_0x301441==='playing'){startOrUpdateTimer(_0x5e4d65),showView(_0x5c6418(0x209));if(isHost){if(!unsubscribeAllPlayerStates){const _0x44e345=collection(db,'games',_0x281455,'playerStates');unsubscribeAllPlayerStates=onSnapshot(_0x44e345,_0x7ec753=>{const _0x42274c=_0x5c6418;_0x7ec753[_0x42274c(0x17f)]['forEach'](_0x30d62c=>{const _0x4a62d3=_0x42274c;allPlayerStates[_0x30d62c['id']]=_0x30d62c[_0x4a62d3(0x1ce)]();}),renderAdminGameView();});}renderAdminGameView();if(_0x5e4d65[_0x5c6418(0x157)][_0x5c6418(0x1a1)]===_0x5c6418(0x199)){const _0x3c833a=Object[_0x5c6418(0x1e2)](_0x5e4d65[_0x5c6418(0x13c)]||{});_0x3c833a[_0x5c6418(0x1f8)]>0x0&&_0x3c833a[_0x5c6418(0x1ed)](_0x504390=>_0x504390[_0x5c6418(0x20c)])&&forceEndGame();}}else renderPlayerGameView(_0x5e4d65),listenForPlayerState(_0x281455,currentPlayerName);}else{if(_0x301441===_0x5c6418(0x1a8)){timerInterval&&(clearInterval(timerInterval),timerInterval=null);if(unsubscribePlayerStateListener)unsubscribePlayerStateListener();renderGameOverView(_0x5e4d65);}}}});}function listenForPlayerState(_0x58ffaa,_0x5cafb3){const _0x25946b=_0x1f61ea;if(unsubscribePlayerStateListener)return;const _0x8f261b=doc(db,'games',_0x58ffaa,_0x25946b(0x215),_0x5cafb3);unsubscribePlayerStateListener=onSnapshot(_0x8f261b,_0x25264d=>{const _0x4a3652=_0x25946b;if(_0x25264d[_0x4a3652(0x20b)]()){const _0x30091a=_0x25264d[_0x4a3652(0x1ce)](),_0x1805f3=(_0x30091a[_0x4a3652(0x167)]||'')['split'](',')['map'](_0x5297a8=>parseInt(_0x5297a8,0xa)||0x0);hasMistake=!!_0x30091a[_0x4a3652(0x1d1)],updateBoardFromState(_0x1805f3);}});}function renderLobbyPlayers(_0x4d4a7c){const _0x389ada=_0x1f61ea,_0x5564af=Object[_0x389ada(0x140)](_0x4d4a7c||{});lobbyPlayerCount[_0x389ada(0x1f1)]=_0x5564af['length'],lobbyPlayerNameList[_0x389ada(0x1ff)]=_0x5564af[_0x389ada(0x1f8)]===0x0?_0x389ada(0x159):_0x5564af['map'](_0x51a013=>_0x389ada(0x1e4)+_0x51a013+'</div>')[_0x389ada(0x158)]('');}function startOrUpdateTimer(_0x22f76e){const _0x59ac78=_0x1f61ea;if(timerInterval)clearInterval(timerInterval);const _0x5337ff=_0x22f76e[_0x59ac78(0x157)]||gameSettings,_0x47f31b=_0x22f76e['startTime'][_0x59ac78(0x1a0)]();timerInterval=setInterval(()=>{const _0x13f7c2=_0x59ac78,_0x2533b9=Math[_0x13f7c2(0x1d3)]((Date['now']()-_0x47f31b)/0x3e8),_0x51628b=_0x5337ff['timeLimit']-_0x2533b9;if(_0x51628b<=0x0){clearInterval(timerInterval),gameTimerEl[_0x13f7c2(0x1f1)]=_0x13f7c2(0x210);if(isHost)forceEndGame();}else{const _0x1833e8=String(Math[_0x13f7c2(0x1d3)](_0x51628b/0x3c))[_0x13f7c2(0x169)](0x2,'0'),_0x1f19be=String(_0x51628b%0x3c)[_0x13f7c2(0x169)](0x2,'0');gameTimerEl[_0x13f7c2(0x1f1)]=_0x13f7c2(0x1c6)+_0x1833e8+':'+_0x1f19be;}},0x1f4);}function renderAdminGameView(){const _0x3c5c52=_0x1f61ea,_0x10df75=latestGameData;if(!_0x10df75||!_0x10df75[_0x3c5c52(0x13c)])return;setBoardSize(_0x10df75[_0x3c5c52(0x157)][_0x3c5c52(0x19c)]),targetNumberDisplay['textContent']='Sudoku\x20'+N+'×'+N,$(_0x3c5c52(0x21d))[_0x3c5c52(0x16d)][_0x3c5c52(0x18d)](_0x3c5c52(0x1d4)),hostControls[_0x3c5c52(0x16d)][_0x3c5c52(0x18d)]('hidden');const _0x405fa4=_0x10df75[_0x3c5c52(0x13c)]||{},_0x203679=Object[_0x3c5c52(0x1b3)](_0x405fa4)[_0x3c5c52(0x201)]((_0x2ff6c7,_0x33a498)=>{const _0x52b7ff=_0x3c5c52,_0x4811ad=_0x2ff6c7[0x1],_0x18e36d=_0x33a498[0x1];if((_0x4811ad['finishTime']?0x1:0x0)!==(_0x18e36d[_0x52b7ff(0x20c)]?0x1:0x0))return(_0x18e36d[_0x52b7ff(0x20c)]?0x1:0x0)-(_0x4811ad[_0x52b7ff(0x20c)]?0x1:0x0);if((_0x4811ad[_0x52b7ff(0x1f6)]||0x0)!==(_0x18e36d['score']||0x0))return(_0x18e36d['score']||0x0)-(_0x4811ad['score']||0x0);const _0x145e71=(allPlayerStates?.[_0x2ff6c7[0x0]]?.['board']||'')[_0x52b7ff(0x155)](',')[_0x52b7ff(0x204)](_0x571390=>_0x571390!=='0')[_0x52b7ff(0x1f8)],_0x58a90f=(allPlayerStates?.[_0x33a498[0x0]]?.['board']||'')[_0x52b7ff(0x155)](',')['filter'](_0x379c95=>_0x379c95!=='0')[_0x52b7ff(0x1f8)];return _0x58a90f-_0x145e71;});playerList[_0x3c5c52(0x1ff)]=_0x203679[_0x3c5c52(0x221)](([_0x294382,_0x7d78fb])=>{const _0x4e547e=_0x3c5c52,_0xd1e99f=allPlayerStates?.[_0x294382]?.[_0x4e547e(0x167)]||'',_0x4890e1=_0xd1e99f?_0xd1e99f[_0x4e547e(0x155)](',')[_0x4e547e(0x204)](_0x501887=>_0x501887!=='0'&&_0x501887!=='')['length']:0x0;let _0x1de653=_0x7d78fb[_0x4e547e(0x20c)]?_0x4e547e(0x15a):_0x4890e1+'/'+N*N;return _0x4e547e(0x148)+_0x294382+'</span><span\x20class=\x22player-progress\x22>'+(_0x7d78fb[_0x4e547e(0x1f6)]||0x0)+_0x4e547e(0x1ac)+_0x1de653+')</span></div>';})[_0x3c5c52(0x158)]('');const _0x87d014=_0x10df75[_0x3c5c52(0x175)];if(!_0x87d014)return;given=(_0x87d014[_0x3c5c52(0x156)]||[])[_0x3c5c52(0x1f3)](),board=given[_0x3c5c52(0x1f3)](),solution=(_0x87d014[_0x3c5c52(0x13e)]||[])['slice'](),selectedIdx=-0x1,renderSudoku(),$$(_0x3c5c52(0x1f2))['forEach'](_0x19a506=>_0x19a506[_0x3c5c52(0x1d8)]['pointerEvents']=_0x3c5c52(0x21e)),pickerEl[_0x3c5c52(0x16d)][_0x3c5c52(0x1ba)](_0x3c5c52(0x1d4)),$(_0x3c5c52(0x14c))[_0x3c5c52(0x16d)][_0x3c5c52(0x1ba)]('hidden'),$(_0x3c5c52(0x1cc))['classList'][_0x3c5c52(0x1ba)](_0x3c5c52(0x1d4));}function renderPlayerGameView(_0x98a2c2){const _0x3a4765=_0x1f61ea;$(_0x3a4765(0x21d))[_0x3a4765(0x16d)][_0x3a4765(0x1ba)](_0x3a4765(0x1d4));const _0x436d67=(_0x98a2c2[_0x3a4765(0x13c)]||{})[currentPlayerName];if(!_0x436d67)return;setBoardSize(_0x98a2c2[_0x3a4765(0x157)][_0x3a4765(0x19c)]),targetNumberDisplay[_0x3a4765(0x1f1)]=_0x3a4765(0x1f7)+N+'×'+N,playerScoreDisplay[_0x3a4765(0x1f1)]=_0x3a4765(0x1c7)+(_0x436d67['score']||0x0),playerScoreDisplay['classList'][_0x3a4765(0x18d)](_0x3a4765(0x1d4));const _0x11c7da=_0x98a2c2[_0x3a4765(0x175)];if(!_0x11c7da)return;given=(_0x11c7da[_0x3a4765(0x156)]||[])[_0x3a4765(0x1f3)](),solution=(_0x11c7da[_0x3a4765(0x13e)]||[])[_0x3a4765(0x1f3)](),board=given['slice'](),selectedIdx=board[_0x3a4765(0x197)]((_0x1c2f3c,_0x2a93a9)=>!given[_0x2a93a9]);if(selectedIdx<0x0)selectedIdx=0x0;_0x436d67[_0x3a4765(0x20c)]?(gameBoard['classList'][_0x3a4765(0x1ba)](_0x3a4765(0x1d4)),playerFinishedView[_0x3a4765(0x16d)][_0x3a4765(0x18d)](_0x3a4765(0x1d4))):(gameBoard[_0x3a4765(0x16d)]['remove'](_0x3a4765(0x1d4)),playerFinishedView[_0x3a4765(0x16d)][_0x3a4765(0x1ba)](_0x3a4765(0x1d4)),renderSudoku());}function renderGameOverView(_0x579b89){const _0x3d3efe=_0x1f61ea,_0x4a360f=_0x579b89[_0x3d3efe(0x208)],_0x313b40=$('#results-header');_0x4a360f?_0x313b40[_0x3d3efe(0x1ff)]=_0x3d3efe(0x184)+_0x4a360f+'!':_0x313b40[_0x3d3efe(0x1ff)]=_0x3d3efe(0x21c);const _0xa69fd9=_0x579b89[_0x3d3efe(0x13c)]||{},_0x14492d=Object['entries'](_0xa69fd9)[_0x3d3efe(0x201)](([,_0xca2b8b],[,_0x580588])=>{const _0x1499d1=_0x3d3efe;if((_0xca2b8b[_0x1499d1(0x1f6)]||0x0)!==(_0x580588[_0x1499d1(0x1f6)]||0x0))return(_0x580588['score']||0x0)-(_0xca2b8b[_0x1499d1(0x1f6)]||0x0);if(_0x580588[_0x1499d1(0x20c)]&&_0xca2b8b[_0x1499d1(0x20c)])return _0xca2b8b[_0x1499d1(0x20c)][_0x1499d1(0x1a0)]()-_0x580588[_0x1499d1(0x20c)][_0x1499d1(0x1a0)]();if(_0x580588['finishTime'])return 0x1;if(_0xca2b8b[_0x1499d1(0x20c)])return-0x1;return(_0x580588[_0x1499d1(0x1d9)]||0x0)-(_0xca2b8b[_0x1499d1(0x1d9)]||0x0);});podiumContainer[_0x3d3efe(0x1ff)]='',otherRankingsList[_0x3d3efe(0x1ff)]='';const _0x1decc1=_0x14492d[_0x3d3efe(0x1f3)](0x0,0x3),_0x249fd9=_0x14492d[_0x3d3efe(0x1f3)](0x3);_0x1decc1[_0x3d3efe(0x185)](([_0x1a42d9,_0x38a851],_0x3575e6)=>{const _0x51ca10=_0x3d3efe,_0x669737=_0x3575e6+0x1,_0x1952c0=document[_0x51ca10(0x1a6)](_0x51ca10(0x207));_0x1952c0[_0x51ca10(0x206)]='podium-stand\x20podium-'+_0x669737,_0x1952c0['innerHTML']=(_0x669737===0x1&&_0x4a360f?_0x51ca10(0x220):'')+_0x51ca10(0x1aa)+_0x1a42d9+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22player-score\x22>'+(_0x38a851[_0x51ca10(0x1f6)]||0x0)+_0x51ca10(0x195)+_0x669737+_0x51ca10(0x182),podiumContainer['appendChild'](_0x1952c0);});for(let _0x14a083=_0x14492d[_0x3d3efe(0x1f8)];_0x14a083<0x3;_0x14a083++){const _0x38babf=_0x14a083+0x1,_0x2aa579=document[_0x3d3efe(0x1a6)](_0x3d3efe(0x207));_0x2aa579['className']=_0x3d3efe(0x19a)+_0x38babf,podiumContainer['appendChild'](_0x2aa579);}if(_0x249fd9['length']>0x0)otherRankingsContainer[_0x3d3efe(0x16d)][_0x3d3efe(0x18d)](_0x3d3efe(0x1d4)),otherRankingsList[_0x3d3efe(0x1ff)]=_0x249fd9[_0x3d3efe(0x221)](([_0x1c287c,_0x135a85],_0x29d28d)=>_0x3d3efe(0x172)+(_0x29d28d+0x4)+'.\x20'+_0x1c287c+_0x3d3efe(0x13f)+(_0x135a85['score']||0x0)+_0x3d3efe(0x14a))[_0x3d3efe(0x158)]('');else otherRankingsContainer[_0x3d3efe(0x16d)][_0x3d3efe(0x1ba)](_0x3d3efe(0x1d4));if(isHost)$(_0x3d3efe(0x141))[_0x3d3efe(0x16d)][_0x3d3efe(0x18d)]('hidden');else $(_0x3d3efe(0x141))['classList']['add'](_0x3d3efe(0x1d4));showView(_0x3d3efe(0x203));}function renderPracticeGameOverView(){const _0x34bf54=_0x1f61ea,_0x4a9aa9=gameTimerEl['textContent']['replace'](_0x34bf54(0x1c6),''),_0x193467=_0x4a9aa9[_0x34bf54(0x155)](':'),_0x388988=parseInt(_0x193467[0x0],0xa)*0x3c+parseInt(_0x193467[0x1],0xa),_0x49ccff=gameSettings[_0x34bf54(0x1d0)]-_0x388988,_0x644a0b=String(Math[_0x34bf54(0x1d3)](_0x49ccff/0x3c))['padStart'](0x2,'0'),_0x41c3c6=String(_0x49ccff%0x3c)[_0x34bf54(0x169)](0x2,'0'),_0xbc0ed0=_0x644a0b+':'+_0x41c3c6;resultsHeader[_0x34bf54(0x1ff)]=_0x34bf54(0x1fb),podiumContainer[_0x34bf54(0x1ff)]=_0x34bf54(0x20a)+N+'×'+N+_0x34bf54(0x17d)+gameSettings[_0x34bf54(0x1c0)]+'</strong></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>เวลาที่ใช้:\x20<strong\x20class=\x22text-xl\x22\x20style=\x22color:\x20var(--accent);\x22>'+_0xbc0ed0+_0x34bf54(0x149),otherRankingsContainer[_0x34bf54(0x16d)][_0x34bf54(0x1ba)](_0x34bf54(0x1d4));const _0x4774ff=$('#back-to-lobby-btn');_0x4774ff[_0x34bf54(0x1f1)]=_0x34bf54(0x200),_0x4774ff['classList'][_0x34bf54(0x18d)]('hidden'),_0x4774ff[_0x34bf54(0x18b)]=()=>$(_0x34bf54(0x1cc))[_0x34bf54(0x150)](),showView(_0x34bf54(0x203));}let syncTimer=null;function scheduleBoardSync(){if(isPracticeMode||!currentGameId||!currentPlayerName)return;if(syncTimer)clearTimeout(syncTimer);syncTimer=setTimeout(async()=>{const _0x1d5fdc=_0x38b4;try{const _0x47cbec=doc(db,_0x1d5fdc(0x1d7),currentGameId,'playerStates',currentPlayerName);await updateDoc(_0x47cbec,{'board':board[_0x1d5fdc(0x158)](','),'hasMistake':hasMistake});}catch(_0x128cc7){console[_0x1d5fdc(0x1af)](_0x1d5fdc(0x17e),_0x128cc7);}},0x12c);}async function tryFinish(){const _0x594142=_0x1f61ea;if(!isSolved())return;if(isPracticeMode){if(timerInterval)clearInterval(timerInterval);const _0x4c502c=gameTimerEl[_0x594142(0x1f1)][_0x594142(0x15b)](_0x594142(0x1c6),''),_0x447a50=_0x4c502c[_0x594142(0x155)](':'),_0x13f018=parseInt(_0x447a50[0x0],0xa)*0x3c+parseInt(_0x447a50[0x1],0xa),_0x5c4f61=0x64+_0x13f018+(hasMistake?0x0:0x32);gameBoard[_0x594142(0x16d)]['add'](_0x594142(0x1d4)),playerFinishedView[_0x594142(0x16d)][_0x594142(0x18d)]('hidden'),$(_0x594142(0x1c1))[_0x594142(0x1f1)]=_0x594142(0x180),$(_0x594142(0x164))[_0x594142(0x1f1)]=_0x594142(0x212),$(_0x594142(0x1de))[_0x594142(0x1ff)]=_0x594142(0x1f0)+_0x5c4f61+_0x594142(0x182),setTimeout(renderPracticeGameOverView,0x7d0);return;}if(syncTimer)clearTimeout(syncTimer);const _0x388487=doc(db,_0x594142(0x1d7),currentGameId);try{await runTransaction(db,async _0x549cb4=>{const _0x522c49=_0x594142,_0x46be64=await _0x549cb4['get'](_0x388487);if(!_0x46be64[_0x522c49(0x20b)]())throw new Error(_0x522c49(0x16b));const _0x826c67=_0x46be64[_0x522c49(0x1ce)]();if(_0x826c67[_0x522c49(0x1e6)]!=='playing')return;const _0xb7f7d0=(_0x826c67[_0x522c49(0x13c)]||{})[currentPlayerName];if(!_0xb7f7d0||_0xb7f7d0[_0x522c49(0x20c)])return;const _0x3c8b1b=_0x826c67['startTime']['toMillis'](),_0x296e64=Math['floor']((Date['now']()-_0x3c8b1b)/0x3e8),_0x54e6ed=Math[_0x522c49(0x20e)](0x0,_0x826c67[_0x522c49(0x157)][_0x522c49(0x1d0)]-_0x296e64),_0x1737ce=0x64+_0x54e6ed+(hasMistake?0x0:0x32),_0xa671ce={};_0xa671ce[_0x522c49(0x190)+currentPlayerName+_0x522c49(0x18c)]=increment(_0x1737ce),_0xa671ce[_0x522c49(0x190)+currentPlayerName+_0x522c49(0x1db)]=serverTimestamp(),_0x826c67['gameMode'][_0x522c49(0x1a1)]===_0x522c49(0x222)&&(_0xa671ce[_0x522c49(0x1e6)]=_0x522c49(0x1a8),_0xa671ce['winner']=currentPlayerName),_0x549cb4['update'](_0x388487,_0xa671ce);});}catch(_0x134995){_0x134995[_0x594142(0x1da)]['includes'](_0x594142(0x20d))?toast(_0x594142(0x168)):(console['error'](_0x594142(0x144),_0x134995),toast('เกิดข้อผิดพลาดในการจบเกม'));}}function _0x38b4(_0x162249,_0x6f232c){const _0x372efe=_0x372e();return _0x38b4=function(_0x38b444,_0x351b42){_0x38b444=_0x38b444-0x13c;let _0x2b7687=_0x372efe[_0x38b444];return _0x2b7687;},_0x38b4(_0x162249,_0x6f232c);}$(_0x1f61ea(0x1ae))[_0x1f61ea(0x1ca)](_0x1f61ea(0x150),()=>showView(_0x1f61ea(0x1ee))),$(_0x1f61ea(0x171))[_0x1f61ea(0x1ca)](_0x1f61ea(0x150),()=>showView(_0x1f61ea(0x1e3))),$('#admin-login-btn')['addEventListener'](_0x1f61ea(0x150),async()=>{const _0x1ae305=_0x1f61ea;if($(_0x1ae305(0x1f4))[_0x1ae305(0x1be)]===_0x1ae305(0x188))await createGameRoom();else toast(_0x1ae305(0x1fe));}),$('#join-game-btn')[_0x1f61ea(0x1ca)]('click',handleJoinGame),$(_0x1f61ea(0x1ad))[_0x1f61ea(0x1ca)](_0x1f61ea(0x150),()=>{const _0x5c1976=_0x1f61ea;isPracticeMode=!![],isHost=!![],showView(_0x5c1976(0x13d)),$('#competition-settings')[_0x5c1976(0x16d)][_0x5c1976(0x1ba)](_0x5c1976(0x1d4)),$(_0x5c1976(0x152))[_0x5c1976(0x1ff)]=_0x5c1976(0x202);}),$(_0x1f61ea(0x142))['addEventListener'](_0x1f61ea(0x150),()=>{const _0x26f311=_0x1f61ea;isPracticeMode=![],showView('admin-settings'),$(_0x26f311(0x19d))['classList']['remove'](_0x26f311(0x1d4)),$('#start-game-btn')[_0x26f311(0x1ff)]='<i\x20class=\x22fas\x20fa-play\x20mr-2\x22></i>เริ่มแข่งขัน';}),$(_0x1f61ea(0x1c8))[_0x1f61ea(0x1ca)](_0x1f61ea(0x150),()=>{const _0x4cec3f=_0x1f61ea;isHost&&!currentGameId&&isPracticeMode?(isPracticeMode=![],isHost=![],showView('player-join')):showView(_0x4cec3f(0x191));}),$(_0x1f61ea(0x152))[_0x1f61ea(0x1ca)]('click',()=>{isPracticeMode?startPracticeGame():handleStartGame();}),$(_0x1f61ea(0x1a9))[_0x1f61ea(0x1ca)](_0x1f61ea(0x150),forceEndGame),$(_0x1f61ea(0x141))['addEventListener'](_0x1f61ea(0x150),returnToLobby),$('#home-btn')[_0x1f61ea(0x1ca)](_0x1f61ea(0x150),()=>{const _0x997a78=_0x1f61ea;if(unsubscribeGameListener)unsubscribeGameListener();unsubscribePlayerStateListener&&(unsubscribePlayerStateListener(),unsubscribePlayerStateListener=null);if(timerInterval)clearInterval(timerInterval);currentGameId=null,currentPlayerName=null,isHost=![],isPracticeMode=![],practicePuzzles=null,currentPracticeLevel=null,document['body'][_0x997a78(0x16d)][_0x997a78(0x18d)]('player-view'),showView(_0x997a78(0x1e3)),$('#player-finished-view\x20h2')[_0x997a78(0x1f1)]='เสร็จแล้ว!',$(_0x997a78(0x164))['textContent']=_0x997a78(0x181);}),$(_0x1f61ea(0x14c))[_0x1f61ea(0x1ca)](_0x1f61ea(0x150),()=>{for(let _0x585bd0=0x0;_0x585bd0<N*N;_0x585bd0++)board[_0x585bd0]=given[_0x585bd0];hasMistake=![],renderSudoku(),scheduleBoardSync();}),sudokuEl[_0x1f61ea(0x1ca)]('click',_0x112a17=>{const _0x5ee47d=_0x1f61ea,_0x8ab1a0=_0x112a17[_0x5ee47d(0x179)][_0x5ee47d(0x147)]('.cell');if(!_0x8ab1a0)return;const _0x2e8b07=parseInt(_0x8ab1a0['dataset'][_0x5ee47d(0x211)],0xa);if(!given[_0x2e8b07])selectCell(_0x2e8b07);}),$(_0x1f61ea(0x21d))['addEventListener'](_0x1f61ea(0x150),()=>{const _0x2f8522=_0x1f61ea;$(_0x2f8522(0x17c))[_0x2f8522(0x16d)][_0x2f8522(0x16e)]('sidebar-hidden');}),window[_0x1f61ea(0x1ca)]('beforeunload',()=>{isHost&&currentGameId&&deleteDoc(doc(db,'games',currentGameId));}),setBoardSize(0x4),initialize(),showView(_0x1f61ea(0x1e3));
