const _0x32a8ae=_0x5269;(function(_0xb4810b,_0x41f870){const _0x1538db=_0x5269,_0x548dff=_0xb4810b();while(!![]){try{const _0x473ec6=parseInt(_0x1538db(0x14f))/0x1+parseInt(_0x1538db(0x19e))/0x2*(parseInt(_0x1538db(0x180))/0x3)+parseInt(_0x1538db(0x1ec))/0x4*(parseInt(_0x1538db(0x139))/0x5)+-parseInt(_0x1538db(0x16a))/0x6+-parseInt(_0x1538db(0x1f3))/0x7*(-parseInt(_0x1538db(0x1e2))/0x8)+-parseInt(_0x1538db(0x146))/0x9+parseInt(_0x1538db(0x141))/0xa*(parseInt(_0x1538db(0x1bd))/0xb);if(_0x473ec6===_0x41f870)break;else _0x548dff['push'](_0x548dff['shift']());}catch(_0x4351a1){_0x548dff['push'](_0x548dff['shift']());}}}(_0x4841,0xae4e9));import{initializeApp}from'https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js';import{getAuth,signInAnonymously,onAuthStateChanged}from'https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js';import{getFirestore,doc,getDoc,setDoc,updateDoc,onSnapshot,serverTimestamp,runTransaction,deleteDoc,deleteField,increment,collection}from'https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js';const firebaseConfig={'apiKey':_0x32a8ae(0x13a),'authDomain':_0x32a8ae(0x1ed),'projectId':_0x32a8ae(0x179),'storageBucket':_0x32a8ae(0x1e5),'messagingSenderId':_0x32a8ae(0x1af),'appId':_0x32a8ae(0x21e),'measurementId':_0x32a8ae(0x1d7)},$=_0x10643c=>document['querySelector'](_0x10643c),$$=_0x4ec14e=>Array['from'](document['querySelectorAll'](_0x4ec14e)),playerJoinView=$(_0x32a8ae(0x1a3)),playerWaitView=$(_0x32a8ae(0x1f8)),adminLobbyView=$(_0x32a8ae(0x134)),gameView=$(_0x32a8ae(0x1f6)),adminLoginModal=$('#admin-login-modal'),adminSettingsModal=$(_0x32a8ae(0x188)),gameOverView=$('#game-over-view'),sudokuEl=$(_0x32a8ae(0x1fe)),pickerEl=$(_0x32a8ae(0x1a2)),playerList=$(_0x32a8ae(0x1c0)),lobbyPlayerNameList=$(_0x32a8ae(0x1ff)),lobbyPlayerCount=$('#lobby-player-count'),hostControls=$(_0x32a8ae(0x1e8)),toastEl=$(_0x32a8ae(0x1b7)),gameCodeDisplay=$(_0x32a8ae(0x1d9)),gameTimerEl=$('#game-timer'),puzzleProgressEl=$(_0x32a8ae(0x13f)),playerScoreDisplay=$(_0x32a8ae(0x201)),gameBoard=$(_0x32a8ae(0x190)),playerFinishedView=$('#player-finished-view'),podiumContainer=$('#podium-container'),otherRankingsList=$(_0x32a8ae(0x1c2)),otherRankingsContainer=$('#other-rankings-container'),targetNumberDisplay=$(_0x32a8ae(0x1e6));let db,auth,userId,currentPlayerName,isHost=![],currentGameId=null,unsubscribeGameListener=null,unsubscribePlayerStateListener=null,timerInterval=null,allPlayerStates={},unsubscribeAllPlayerStates=null,latestGameData={},previousGameStatus=null,isPracticeMode=![],practicePuzzles=null,currentPracticeLevel=null,given=new Array(0x10)[_0x32a8ae(0x171)](0x0),board=new Array(0x10)[_0x32a8ae(0x171)](0x0),solution=new Array(0x10)[_0x32a8ae(0x171)](0x0),selectedIdx=-0x1,hasMistake=![],gameSettings={'timeLimit':0x3c,'resultDisplayMode':_0x32a8ae(0x1f7),'difficulty':'medium','numQuestions':0x1};function toast(_0x57da98,_0x4165e9=0x7d0){const _0x78b004=_0x32a8ae;toastEl[_0x78b004(0x178)]=_0x57da98,toastEl[_0x78b004(0x1ab)][_0x78b004(0x148)](_0x78b004(0x170)),setTimeout(()=>toastEl[_0x78b004(0x1ab)][_0x78b004(0x21b)](_0x78b004(0x170)),_0x4165e9);}const rnd=(_0x33bb7c,_0x2b2cb1)=>Math[_0x32a8ae(0x189)](Math[_0x32a8ae(0x194)]()*(_0x2b2cb1-_0x33bb7c+0x1))+_0x33bb7c,themeKey=_0x32a8ae(0x167),themeSelect=$(_0x32a8ae(0x20b));function applyTheme(_0x16fb11){const _0x46a4d4=_0x32a8ae;document[_0x46a4d4(0x15e)][_0x46a4d4(0x1e3)](_0x46a4d4(0x1dd),_0x16fb11),localStorage['setItem'](themeKey,_0x16fb11);}const savedTheme=localStorage[_0x32a8ae(0x19c)](themeKey),initialTheme=savedTheme||_0x32a8ae(0x198);applyTheme(initialTheme);themeSelect&&themeSelect[_0x32a8ae(0x1da)](_0x32a8ae(0x19a),()=>applyTheme(themeSelect[_0x32a8ae(0x153)]));function baseSolved(){return[0x1,0x2,0x3,0x4,0x3,0x4,0x1,0x2,0x2,0x1,0x4,0x3,0x4,0x3,0x2,0x1];}function shuffle(_0x4e5e64){const _0x5776b6=_0x32a8ae;for(let _0x32d039=_0x4e5e64[_0x5776b6(0x169)]-0x1;_0x32d039>0x0;_0x32d039--){const _0x5774a0=Math[_0x5776b6(0x189)](Math['random']()*(_0x32d039+0x1));[_0x4e5e64[_0x32d039],_0x4e5e64[_0x5774a0]]=[_0x4e5e64[_0x5774a0],_0x4e5e64[_0x32d039]];}return _0x4e5e64;}function applyPermutations(_0x33d82c){const _0xfa4b69=_0x32a8ae;let _0x17b8a8=_0x33d82c[_0xfa4b69(0x1cc)]();const _0x2fc7ee=(_0x1a3d10,_0x35d37d)=>{for(let _0x2c4339=0x0;_0x2c4339<0x4;_0x2c4339++){const _0x2f0687=_0x1a3d10*0x4+_0x2c4339,_0x2f1cc0=_0x35d37d*0x4+_0x2c4339;[_0x17b8a8[_0x2f0687],_0x17b8a8[_0x2f1cc0]]=[_0x17b8a8[_0x2f1cc0],_0x17b8a8[_0x2f0687]];}},_0x1937e2=(_0x5008c3,_0xf1c458)=>{for(let _0x2e75c7=0x0;_0x2e75c7<0x4;_0x2e75c7++){const _0x3b5aa5=_0x2e75c7*0x4+_0x5008c3,_0x3bda21=_0x2e75c7*0x4+_0xf1c458;[_0x17b8a8[_0x3b5aa5],_0x17b8a8[_0x3bda21]]=[_0x17b8a8[_0x3bda21],_0x17b8a8[_0x3b5aa5]];}};if(Math['random']()<0.5)_0x2fc7ee(0x0,0x1);if(Math[_0xfa4b69(0x194)]()<0.5)_0x2fc7ee(0x2,0x3);if(Math[_0xfa4b69(0x194)]()<0.5)_0x1937e2(0x0,0x1);if(Math[_0xfa4b69(0x194)]()<0.5)_0x1937e2(0x2,0x3);if(Math['random']()<0.5)for(let _0x190d9c=0x0;_0x190d9c<0x4;_0x190d9c++){const _0x3375b9=0x0*0x4+_0x190d9c,_0x52673f=0x2*0x4+_0x190d9c;[_0x17b8a8[_0x3375b9],_0x17b8a8[_0x52673f]]=[_0x17b8a8[_0x52673f],_0x17b8a8[_0x3375b9]];const _0x14da0a=0x1*0x4+_0x190d9c,_0x30fd4e=0x3*0x4+_0x190d9c;[_0x17b8a8[_0x14da0a],_0x17b8a8[_0x30fd4e]]=[_0x17b8a8[_0x30fd4e],_0x17b8a8[_0x14da0a]];}if(Math['random']()<0.5)for(let _0x45d127=0x0;_0x45d127<0x4;_0x45d127++){const _0x20f2be=_0x45d127*0x4+0x0,_0x2d471d=_0x45d127*0x4+0x2;[_0x17b8a8[_0x20f2be],_0x17b8a8[_0x2d471d]]=[_0x17b8a8[_0x2d471d],_0x17b8a8[_0x20f2be]];const _0x5b6c71=_0x45d127*0x4+0x1,_0x437011=_0x45d127*0x4+0x3;[_0x17b8a8[_0x5b6c71],_0x17b8a8[_0x437011]]=[_0x17b8a8[_0x437011],_0x17b8a8[_0x5b6c71]];}const _0x4e83b9=[0x0,...shuffle([0x1,0x2,0x3,0x4])];for(let _0x24eb41=0x0;_0x24eb41<0x10;_0x24eb41++)_0x17b8a8[_0x24eb41]=_0x4e83b9[_0x17b8a8[_0x24eb41]];return _0x17b8a8;}function countSolutions(_0x18a890){const _0x420509=_0x32a8ae;let _0xfcf72f=_0x18a890[_0x420509(0x1cc)](),_0x50c750=0x0;function _0x5b6394(_0x27a492,_0x94a779){const _0x2ad611=Math['floor'](_0x27a492/0x4),_0x81409=_0x27a492%0x4;for(let _0x3a529b=0x0;_0x3a529b<0x4;_0x3a529b++){if(_0xfcf72f[_0x2ad611*0x4+_0x3a529b]===_0x94a779&&_0x3a529b!==_0x81409)return![];if(_0xfcf72f[_0x3a529b*0x4+_0x81409]===_0x94a779&&_0x3a529b!==_0x2ad611)return![];}const _0x3f23ee=Math['floor'](_0x2ad611/0x2)*0x2,_0x3f3260=Math['floor'](_0x81409/0x2)*0x2;for(let _0x340f7a=_0x3f23ee;_0x340f7a<_0x3f23ee+0x2;_0x340f7a++)for(let _0x180967=_0x3f3260;_0x180967<_0x3f3260+0x2;_0x180967++){const _0x1bcce0=_0x340f7a*0x4+_0x180967;if(_0x1bcce0!==_0x27a492&&_0xfcf72f[_0x1bcce0]===_0x94a779)return![];}return!![];}function _0x1a6cba(_0x3377a7=0x0){while(_0x3377a7<0x10&&_0xfcf72f[_0x3377a7]!==0x0)_0x3377a7++;if(_0x3377a7===0x10)return _0x50c750++,_0x50c750;for(let _0x37b3a8=0x1;_0x37b3a8<=0x4;_0x37b3a8++){if(_0x5b6394(_0x3377a7,_0x37b3a8)){_0xfcf72f[_0x3377a7]=_0x37b3a8,_0x1a6cba(_0x3377a7+0x1);if(_0x50c750>0x1)return _0x50c750;_0xfcf72f[_0x3377a7]=0x0;}}return _0x50c750;}return _0x1a6cba(0x0);}function makePuzzleByClues(_0x462319,_0x4338bf){const _0x9cf00d=_0x32a8ae;let _0x1e7a76=_0x462319[_0x9cf00d(0x1cc)]();const _0x4e091b=shuffle([...Array(0x10)[_0x9cf00d(0x157)]()]);let _0x11942f=0x0;for(const _0x2b5e0f of _0x4e091b){if(0x10-_0x11942f<=_0x4338bf)break;const _0x11fdb1=_0x1e7a76[_0x2b5e0f];_0x1e7a76[_0x2b5e0f]=0x0,countSolutions(_0x1e7a76)!==0x1?_0x1e7a76[_0x2b5e0f]=_0x11fdb1:_0x11942f++;}return _0x1e7a76;}function generateSudoku(_0x4218a5){const _0x4c1db7=applyPermutations(baseSolved());let _0x578188={'easy':[0x9,0xa],'medium':[0x7,0x8],'hard':[0x5,0x6]}[_0x4218a5]||[0x7,0x8];const _0x3e192f=rnd(_0x578188[0x0],_0x578188[0x1]);let _0x38e8b1=makePuzzleByClues(_0x4c1db7,_0x3e192f);if(countSolutions(_0x38e8b1)!==0x1)return generateSudoku(_0x4218a5);return{'solution':_0x4c1db7,'puzzle':_0x38e8b1};}function cellClasses(_0x1c9e1c){const _0x878ada=_0x32a8ae,_0xb84ff1=Math['floor'](_0x1c9e1c/0x4),_0x4a76c7=_0x1c9e1c%0x4,_0x24e9f0=[];if(_0x4a76c7===0x1)_0x24e9f0['push']('bR');if(_0xb84ff1===0x1)_0x24e9f0[_0x878ada(0x20d)]('bB');return _0x24e9f0[_0x878ada(0x16e)]('\x20');}function renderSudoku(){const _0x511605=_0x32a8ae;sudokuEl['innerHTML']='';for(let _0x5c2960=0x0;_0x5c2960<0x10;_0x5c2960++){const _0x42052a=board[_0x5c2960],_0x201dba=document['createElement']('div');_0x201dba['className']=_0x511605(0x159)+cellClasses(_0x5c2960)+'\x20'+(given[_0x5c2960]?'given':''),_0x201dba['dataset'][_0x511605(0x158)]=_0x5c2960,_0x201dba[_0x511605(0x178)]=_0x42052a?_0x42052a:'',!given[_0x5c2960]&&_0x201dba[_0x511605(0x1da)](_0x511605(0x166),()=>selectCell(_0x5c2960)),sudokuEl[_0x511605(0x1b6)](_0x201dba);}if(selectedIdx>=0x0)highlightRelatives(selectedIdx);markConflictsAll(),updateProgressText();}function selectCell(_0x245380){const _0x45dc18=_0x32a8ae;selectedIdx=_0x245380,$$(_0x45dc18(0x200))[_0x45dc18(0x1b1)](_0x15284d=>_0x15284d[_0x45dc18(0x1ab)][_0x45dc18(0x21b)](_0x45dc18(0x174),'hl'));const _0x1ad71e=$$(_0x45dc18(0x200))[_0x245380];_0x1ad71e[_0x45dc18(0x1ab)]['add'](_0x45dc18(0x174)),highlightRelatives(_0x245380);}function highlightRelatives(_0x35725c){const _0x59cb26=_0x32a8ae,_0x4c1956=Math[_0x59cb26(0x189)](_0x35725c/0x4),_0x14b360=_0x35725c%0x4;$$(_0x59cb26(0x200))['forEach']((_0x1e733f,_0x56399e)=>{const _0x52ce81=_0x59cb26,_0x242c46=Math[_0x52ce81(0x189)](_0x56399e/0x4),_0x52bac8=_0x56399e%0x4;(_0x242c46===_0x4c1956||_0x52bac8===_0x14b360||Math[_0x52ce81(0x189)](_0x242c46/0x2)===Math['floor'](_0x4c1956/0x2)&&Math[_0x52ce81(0x189)](_0x52bac8/0x2)===Math['floor'](_0x14b360/0x2))&&_0x1e733f[_0x52ce81(0x1ab)]['add']('hl');});}function setNumber(_0x553c66){const _0x31458b=_0x32a8ae;if(selectedIdx<0x0||given[selectedIdx])return;const _0x266ce9=$$(_0x31458b(0x200))[selectedIdx];_0x266ce9[_0x31458b(0x178)]=_0x553c66?_0x553c66:'',board[selectedIdx]=_0x553c66;_0x553c66!==0x0&&causesConflict(selectedIdx)&&(hasMistake=!![]);markConflictsAll(),updateProgressText(),scheduleBoardSync();if(isSolved())tryFinish();}function markConflictsAll(){const _0x2b3c54=_0x32a8ae;$$(_0x2b3c54(0x200))[_0x2b3c54(0x1b1)](_0x19516a=>_0x19516a[_0x2b3c54(0x1ab)][_0x2b3c54(0x21b)](_0x2b3c54(0x19d),'ok'));for(let _0x2d5668=0x0;_0x2d5668<0x10;_0x2d5668++){if(board[_0x2d5668]!==0x0&&causesConflict(_0x2d5668))$$(_0x2b3c54(0x200))[_0x2d5668][_0x2b3c54(0x1ab)]['add'](_0x2b3c54(0x19d));else board[_0x2d5668]!==0x0&&$$(_0x2b3c54(0x200))[_0x2d5668][_0x2b3c54(0x1ab)][_0x2b3c54(0x148)]('ok');}}function causesConflict(_0x39d496){const _0x3ba1d0=_0x32a8ae,_0xcf8f56=board[_0x39d496];if(_0xcf8f56===0x0)return![];const _0x187148=Math[_0x3ba1d0(0x189)](_0x39d496/0x4),_0x14e086=_0x39d496%0x4;for(let _0x1aba18=0x0;_0x1aba18<0x4;_0x1aba18++){if(_0x1aba18!==_0x14e086&&board[_0x187148*0x4+_0x1aba18]===_0xcf8f56)return!![];if(_0x1aba18!==_0x187148&&board[_0x1aba18*0x4+_0x14e086]===_0xcf8f56)return!![];}const _0x4bd0e5=Math['floor'](_0x187148/0x2)*0x2,_0x284739=Math[_0x3ba1d0(0x189)](_0x14e086/0x2)*0x2;for(let _0x4db01c=_0x4bd0e5;_0x4db01c<_0x4bd0e5+0x2;_0x4db01c++)for(let _0x43fa54=_0x284739;_0x43fa54<_0x284739+0x2;_0x43fa54++){const _0x3b0bc0=_0x4db01c*0x4+_0x43fa54;if(_0x3b0bc0!==_0x39d496&&board[_0x3b0bc0]===_0xcf8f56)return!![];}return![];}function isSolved(){for(let _0x5ce524=0x0;_0x5ce524<0x10;_0x5ce524++)if(board[_0x5ce524]!==solution[_0x5ce524])return![];return!![];}function updateProgressText(){const _0x49e9ea=_0x32a8ae,_0x3a2005=board[_0x49e9ea(0x209)](_0x374991=>_0x374991!==0x0)[_0x49e9ea(0x169)];puzzleProgressEl[_0x49e9ea(0x178)]=_0x49e9ea(0x135)+_0x3a2005+'/16';}pickerEl[_0x32a8ae(0x1da)](_0x32a8ae(0x166),_0x7ead77=>{const _0x3fa9cb=_0x32a8ae,_0x2107e0=_0x7ead77[_0x3fa9cb(0x18d)][_0x3fa9cb(0x13c)](_0x3fa9cb(0x210));if(!_0x2107e0)return;setNumber(parseInt(_0x2107e0[_0x3fa9cb(0x1bb)]['n'],0xa));}),document[_0x32a8ae(0x1da)](_0x32a8ae(0x150),_0x1ae510=>{const _0x253d70=_0x32a8ae;if(selectedIdx<0x0)return;_0x1ae510['key']>='1'&&_0x1ae510['key']<='4'&&setNumber(parseInt(_0x1ae510[_0x253d70(0x173)],0xa));(_0x1ae510[_0x253d70(0x173)]===_0x253d70(0x17a)||_0x1ae510[_0x253d70(0x173)]===_0x253d70(0x19b)||_0x1ae510[_0x253d70(0x173)]==='0')&&setNumber(0x0);const _0x12e2f3=Math[_0x253d70(0x189)](selectedIdx/0x4),_0x4a49d5=selectedIdx%0x4;if(_0x1ae510[_0x253d70(0x173)]===_0x253d70(0x1b2))selectCell(_0x12e2f3*0x4+Math['min'](_0x4a49d5+0x1,0x3));if(_0x1ae510[_0x253d70(0x173)]==='ArrowLeft')selectCell(_0x12e2f3*0x4+Math['max'](_0x4a49d5-0x1,0x0));if(_0x1ae510[_0x253d70(0x173)]===_0x253d70(0x203))selectCell(Math[_0x253d70(0x1b0)]((_0x12e2f3+0x1)*0x4+_0x4a49d5,0xf));if(_0x1ae510[_0x253d70(0x173)]===_0x253d70(0x15d))selectCell(Math['max']((_0x12e2f3-0x1)*0x4+_0x4a49d5,0x0));});function _0x5269(_0x2a56b8,_0x5e47ec){const _0x4841db=_0x4841();return _0x5269=function(_0x52696f,_0x28f438){_0x52696f=_0x52696f-0x133;let _0x1663c9=_0x4841db[_0x52696f];return _0x1663c9;},_0x5269(_0x2a56b8,_0x5e47ec);}async function initialize(){const _0x26073c=_0x32a8ae;try{const _0x4d96cc=initializeApp(firebaseConfig);db=getFirestore(_0x4d96cc),auth=getAuth(_0x4d96cc),onAuthStateChanged(auth,async _0x11ed94=>{!_0x11ed94&&await signInAnonymously(auth);});}catch(_0x533687){console[_0x26073c(0x1f5)](_0x26073c(0x1fd),_0x533687),toast('การเชื่อมต่อล้มเหลว');}}function showView(_0x507817){const _0x119d42=_0x32a8ae;[playerJoinView,playerWaitView,adminLoginModal,adminLobbyView,gameView,gameOverView,adminSettingsModal][_0x119d42(0x1b1)](_0x160c33=>_0x160c33[_0x119d42(0x1ab)][_0x119d42(0x148)](_0x119d42(0x15a)));const _0x41683c=$(_0x119d42(0x1f1));if(_0x507817==='player-join'||_0x507817==='admin-login')_0x41683c[_0x119d42(0x1ab)][_0x119d42(0x21b)](_0x119d42(0x15a));else isHost?_0x41683c['classList'][_0x119d42(0x21b)]('hidden'):_0x41683c[_0x119d42(0x1ab)][_0x119d42(0x148)]('hidden');if(_0x507817==='player-join')playerJoinView[_0x119d42(0x1ab)][_0x119d42(0x21b)](_0x119d42(0x15a));else{if(_0x507817===_0x119d42(0x181))playerWaitView[_0x119d42(0x1ab)][_0x119d42(0x21b)](_0x119d42(0x15a));else{if(_0x507817===_0x119d42(0x184))adminLoginModal[_0x119d42(0x1ab)][_0x119d42(0x21b)](_0x119d42(0x15a));else{if(_0x507817===_0x119d42(0x1cd))adminLobbyView[_0x119d42(0x1ab)]['remove']('hidden');else{if(_0x507817===_0x119d42(0x214))adminSettingsModal[_0x119d42(0x1ab)][_0x119d42(0x21b)]('hidden');else{if(_0x507817==='game')gameView[_0x119d42(0x1ab)][_0x119d42(0x21b)](_0x119d42(0x15a));else{if(_0x507817===_0x119d42(0x1b8))gameOverView['classList'][_0x119d42(0x21b)](_0x119d42(0x15a));}}}}}}}async function createGameRoom(){const _0x24284e=_0x32a8ae;isHost=!![],document[_0x24284e(0x1c7)][_0x24284e(0x1ab)][_0x24284e(0x21b)](_0x24284e(0x1d5)),showView(_0x24284e(0x1cd)),gameCodeDisplay[_0x24284e(0x178)]='...';const _0x5108aa=rnd(0xa,0x63)[_0x24284e(0x218)]();currentGameId=_0x5108aa;const _0x12c6dc={'hostId':auth[_0x24284e(0x16c)][_0x24284e(0x1c4)],'status':'lobby','players':{},'createdAt':serverTimestamp()};await setDoc(doc(db,_0x24284e(0x155),currentGameId),_0x12c6dc),gameCodeDisplay[_0x24284e(0x178)]=currentGameId,listenForGameUpdates(currentGameId);}async function handleStartGame(){const _0x2abed2=_0x32a8ae;if(!isHost||!currentGameId)return;gameSettings[_0x2abed2(0x136)]=document[_0x2abed2(0x1d1)]('input[name=\x22resultDisplayMode\x22]:checked')[_0x2abed2(0x153)],gameSettings[_0x2abed2(0x1c6)]=Math[_0x2abed2(0x1c9)](0xa,parseInt($(_0x2abed2(0x1ea))['value']||'60',0xa)),gameSettings[_0x2abed2(0x215)]=$('#difficulty-select')[_0x2abed2(0x153)];const _0x5bea5a=doc(db,_0x2abed2(0x155),currentGameId);try{await runTransaction(db,async _0x2fab5b=>{const _0x1860f2=_0x2abed2,_0x50cbc8=await _0x2fab5b[_0x1860f2(0x1f4)](_0x5bea5a);if(!_0x50cbc8[_0x1860f2(0x1a9)]())throw'Game\x20does\x20not\x20exist!';const _0x204bae=_0x50cbc8['data']()['players']||{},_0x1c435b={'status':_0x1860f2(0x1a8),'startTime':serverTimestamp(),'gameMode':gameSettings};if(gameSettings[_0x1860f2(0x215)]===_0x1860f2(0x16d)){gameSettings[_0x1860f2(0x175)]=0x3;const _0x2b9ea5=generateSudoku(_0x1860f2(0x1cb)),_0x523af4=generateSudoku('medium'),_0x544596=generateSudoku(_0x1860f2(0x17d));_0x1c435b[_0x1860f2(0x1e7)]={'easy':_0x2b9ea5,'medium':_0x523af4,'hard':_0x544596};}else gameSettings[_0x1860f2(0x175)]=0x1,_0x1c435b[_0x1860f2(0x1a6)]=generateSudoku(gameSettings[_0x1860f2(0x215)]);for(const _0x2b984f in _0x204bae){_0x1c435b[_0x1860f2(0x183)+_0x2b984f+_0x1860f2(0x186)]=0x0,_0x1c435b[_0x1860f2(0x183)+_0x2b984f+_0x1860f2(0x207)]=null,_0x1c435b[_0x1860f2(0x183)+_0x2b984f+'.filled']=0x0;const _0x59e467=doc(db,_0x1860f2(0x155),currentGameId,'playerStates',_0x2b984f);let _0x4ac5c0,_0x445e60;gameSettings[_0x1860f2(0x215)]===_0x1860f2(0x16d)?(_0x4ac5c0=_0x1c435b[_0x1860f2(0x1e7)]['easy']['puzzle'],_0x1c435b[_0x1860f2(0x183)+_0x2b984f+_0x1860f2(0x1c8)]=_0x1860f2(0x1cb)):_0x4ac5c0=_0x1c435b[_0x1860f2(0x1a6)]['puzzle'];_0x445e60=_0x4ac5c0[_0x1860f2(0x209)](_0x3dd568=>_0x3dd568!==0x0)[_0x1860f2(0x169)],_0x1c435b[_0x1860f2(0x183)+_0x2b984f+_0x1860f2(0x1c5)]=_0x445e60;const _0x211069={'board':_0x4ac5c0[_0x1860f2(0x16e)](''),'hasMistake':![]};_0x2fab5b[_0x1860f2(0x1ac)](_0x59e467,_0x211069);}_0x2fab5b[_0x1860f2(0x1ca)](_0x5bea5a,_0x1c435b);}),showView(_0x2abed2(0x176));}catch(_0x411c01){console[_0x2abed2(0x1f5)](_0x2abed2(0x221),_0x411c01),toast('เกิดข้อผิดพลาดในการเริ่มเกม');}}function startPracticeGame(){const _0xfba43a=_0x32a8ae;isPracticeMode=!![],gameSettings[_0xfba43a(0x1c6)]=Math[_0xfba43a(0x1c9)](0xa,parseInt($(_0xfba43a(0x1ea))[_0xfba43a(0x153)]||'60',0xa)),gameSettings[_0xfba43a(0x215)]=$(_0xfba43a(0x1f2))['value'],document[_0xfba43a(0x1c7)]['classList'][_0xfba43a(0x148)](_0xfba43a(0x1d5)),hostControls[_0xfba43a(0x1ab)]['add'](_0xfba43a(0x15a)),playerScoreDisplay[_0xfba43a(0x1ab)][_0xfba43a(0x148)](_0xfba43a(0x15a)),$(_0xfba43a(0x1fa))[_0xfba43a(0x1ab)]['add']('hidden');if(gameSettings[_0xfba43a(0x215)]===_0xfba43a(0x16d))practicePuzzles={'easy':generateSudoku(_0xfba43a(0x1cb)),'medium':generateSudoku(_0xfba43a(0x187)),'hard':generateSudoku('hard')},currentPracticeLevel=_0xfba43a(0x1cb),loadPracticePuzzle(currentPracticeLevel);else{practicePuzzles=null,currentPracticeLevel=gameSettings[_0xfba43a(0x215)];const _0x4a19f6=generateSudoku(gameSettings['difficulty']);given=_0x4a19f6[_0xfba43a(0x1d4)][_0xfba43a(0x1cc)](),board=_0x4a19f6['puzzle']['slice'](),solution=_0x4a19f6[_0xfba43a(0x196)][_0xfba43a(0x1cc)](),targetNumberDisplay[_0xfba43a(0x178)]=_0xfba43a(0x152)+gameSettings[_0xfba43a(0x215)];}hasMistake=![],selectedIdx=board['findIndex']((_0x1241bc,_0x31e2c5)=>!given[_0x31e2c5]);if(selectedIdx<0x0)selectedIdx=0x0;showView('game'),gameBoard[_0xfba43a(0x1ab)][_0xfba43a(0x21b)](_0xfba43a(0x15a)),playerFinishedView[_0xfba43a(0x1ab)][_0xfba43a(0x148)](_0xfba43a(0x15a)),pickerEl[_0xfba43a(0x1ab)][_0xfba43a(0x21b)](_0xfba43a(0x15a)),$(_0xfba43a(0x1c3))[_0xfba43a(0x1ab)][_0xfba43a(0x21b)]('hidden'),$(_0xfba43a(0x21c))['classList'][_0xfba43a(0x21b)](_0xfba43a(0x15a)),renderSudoku(),startPracticeTimer();}function loadPracticePuzzle(_0x1127a3){const _0x1f7ea8=_0x32a8ae,_0x36eda4=practicePuzzles[_0x1127a3];given=_0x36eda4[_0x1f7ea8(0x1d4)][_0x1f7ea8(0x1cc)](),board=_0x36eda4['puzzle']['slice'](),solution=_0x36eda4[_0x1f7ea8(0x196)][_0x1f7ea8(0x1cc)](),hasMistake=![],selectedIdx=board[_0x1f7ea8(0x172)]((_0x4db606,_0x8cc859)=>!given[_0x8cc859]);if(selectedIdx<0x0)selectedIdx=0x0;targetNumberDisplay[_0x1f7ea8(0x178)]=_0x1f7ea8(0x152)+_0x1127a3,renderSudoku();}function startPracticeTimer(){const _0x26a466=_0x32a8ae;if(timerInterval)clearInterval(timerInterval);let _0x4915ed=gameSettings[_0x26a466(0x1c6)];const _0x289d0c=()=>{const _0x4ef834=_0x26a466,_0x38f003=String(Math[_0x4ef834(0x189)](_0x4915ed/0x3c))[_0x4ef834(0x1e9)](0x2,'0'),_0x41ee3e=String(_0x4915ed%0x3c)['padStart'](0x2,'0');gameTimerEl[_0x4ef834(0x178)]=_0x4ef834(0x16b)+_0x38f003+':'+_0x41ee3e;};_0x289d0c(),timerInterval=setInterval(()=>{const _0x38e0c1=_0x26a466;_0x4915ed--,_0x289d0c(),_0x4915ed<=0x0&&(clearInterval(timerInterval),gameBoard[_0x38e0c1(0x1ab)][_0x38e0c1(0x148)](_0x38e0c1(0x15a)),playerFinishedView[_0x38e0c1(0x1ab)]['remove']('hidden'),$(_0x38e0c1(0x161))[_0x38e0c1(0x178)]='หมดเวลา!',$(_0x38e0c1(0x16f))['textContent']='ลองใหม่อีกครั้งนะ');},0x3e8);}async function forceEndGame(){const _0x4df7e3=_0x32a8ae;if(!isHost||!currentGameId)return;const _0x43bdee=doc(db,_0x4df7e3(0x155),currentGameId),_0x2384a2=await getDoc(_0x43bdee);_0x2384a2['exists']()&&_0x2384a2[_0x4df7e3(0x15c)]()[_0x4df7e3(0x204)]==='playing'&&await updateDoc(_0x43bdee,{'status':_0x4df7e3(0x1d6),'winner':null});}async function returnToLobby(){const _0x4f7b3e=_0x32a8ae;if(!isHost||!currentGameId)return;const _0x34bfae=doc(db,'games',currentGameId);try{await updateDoc(_0x34bfae,{'status':_0x4f7b3e(0x1ad),'players':{},'winner':deleteField(),'sudoku':deleteField(),'puzzles':deleteField(),'startTime':deleteField(),'gameMode':deleteField()}),showView(_0x4f7b3e(0x1cd));}catch(_0x145aeb){console[_0x4f7b3e(0x1f5)](_0x4f7b3e(0x17b),_0x145aeb),toast(_0x4f7b3e(0x18a));}}async function handleJoinGame(){const _0x565407=_0x32a8ae,_0x49216c=$(_0x565407(0x140))['value'],_0x4e5b1d=$(_0x565407(0x192))[_0x565407(0x153)][_0x565407(0x195)]();if(!_0x49216c||!_0x4e5b1d)return toast(_0x565407(0x14a));currentGameId=_0x49216c,currentPlayerName=_0x4e5b1d;const _0x1e78d8=doc(db,'games',currentGameId);try{await runTransaction(db,async _0x1e42c5=>{const _0x498a04=_0x565407,_0x2048c9=await _0x1e42c5[_0x498a04(0x1f4)](_0x1e78d8);if(!_0x2048c9[_0x498a04(0x1a9)]())throw new Error(_0x498a04(0x211));const _0x7550a2=_0x2048c9[_0x498a04(0x15c)]();if(_0x7550a2[_0x498a04(0x204)]!==_0x498a04(0x1ad))throw new Error(_0x498a04(0x13d));let _0x437c03=_0x4e5b1d;_0x7550a2['players']&&_0x7550a2[_0x498a04(0x197)][_0x437c03]&&(_0x437c03=''+_0x4e5b1d+rnd(0xa,0x63),toast(_0x498a04(0x219)+_0x437c03+_0x498a04(0x213))),currentPlayerName=_0x437c03,_0x1e42c5[_0x498a04(0x1ca)](_0x1e78d8,{[_0x498a04(0x183)+_0x437c03]:{'joined':!![]}});}),isHost=![],document[_0x565407(0x1c7)][_0x565407(0x1ab)][_0x565407(0x148)](_0x565407(0x1d5)),toast(_0x565407(0x156)),listenForGameUpdates(currentGameId);}catch(_0x2fcc00){console[_0x565407(0x1f5)](_0x565407(0x21d),_0x2fcc00),toast(_0x2fcc00[_0x565407(0x1db)]);}}function listenForGameUpdates(_0x269a52){const _0x1f394e=_0x32a8ae;if(unsubscribeGameListener)unsubscribeGameListener();const _0x337d31=doc(db,_0x1f394e(0x155),_0x269a52);unsubscribeGameListener=onSnapshot(_0x337d31,_0x12b985=>{const _0x390339=_0x1f394e;if(!_0x12b985['exists']()){toast(_0x390339(0x154));if(unsubscribeGameListener)unsubscribeGameListener();if(unsubscribePlayerStateListener)unsubscribePlayerStateListener();if(unsubscribeAllPlayerStates)unsubscribeAllPlayerStates();timerInterval&&(clearInterval(timerInterval),timerInterval=null);isHost=![],document[_0x390339(0x1c7)][_0x390339(0x1ab)][_0x390339(0x21b)](_0x390339(0x1d5)),showView(_0x390339(0x220));return;}const _0x35f364=_0x12b985['data']();latestGameData=_0x35f364;const _0x4b06f4=_0x35f364['status'];previousGameStatus==='playing'&&_0x4b06f4!==_0x390339(0x1a8)&&isHost&&(unsubscribeAllPlayerStates&&(unsubscribeAllPlayerStates(),unsubscribeAllPlayerStates=null));if(!isHost&&previousGameStatus===_0x390339(0x1d6)&&_0x4b06f4===_0x390339(0x1ad)){if(unsubscribeGameListener)unsubscribeGameListener();if(unsubscribePlayerStateListener)unsubscribePlayerStateListener();unsubscribePlayerStateListener=null;if(timerInterval)clearInterval(timerInterval);currentGameId=null,currentPlayerName=null,toast(_0x390339(0x1e1)),document[_0x390339(0x1c7)][_0x390339(0x1ab)][_0x390339(0x21b)](_0x390339(0x1d5)),showView(_0x390339(0x220)),previousGameStatus=null;return;}previousGameStatus=_0x4b06f4;if(_0x4b06f4===_0x390339(0x1ad)){timerInterval&&(clearInterval(timerInterval),timerInterval=null);if(unsubscribePlayerStateListener)unsubscribePlayerStateListener();unsubscribePlayerStateListener=null;if(isHost)showView(_0x390339(0x1cd)),renderLobbyPlayers(_0x35f364['players']);else showView('player-wait');}else{if(_0x4b06f4===_0x390339(0x1a8)){startOrUpdateTimer(_0x35f364),showView(_0x390339(0x176));if(isHost){if(!unsubscribeAllPlayerStates){const _0x4a4e50=collection(db,_0x390339(0x155),_0x269a52,_0x390339(0x1cf));unsubscribeAllPlayerStates=onSnapshot(_0x4a4e50,_0x31a850=>{const _0x3bf874=_0x390339;_0x31a850[_0x3bf874(0x1b4)][_0x3bf874(0x1b1)](_0x2fc06a=>{const _0x565d1e=_0x3bf874;allPlayerStates[_0x2fc06a['id']]=_0x2fc06a[_0x565d1e(0x15c)]();}),renderAdminGameView();});}renderAdminGameView();if(_0x35f364[_0x390339(0x15b)][_0x390339(0x136)]===_0x390339(0x1ef)){const _0x1e30a6=Object[_0x390339(0x1f9)](_0x35f364[_0x390339(0x197)]||{});_0x1e30a6[_0x390339(0x169)]>0x0&&_0x1e30a6[_0x390339(0x144)](_0x5c2fb5=>_0x5c2fb5[_0x390339(0x199)])&&forceEndGame();}}else renderPlayerGameView(_0x35f364),listenForPlayerState(_0x269a52,currentPlayerName);}else{if(_0x4b06f4===_0x390339(0x1d6)){timerInterval&&(clearInterval(timerInterval),timerInterval=null);if(unsubscribePlayerStateListener)unsubscribePlayerStateListener();renderGameOverView(_0x35f364);}}}});}function listenForPlayerState(_0x3d3998,_0x398828){const _0x3da135=_0x32a8ae;if(unsubscribePlayerStateListener)return;const _0x4b3580=doc(db,_0x3da135(0x155),_0x3d3998,'playerStates',_0x398828);unsubscribePlayerStateListener=onSnapshot(_0x4b3580,_0x56a37d=>{const _0x423fe0=_0x3da135;if(_0x56a37d[_0x423fe0(0x1a9)]()){const _0xb8bed7=_0x56a37d[_0x423fe0(0x15c)]();board=(_0xb8bed7[_0x423fe0(0x1c1)]||'')[_0x423fe0(0x182)]('')[_0x423fe0(0x222)](_0x482369=>parseInt(_0x482369,0xa)||0x0),hasMistake=!!_0xb8bed7[_0x423fe0(0x163)],renderSudoku();}});}function _0x4841(){const _0x4962dc=['ฝึกซ้อม:\x20','value','ห้องเกมถูกปิดแล้ว','games','เข้าร่วมสำเร็จ!\x20รอสักครู่...','keys','idx','cell\x20','hidden','gameMode','data','ArrowUp','documentElement','เกิดข้อผิดพลาดในการจบเกม','<i\x20class=\x22fas\x20fa-crown\x22></i>','#player-finished-view\x20h2','sort','hasMistake','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22player-name\x22>','createElement','click','g24_theme_mp','beforeunload','length','4740942oKtfrV','เวลา:\x20','currentUser','mixed','join','#player-finished-view\x20p','show','fill','findIndex','key','selected','numQuestions','game','</span><span>','textContent','game24-69666','Backspace','Error\x20returning\x20to\x20lobby:','กลับไปหน้าแรก','hard','</strong></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','เกมจบแล้ว\x20มีผู้ชนะแล้ว!','384546jVTdux','player-wait','split','players.','admin-login','#back-to-lobby-btn','.score','medium','#admin-settings-modal','floor','เกิดข้อผิดพลาดในการกลับสู่ล็อบบี้','style','currentLevel','target','podium-stand\x20podium-','\x20คะแนน\x20(','#game-board','Game\x20not\x20found','#player-name-input','onclick','random','trim','solution','players','contrast','finishTime','change','Delete','getItem','conflict','10tUSpCB','รอผลการแข่งขันสักครู่...','เยี่ยม!\x20ด่านต่อไป:\x20ปานกลาง','<div\x20class=\x22player-row\x22><span\x20class=\x22player-name\x22>','#picker','#player-join-view','/16)','<i\x20class=\x22fas\x20fa-play\x20mr-2\x22></i>เริ่มฝึกซ้อม','sudoku','filled','playing','exists','#cancel-settings-btn','classList','set','lobby','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22text-lg\x20mt-4\x22>คะแนนรอบนี้:</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22text-4xl\x20font-bold\x22\x20style=\x22color:\x20var(--accent);\x22>','989271279576','min','forEach','ArrowRight','.app','docs','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22player-score\x22>','appendChild','#toast','game-over','#results-header','#admin-back-btn','dataset','#sudoku\x20.cell','11Qyinnc','#start-practice-btn','<i\x20class=\x22fas\x20fa-check-circle\x20mr-2\x22></i>ฝึกซ้อมสำเร็จ!','#player-list','board','#other-rankings-list','#reset-btn','uid','.filled','timeLimit','body','.currentLevel','max','update','easy','slice','admin-lobby','startTime','playerStates','className','querySelector','#start-game-btn','คะแนน:\x20','puzzle','player-view','finished','G-B1ZTE90SGG','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22text-center\x20text-lg\x20space-y-4\x20my-8\x20p-6\x20rounded-lg\x22\x20style=\x22background:\x20var(--card-bg);\x20border:\x202px\x20solid\x20var(--card-border);\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>ความยาก:\x20<strong\x20class=\x22text-xl\x22\x20style=\x22color:\x20var(--accent);\x22>','#game-code-display','addEventListener','message','winner','data-theme','#join-game-btn','#admin-password-input','includes','แอดมินได้สร้างห้องใหม่แล้ว','8eiXjEL','setAttribute',')</span></div>','game24-69666.firebasestorage.app','#target-number-display','puzzles','#host-controls','padStart','#time-limit-input','pointerEvents','1132916YRrybc','game24-69666.firebaseapp.com','<i\x20class=\x22fas\x20fa-crown\x20mr-2\x22></i>ผู้ชนะคือ\x20','wait','#competition-settings','#admin-icon-btn','#difficulty-select','35385sYuhza','get','error','#game-view','immediate','#player-wait-view','values','#toggle-sidebar-btn','toMillis','เยี่ยมมาก!','Firebase\x20init\x20failed:','#sudoku','#lobby-player-name-list','.cell','#player-score-display','</strong></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>เวลาที่ใช้:\x20<strong\x20class=\x22text-xl\x22\x20style=\x22color:\x20var(--accent);\x22>','ArrowDown','status','เสร็จแล้ว!','score','.finishTime','log','filter','#practice-score-display','#themeSelect','board\x20sync\x20failed','push','<p\x20class=\x22text-gray-500\x20text-center\x20w-full\x22>ยังไม่มีใครเข้าร่วม...</p>','</span><span\x20class=\x22player-progress\x22>','.pick','ไม่พบห้องเกมนี้','innerHTML','\x20แทน','admin-settings','difficulty','<li><span>','<i\x20class=\x22fas\x20fa-play\x20mr-2\x22></i>เริ่มแข่งขัน','toString','ชื่อซ้ำ,\x20เปลี่ยนเป็น\x20','entries','remove','#home-btn','Error\x20joining\x20game:','1:989271279576:web:43115bbaeeae31160954ad','replace','player-join','Error\x20starting\x20game:','map','<i\x20class=\x22fas\x20fa-trophy\x20mr-2\x22></i>หมดเวลา!','#admin-lobby-view','เติมแล้ว\x20','resultDisplayMode','now','เสร็จแล้ว','15tMSgaJ','AIzaSyAJsk4l8I8uCYpJY8jZLAlRW1w2qLWN-2o','สุดยอด!\x20ด่านต่อไป:\x20ยาก','closest','ไม่สามารถเข้าร่วมได้\x20เกมเริ่มไปแล้ว','Sudoku\x204x4','#puzzle-progress','#game-code-input','8743230fOwDtc','indexOf','เวลา:\x2000:00','every','toggle','8743761GZbPFa','sidebar-hidden','add','aborted','กรุณากรอกข้อมูลให้ครบถ้วน','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','รหัสผ่านไม่ถูกต้อง','/16','</div>','105672FlQhVx','keydown','warn'];_0x4841=function(){return _0x4962dc;};return _0x4841();}function renderLobbyPlayers(_0x49587a){const _0x44ef2f=_0x32a8ae,_0x575d7e=Object[_0x44ef2f(0x157)](_0x49587a||{});lobbyPlayerCount['textContent']=_0x575d7e[_0x44ef2f(0x169)],lobbyPlayerNameList[_0x44ef2f(0x212)]=_0x575d7e[_0x44ef2f(0x169)]===0x0?_0x44ef2f(0x20e):_0x575d7e[_0x44ef2f(0x222)](_0x48dae1=>'<div\x20class=\x22lobby-player-tag\x22>'+_0x48dae1+_0x44ef2f(0x14e))[_0x44ef2f(0x16e)]('');}function startOrUpdateTimer(_0x57869c){const _0x36634a=_0x32a8ae;if(timerInterval)clearInterval(timerInterval);const _0x1dc7d2=_0x57869c['gameMode']||gameSettings,_0x5ca88e=_0x57869c[_0x36634a(0x1ce)][_0x36634a(0x1fb)]();timerInterval=setInterval(()=>{const _0x498fb6=_0x36634a,_0x10e89d=Math[_0x498fb6(0x189)]((Date[_0x498fb6(0x137)]()-_0x5ca88e)/0x3e8),_0x210aa7=_0x1dc7d2[_0x498fb6(0x1c6)]-_0x10e89d;if(_0x210aa7<=0x0){clearInterval(timerInterval),gameTimerEl['textContent']=_0x498fb6(0x143);if(isHost)forceEndGame();}else{const _0x2850b6=String(Math[_0x498fb6(0x189)](_0x210aa7/0x3c))[_0x498fb6(0x1e9)](0x2,'0'),_0x50068f=String(_0x210aa7%0x3c)['padStart'](0x2,'0');gameTimerEl[_0x498fb6(0x178)]='เวลา:\x20'+_0x2850b6+':'+_0x50068f;}},0x1f4);}function renderAdminGameView(){const _0x2d3538=_0x32a8ae,_0x22316a=latestGameData;if(!_0x22316a||!_0x22316a[_0x2d3538(0x197)])return;$(_0x2d3538(0x1fa))[_0x2d3538(0x1ab)]['remove']('hidden'),hostControls[_0x2d3538(0x1ab)][_0x2d3538(0x21b)](_0x2d3538(0x15a));const _0x2fb275=_0x22316a[_0x2d3538(0x197)]||{},_0x4cbd5c=Object[_0x2d3538(0x21a)](_0x2fb275)['sort']((_0x5eba1f,_0x1d50b8)=>{const _0x457b2d=_0x2d3538,_0x1e38cc=_0x5eba1f[0x1],_0x2cf5da=_0x1d50b8[0x1];if((_0x1e38cc[_0x457b2d(0x199)]?0x1:0x0)!==(_0x2cf5da[_0x457b2d(0x199)]?0x1:0x0))return(_0x2cf5da[_0x457b2d(0x199)]?0x1:0x0)-(_0x1e38cc[_0x457b2d(0x199)]?0x1:0x0);if((_0x1e38cc[_0x457b2d(0x206)]||0x0)!==(_0x2cf5da['score']||0x0))return(_0x2cf5da[_0x457b2d(0x206)]||0x0)-(_0x1e38cc[_0x457b2d(0x206)]||0x0);const _0x16088b=(allPlayerStates?.[_0x5eba1f[0x0]]?.['board']||'')[_0x457b2d(0x21f)](/0/g,'')[_0x457b2d(0x169)],_0x336655=(allPlayerStates?.[_0x1d50b8[0x0]]?.['board']||'')['replace'](/0/g,'')[_0x457b2d(0x169)];return _0x336655-_0x16088b;});playerList[_0x2d3538(0x212)]=_0x4cbd5c[_0x2d3538(0x222)](([_0x4195e7,_0x558b53])=>{const _0x4e0a5a=_0x2d3538,_0x272b3e=(allPlayerStates?.[_0x4195e7]?.[_0x4e0a5a(0x1c1)]||'')[_0x4e0a5a(0x21f)](/0/g,'')[_0x4e0a5a(0x169)];let _0x54a6dd=_0x272b3e+_0x4e0a5a(0x14d);if(_0x558b53[_0x4e0a5a(0x199)])_0x54a6dd=_0x4e0a5a(0x138);else _0x22316a[_0x4e0a5a(0x15b)]['difficulty']==='mixed'&&(_0x54a6dd='ด่าน\x20'+(_0x558b53[_0x4e0a5a(0x18c)]||_0x4e0a5a(0x1cb))+'\x20('+_0x272b3e+_0x4e0a5a(0x1a4));return _0x4e0a5a(0x1a1)+_0x4195e7+_0x4e0a5a(0x20f)+(_0x558b53['score']||0x0)+_0x4e0a5a(0x18f)+_0x54a6dd+_0x4e0a5a(0x1e4);})[_0x2d3538(0x16e)]('');let _0x345170;if(_0x22316a[_0x2d3538(0x15b)]['difficulty']==='mixed'){const _0x4e378a=['easy',_0x2d3538(0x187),_0x2d3538(0x17d)];let _0x404288='easy';const _0x331efa=Object[_0x2d3538(0x1f9)](_0x2fb275);for(const _0x5bcba6 of _0x331efa){if(_0x5bcba6[_0x2d3538(0x199)])continue;const _0x4fd801=_0x5bcba6['currentLevel']||_0x2d3538(0x1cb);_0x4e378a[_0x2d3538(0x142)](_0x4fd801)>_0x4e378a[_0x2d3538(0x142)](_0x404288)&&(_0x404288=_0x4fd801);}_0x345170=_0x22316a[_0x2d3538(0x1e7)]?_0x22316a[_0x2d3538(0x1e7)][_0x404288]:null;}else _0x345170=_0x22316a['sudoku'];if(!_0x345170)return;const _0x1c70ff=_0x345170[_0x2d3538(0x1d4)]||[];given=_0x1c70ff['slice'](),board=_0x1c70ff[_0x2d3538(0x1cc)](),solution=_0x345170[_0x2d3538(0x196)]||[],selectedIdx=-0x1,renderSudoku(),$$(_0x2d3538(0x1bc))[_0x2d3538(0x1b1)](_0x10fc36=>_0x10fc36[_0x2d3538(0x18b)][_0x2d3538(0x1eb)]='none'),pickerEl[_0x2d3538(0x1ab)]['add'](_0x2d3538(0x15a)),$(_0x2d3538(0x1c3))[_0x2d3538(0x1ab)]['add'](_0x2d3538(0x15a)),$(_0x2d3538(0x21c))['classList'][_0x2d3538(0x148)](_0x2d3538(0x15a));}function renderPlayerGameView(_0x1242e6){const _0x561b32=_0x32a8ae;$(_0x561b32(0x1fa))['classList'][_0x561b32(0x148)](_0x561b32(0x15a));const _0x25cf53=(_0x1242e6[_0x561b32(0x197)]||{})[currentPlayerName];if(!_0x25cf53)return;playerScoreDisplay['textContent']=_0x561b32(0x1d3)+(_0x25cf53['score']||0x0),playerScoreDisplay['classList'][_0x561b32(0x21b)](_0x561b32(0x15a));let _0x2710f0;if(_0x1242e6[_0x561b32(0x15b)]['difficulty']===_0x561b32(0x16d)){const _0x231de3=_0x25cf53['currentLevel']||_0x561b32(0x1cb);_0x2710f0=_0x1242e6[_0x561b32(0x1e7)][_0x231de3],targetNumberDisplay['textContent']='ด่าน\x20'+_0x231de3;}else _0x2710f0=_0x1242e6[_0x561b32(0x1a6)],targetNumberDisplay[_0x561b32(0x178)]=_0x561b32(0x13e);if(!_0x2710f0)return;given=(_0x2710f0[_0x561b32(0x1d4)]||[])[_0x561b32(0x1cc)](),solution=(_0x2710f0['solution']||[])[_0x561b32(0x1cc)](),selectedIdx=board['findIndex']((_0x2c504c,_0x1f4126)=>!given[_0x1f4126]);if(selectedIdx<0x0)selectedIdx=0x0;_0x25cf53['finishTime']?(gameBoard['classList'][_0x561b32(0x148)](_0x561b32(0x15a)),playerFinishedView[_0x561b32(0x1ab)]['remove'](_0x561b32(0x15a))):(gameBoard[_0x561b32(0x1ab)]['remove'](_0x561b32(0x15a)),playerFinishedView[_0x561b32(0x1ab)][_0x561b32(0x148)](_0x561b32(0x15a)));}function renderGameOverView(_0xa15f06){const _0xe8ea67=_0x32a8ae,_0x413941=_0xa15f06[_0xe8ea67(0x1dc)],_0xd328f6=$(_0xe8ea67(0x1b9));_0x413941?_0xd328f6[_0xe8ea67(0x212)]=_0xe8ea67(0x1ee)+_0x413941+'!':_0xd328f6['innerHTML']=_0xe8ea67(0x133);const _0x572ea7=_0xa15f06['players']||{},_0x70f63a=Object['entries'](_0x572ea7)[_0xe8ea67(0x162)](([,_0x11cfb4],[,_0x42547d])=>{const _0x19fdc9=_0xe8ea67;if((_0x11cfb4[_0x19fdc9(0x206)]||0x0)!==(_0x42547d[_0x19fdc9(0x206)]||0x0))return(_0x42547d['score']||0x0)-(_0x11cfb4[_0x19fdc9(0x206)]||0x0);if(_0x42547d['finishTime']&&_0x11cfb4['finishTime'])return _0x11cfb4[_0x19fdc9(0x199)][_0x19fdc9(0x1fb)]()-_0x42547d[_0x19fdc9(0x199)][_0x19fdc9(0x1fb)]();if(_0x42547d[_0x19fdc9(0x199)])return 0x1;if(_0x11cfb4['finishTime'])return-0x1;return(_0x42547d[_0x19fdc9(0x1a7)]||0x0)-(_0x11cfb4[_0x19fdc9(0x1a7)]||0x0);});podiumContainer[_0xe8ea67(0x212)]='',otherRankingsList['innerHTML']='';const _0x2ae1bf=_0x70f63a[_0xe8ea67(0x1cc)](0x0,0x3),_0x408167=_0x70f63a[_0xe8ea67(0x1cc)](0x3);_0x2ae1bf[_0xe8ea67(0x1b1)](([_0x4bef80,_0x2205b2],_0x33344b)=>{const _0x16a51f=_0xe8ea67,_0x157f90=_0x33344b+0x1,_0xbeec18=document[_0x16a51f(0x165)]('div');_0xbeec18['className']=_0x16a51f(0x18e)+_0x157f90,_0xbeec18[_0x16a51f(0x212)]=(_0x157f90===0x1&&_0x413941?_0x16a51f(0x160):'')+_0x16a51f(0x164)+_0x4bef80+_0x16a51f(0x1b5)+(_0x2205b2[_0x16a51f(0x206)]||0x0)+'\x20คะแนน</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22rank\x22>'+_0x157f90+_0x16a51f(0x14e),podiumContainer[_0x16a51f(0x1b6)](_0xbeec18);});for(let _0x39f903=_0x70f63a[_0xe8ea67(0x169)];_0x39f903<0x3;_0x39f903++){const _0x1fc72c=_0x39f903+0x1,_0x297135=document[_0xe8ea67(0x165)]('div');_0x297135[_0xe8ea67(0x1d0)]=_0xe8ea67(0x18e)+_0x1fc72c,podiumContainer[_0xe8ea67(0x1b6)](_0x297135);}if(_0x408167[_0xe8ea67(0x169)]>0x0)otherRankingsContainer[_0xe8ea67(0x1ab)][_0xe8ea67(0x21b)]('hidden'),otherRankingsList[_0xe8ea67(0x212)]=_0x408167[_0xe8ea67(0x222)](([_0x502c15,_0x597047],_0x5df940)=>_0xe8ea67(0x216)+(_0x5df940+0x4)+'.\x20'+_0x502c15+_0xe8ea67(0x177)+(_0x597047['score']||0x0)+'\x20คะแนน</span></li>')[_0xe8ea67(0x16e)]('');else otherRankingsContainer['classList'][_0xe8ea67(0x148)]('hidden');if(isHost)$(_0xe8ea67(0x185))['classList'][_0xe8ea67(0x21b)]('hidden');else $(_0xe8ea67(0x185))[_0xe8ea67(0x1ab)][_0xe8ea67(0x148)](_0xe8ea67(0x15a));showView(_0xe8ea67(0x1b8));}function renderPracticeGameOverView(){const _0x1aece3=_0x32a8ae,_0x1ca263=gameTimerEl[_0x1aece3(0x178)][_0x1aece3(0x21f)](_0x1aece3(0x16b),''),_0x49ec92=_0x1ca263[_0x1aece3(0x182)](':'),_0x44d4c9=parseInt(_0x49ec92[0x0],0xa)*0x3c+parseInt(_0x49ec92[0x1],0xa),_0x4dcedf=gameSettings[_0x1aece3(0x1c6)]-_0x44d4c9,_0x4bd8f0=String(Math['floor'](_0x4dcedf/0x3c))[_0x1aece3(0x1e9)](0x2,'0'),_0x1064f2=String(_0x4dcedf%0x3c)['padStart'](0x2,'0'),_0x462f24=_0x4bd8f0+':'+_0x1064f2;resultsHeader[_0x1aece3(0x212)]=_0x1aece3(0x1bf),podiumContainer[_0x1aece3(0x212)]=_0x1aece3(0x1d8)+gameSettings[_0x1aece3(0x215)]+_0x1aece3(0x202)+_0x462f24+_0x1aece3(0x17e),otherRankingsContainer[_0x1aece3(0x1ab)][_0x1aece3(0x148)](_0x1aece3(0x15a));const _0x2b030f=$(_0x1aece3(0x185));_0x2b030f[_0x1aece3(0x178)]=_0x1aece3(0x17c),_0x2b030f[_0x1aece3(0x1ab)][_0x1aece3(0x21b)](_0x1aece3(0x15a)),_0x2b030f[_0x1aece3(0x193)]=()=>$('#home-btn')['click'](),showView(_0x1aece3(0x1b8));}let syncTimer=null;function scheduleBoardSync(){if(isPracticeMode||!currentGameId||!currentPlayerName)return;if(syncTimer)clearTimeout(syncTimer);syncTimer=setTimeout(async()=>{const _0x20c879=_0x5269;try{const _0x115a2a=doc(db,_0x20c879(0x155),currentGameId,_0x20c879(0x1cf),currentPlayerName);await updateDoc(_0x115a2a,{'board':board[_0x20c879(0x16e)](''),'hasMistake':hasMistake});}catch(_0x326820){console[_0x20c879(0x151)](_0x20c879(0x20c),_0x326820);}},0xc8);}async function tryFinish(){const _0x1cc709=_0x32a8ae;if(isPracticeMode){if(!isSolved())return;const _0x119200=gameTimerEl[_0x1cc709(0x178)][_0x1cc709(0x21f)](_0x1cc709(0x16b),''),_0x1ce48c=_0x119200[_0x1cc709(0x182)](':'),_0x54d50a=parseInt(_0x1ce48c[0x0],0xa)*0x3c+parseInt(_0x1ce48c[0x1],0xa),_0x1d32ec=0x64+_0x54d50a+(hasMistake?0x0:0x32);if(gameSettings['difficulty']===_0x1cc709(0x16d)){if(currentPracticeLevel===_0x1cc709(0x1cb)){currentPracticeLevel=_0x1cc709(0x187),toast(_0x1cc709(0x1a0),0x9c4),loadPracticePuzzle('medium');return;}else{if(currentPracticeLevel===_0x1cc709(0x187)){currentPracticeLevel='hard',toast(_0x1cc709(0x13b),0x9c4),loadPracticePuzzle(_0x1cc709(0x17d));return;}}}if(timerInterval)clearInterval(timerInterval);gameBoard[_0x1cc709(0x1ab)]['add'](_0x1cc709(0x15a)),playerFinishedView['classList'][_0x1cc709(0x21b)](_0x1cc709(0x15a)),$(_0x1cc709(0x161))[_0x1cc709(0x178)]=_0x1cc709(0x1fc),$('#player-finished-view\x20p')[_0x1cc709(0x178)]='คุณไขปริศนาสำเร็จ',$(_0x1cc709(0x20a))[_0x1cc709(0x212)]=_0x1cc709(0x1ae)+_0x1d32ec+_0x1cc709(0x14b),setTimeout(()=>{renderPracticeGameOverView();},0x7d0);return;}if(syncTimer)clearTimeout(syncTimer);const _0x1b4079=doc(db,'games',currentGameId);try{await runTransaction(db,async _0x5e9399=>{const _0x5a145a=_0x1cc709,_0xb73046=await _0x5e9399[_0x5a145a(0x1f4)](_0x1b4079);if(!_0xb73046['exists']())throw new Error(_0x5a145a(0x191));const _0x38684c=_0xb73046[_0x5a145a(0x15c)]();if(_0x38684c[_0x5a145a(0x204)]!==_0x5a145a(0x1a8))return;const _0x4cb8f0=(_0x38684c[_0x5a145a(0x197)]||{})[currentPlayerName];if(!_0x4cb8f0)throw new Error('Player\x20not\x20found\x20in\x20game');if(_0x4cb8f0[_0x5a145a(0x199)])return;const _0x433972=board;let _0x33884f,_0x5c8120='single';_0x38684c['gameMode']['difficulty']===_0x5a145a(0x16d)?(_0x5c8120=_0x4cb8f0[_0x5a145a(0x18c)]||_0x5a145a(0x1cb),_0x33884f=_0x38684c['puzzles'][_0x5c8120][_0x5a145a(0x196)]):_0x33884f=_0x38684c[_0x5a145a(0x1a6)][_0x5a145a(0x196)];for(let _0x235c33=0x0;_0x235c33<0x10;_0x235c33++){if(_0x433972[_0x235c33]!==_0x33884f[_0x235c33])return;}const _0x2679dd=_0x38684c[_0x5a145a(0x1ce)]['toMillis'](),_0xed7c7c=Math[_0x5a145a(0x189)]((Date[_0x5a145a(0x137)]()-_0x2679dd)/0x3e8),_0x28274d=Math['max'](0x0,_0x38684c[_0x5a145a(0x15b)][_0x5a145a(0x1c6)]-_0xed7c7c),_0x16cc95=0x64+_0x28274d+(hasMistake?0x0:0x32),_0x213b08={};if(_0x38684c[_0x5a145a(0x15b)][_0x5a145a(0x215)]===_0x5a145a(0x16d)){const _0xa1b5cd=doc(db,_0x5a145a(0x155),currentGameId,_0x5a145a(0x1cf),currentPlayerName);if(_0x5c8120==='easy')_0x213b08[_0x5a145a(0x183)+currentPlayerName+_0x5a145a(0x1c8)]=_0x5a145a(0x187),_0x213b08[_0x5a145a(0x183)+currentPlayerName+_0x5a145a(0x186)]=increment(_0x16cc95),_0x5e9399[_0x5a145a(0x1ac)](_0xa1b5cd,{'board':_0x38684c[_0x5a145a(0x1e7)][_0x5a145a(0x187)][_0x5a145a(0x1d4)][_0x5a145a(0x16e)](''),'hasMistake':![]});else _0x5c8120===_0x5a145a(0x187)?(_0x213b08[_0x5a145a(0x183)+currentPlayerName+'.currentLevel']=_0x5a145a(0x17d),_0x213b08['players.'+currentPlayerName+_0x5a145a(0x186)]=increment(_0x16cc95),_0x5e9399['set'](_0xa1b5cd,{'board':_0x38684c[_0x5a145a(0x1e7)][_0x5a145a(0x17d)][_0x5a145a(0x1d4)][_0x5a145a(0x16e)](''),'hasMistake':![]})):(_0x213b08[_0x5a145a(0x183)+currentPlayerName+_0x5a145a(0x186)]=increment(_0x16cc95),_0x213b08[_0x5a145a(0x183)+currentPlayerName+'.finishTime']=serverTimestamp(),_0x38684c['gameMode'][_0x5a145a(0x136)]==='immediate'&&(_0x213b08[_0x5a145a(0x204)]='finished',_0x213b08['winner']=currentPlayerName));}else _0x213b08['players.'+currentPlayerName+'.score']=increment(_0x16cc95),_0x213b08[_0x5a145a(0x183)+currentPlayerName+_0x5a145a(0x207)]=serverTimestamp(),_0x38684c[_0x5a145a(0x15b)][_0x5a145a(0x136)]==='immediate'&&(_0x213b08[_0x5a145a(0x204)]=_0x5a145a(0x1d6),_0x213b08['winner']=currentPlayerName);_0x5e9399[_0x5a145a(0x1ca)](_0x1b4079,_0x213b08);});}catch(_0x4169ac){_0x4169ac[_0x1cc709(0x1db)][_0x1cc709(0x1e0)](_0x1cc709(0x149))?(console[_0x1cc709(0x208)]('Transaction\x20aborted,\x20likely\x20because\x20another\x20player\x20finished\x20first.'),toast(_0x1cc709(0x17f))):(console[_0x1cc709(0x1f5)]('Finish\x20attempt\x20failed:',_0x4169ac),toast(_0x1cc709(0x15f)));}}$(_0x32a8ae(0x1f1))[_0x32a8ae(0x1da)](_0x32a8ae(0x166),()=>showView(_0x32a8ae(0x184))),$(_0x32a8ae(0x1ba))[_0x32a8ae(0x1da)](_0x32a8ae(0x166),()=>showView(_0x32a8ae(0x220))),$('#admin-login-btn')[_0x32a8ae(0x1da)](_0x32a8ae(0x166),async()=>{const _0x32c49d=_0x32a8ae;if($(_0x32c49d(0x1df))[_0x32c49d(0x153)]==='8899')await createGameRoom();else toast(_0x32c49d(0x14c));}),$(_0x32a8ae(0x1de))[_0x32a8ae(0x1da)](_0x32a8ae(0x166),handleJoinGame),$(_0x32a8ae(0x1be))[_0x32a8ae(0x1da)]('click',()=>{const _0x4bd84c=_0x32a8ae;isPracticeMode=!![],isHost=!![],showView('admin-settings'),$(_0x4bd84c(0x1f0))[_0x4bd84c(0x1ab)][_0x4bd84c(0x148)](_0x4bd84c(0x15a)),$(_0x4bd84c(0x1d2))[_0x4bd84c(0x212)]=_0x4bd84c(0x1a5);}),$('#open-settings-btn')[_0x32a8ae(0x1da)](_0x32a8ae(0x166),()=>{const _0x52c255=_0x32a8ae;isPracticeMode=![],showView('admin-settings'),$('#competition-settings')['classList'][_0x52c255(0x21b)](_0x52c255(0x15a)),$(_0x52c255(0x1d2))['innerHTML']=_0x52c255(0x217);}),$(_0x32a8ae(0x1aa))['addEventListener'](_0x32a8ae(0x166),()=>{const _0x172da2=_0x32a8ae;isHost&&!currentGameId&&isPracticeMode?(isPracticeMode=![],isHost=![],showView(_0x172da2(0x220))):showView(_0x172da2(0x1cd));}),$(_0x32a8ae(0x1d2))[_0x32a8ae(0x1da)](_0x32a8ae(0x166),()=>{isPracticeMode?startPracticeGame():handleStartGame();}),$('#end-game-btn')[_0x32a8ae(0x1da)](_0x32a8ae(0x166),forceEndGame),$(_0x32a8ae(0x185))[_0x32a8ae(0x1da)](_0x32a8ae(0x166),returnToLobby),$('#home-btn')[_0x32a8ae(0x1da)](_0x32a8ae(0x166),()=>{const _0x1a4d86=_0x32a8ae;if(unsubscribeGameListener)unsubscribeGameListener();unsubscribePlayerStateListener&&(unsubscribePlayerStateListener(),unsubscribePlayerStateListener=null);if(timerInterval)clearInterval(timerInterval);currentGameId=null,currentPlayerName=null,isHost=![],isPracticeMode=![],practicePuzzles=null,currentPracticeLevel=null,document[_0x1a4d86(0x1c7)]['classList'][_0x1a4d86(0x21b)](_0x1a4d86(0x1d5)),showView(_0x1a4d86(0x220)),$('#player-finished-view\x20h2')[_0x1a4d86(0x178)]=_0x1a4d86(0x205),$('#player-finished-view\x20p')[_0x1a4d86(0x178)]=_0x1a4d86(0x19f);}),$(_0x32a8ae(0x1c3))['addEventListener'](_0x32a8ae(0x166),()=>{for(let _0x3142b6=0x0;_0x3142b6<0x10;_0x3142b6++)board[_0x3142b6]=given[_0x3142b6];hasMistake=![],renderSudoku(),scheduleBoardSync();}),sudokuEl[_0x32a8ae(0x1da)]('click',_0x167e51=>{const _0x336fc3=_0x32a8ae,_0x2d5b93=_0x167e51['target'][_0x336fc3(0x13c)](_0x336fc3(0x200));if(!_0x2d5b93)return;const _0x29b443=parseInt(_0x2d5b93[_0x336fc3(0x1bb)][_0x336fc3(0x158)],0xa);if(!given[_0x29b443])selectCell(_0x29b443);}),$(_0x32a8ae(0x1fa))[_0x32a8ae(0x1da)](_0x32a8ae(0x166),()=>{const _0x4efa81=_0x32a8ae;$(_0x4efa81(0x1b3))[_0x4efa81(0x1ab)][_0x4efa81(0x145)](_0x4efa81(0x147));}),$(_0x32a8ae(0x1f2))['addEventListener'](_0x32a8ae(0x19a),_0x31dc1a=>{const _0x620981=_0x32a8ae,_0x268db9=$(_0x620981(0x1ea));switch(_0x31dc1a[_0x620981(0x18d)][_0x620981(0x153)]){case'easy':_0x268db9['value']=0x1e;break;case _0x620981(0x187):_0x268db9[_0x620981(0x153)]=0x3c;break;case _0x620981(0x17d):_0x268db9[_0x620981(0x153)]=0x78;break;case _0x620981(0x16d):_0x268db9[_0x620981(0x153)]=0xd2;break;}}),window[_0x32a8ae(0x1da)](_0x32a8ae(0x168),()=>{const _0x3f45d7=_0x32a8ae;isHost&&currentGameId&&deleteDoc(doc(db,_0x3f45d7(0x155),currentGameId));}),initialize(),showView('player-join');
