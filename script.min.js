const _0x46cd4d=_0x9007;(function(_0x4bfa7a,_0x532f1f){const _0x40a242=_0x9007,_0x56bdac=_0x4bfa7a();while(!![]){try{const _0x1a32f3=-parseInt(_0x40a242(0x94))/0x1*(parseInt(_0x40a242(0x138))/0x2)+-parseInt(_0x40a242(0xba))/0x3+-parseInt(_0x40a242(0x72))/0x4*(parseInt(_0x40a242(0xbc))/0x5)+-parseInt(_0x40a242(0x71))/0x6*(parseInt(_0x40a242(0x8f))/0x7)+-parseInt(_0x40a242(0x9e))/0x8+parseInt(_0x40a242(0xc9))/0x9+parseInt(_0x40a242(0x11e))/0xa*(parseInt(_0x40a242(0x127))/0xb);if(_0x1a32f3===_0x532f1f)break;else _0x56bdac['push'](_0x56bdac['shift']());}catch(_0x4b63c9){_0x56bdac['push'](_0x56bdac['shift']());}}}(_0x695b,0xb3e8a));import{initializeApp}from'https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js';import{getAuth,signInAnonymously,onAuthStateChanged}from'https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js';import{getFirestore,doc,getDoc,setDoc,updateDoc,onSnapshot,serverTimestamp,runTransaction,deleteDoc,deleteField,increment,collection}from'https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js';const firebaseConfig={'apiKey':_0x46cd4d(0x7a),'authDomain':'game24-69666.firebaseapp.com','projectId':_0x46cd4d(0xe7),'storageBucket':'game24-69666.firebasestorage.app','messagingSenderId':_0x46cd4d(0x106),'appId':_0x46cd4d(0xa5),'measurementId':_0x46cd4d(0xe0)},$=_0x20ddec=>document[_0x46cd4d(0x10e)](_0x20ddec),$$=_0xcba3ff=>Array['from'](document[_0x46cd4d(0x133)](_0xcba3ff)),playerJoinView=$(_0x46cd4d(0x93)),playerWaitView=$('#player-wait-view'),adminLobbyView=$(_0x46cd4d(0x74)),gameView=$('#game-view'),adminLoginModal=$(_0x46cd4d(0xec)),adminSettingsModal=$(_0x46cd4d(0x109)),gameOverView=$(_0x46cd4d(0xa9)),sudokuEl=$(_0x46cd4d(0xac)),pickerEl=$('#picker'),playerList=$(_0x46cd4d(0xde)),lobbyPlayerNameList=$(_0x46cd4d(0xa3)),lobbyPlayerCount=$(_0x46cd4d(0x128)),hostControls=$(_0x46cd4d(0x10a)),toastEl=$(_0x46cd4d(0x9d)),gameCodeDisplay=$(_0x46cd4d(0xaa)),gameTimerEl=$(_0x46cd4d(0x134)),puzzleProgressEl=$(_0x46cd4d(0x12a)),playerScoreDisplay=$(_0x46cd4d(0x116)),gameBoard=$('#game-board'),playerFinishedView=$(_0x46cd4d(0xd9)),podiumContainer=$(_0x46cd4d(0xfd)),otherRankingsList=$(_0x46cd4d(0x96)),otherRankingsContainer=$(_0x46cd4d(0x11d)),targetNumberDisplay=$('#target-number-display');let db,auth,userId,currentPlayerName,isHost=![],currentGameId=null,unsubscribeGameListener=null,unsubscribePlayerStateListener=null,timerInterval=null,allPlayerStates={},unsubscribeAllPlayerStates=null,latestGameData={},previousGameStatus=null,isPracticeMode=![],practicePuzzles=null,currentPracticeLevel=null,N=0x4,boxR=0x2,boxC=0x2,given=[],board=[],solution=[],selectedIdx=-0x1,hasMistake=![],gameSettings={'timeLimit':0x3c,'resultDisplayMode':_0x46cd4d(0xb0),'difficulty':_0x46cd4d(0xa4),'boardSize':0x4,'numQuestions':0x1};function toast(_0x58f3eb,_0x10f776=0x7d0){const _0x599c59=_0x46cd4d;toastEl['textContent']=_0x58f3eb,toastEl[_0x599c59(0xfb)][_0x599c59(0xf1)](_0x599c59(0xf8)),setTimeout(()=>toastEl[_0x599c59(0xfb)]['remove'](_0x599c59(0xf8)),_0x10f776);}const rnd=(_0x5be2ef,_0xdce4b5)=>Math[_0x46cd4d(0x7c)](Math[_0x46cd4d(0x146)]()*(_0xdce4b5-_0x5be2ef+0x1))+_0x5be2ef;function shuffle(_0x42eab5){const _0x69c97b=_0x46cd4d;for(let _0x391ca8=_0x42eab5[_0x69c97b(0x12b)]-0x1;_0x391ca8>0x0;_0x391ca8--){const _0x4642be=Math[_0x69c97b(0x7c)](Math[_0x69c97b(0x146)]()*(_0x391ca8+0x1));[_0x42eab5[_0x391ca8],_0x42eab5[_0x4642be]]=[_0x42eab5[_0x4642be],_0x42eab5[_0x391ca8]];}return _0x42eab5;}const themeKey='g24_theme_mp',themeSelect=$('#themeSelect');function applyTheme(_0x649085){const _0x1da607=_0x46cd4d;document[_0x1da607(0x83)][_0x1da607(0x144)](_0x1da607(0x121),_0x649085),localStorage[_0x1da607(0x7f)](themeKey,_0x649085);}const savedTheme=localStorage['getItem'](themeKey),initialTheme=savedTheme||'contrast';applyTheme(initialTheme);themeSelect&&themeSelect[_0x46cd4d(0x11c)](_0x46cd4d(0x13f),()=>applyTheme(themeSelect[_0x46cd4d(0x119)]));function setBoardSize(_0x2f5af6){const _0x284836=_0x46cd4d;document[_0x284836(0xe4)][_0x284836(0xfb)][_0x284836(0x81)]('board-size-4',_0x284836(0xc3),'board-size-9'),document['body'][_0x284836(0xfb)][_0x284836(0xf1)](_0x284836(0xa6)+_0x2f5af6),N=parseInt(_0x2f5af6,0xa);if(N===0x4)boxR=0x2,boxC=0x2;else{if(N===0x6)boxR=0x2,boxC=0x3;else N===0x9?(boxR=0x3,boxC=0x3):(N=0x4,boxR=0x2,boxC=0x2);}const _0x406aed=N*N;given=new Array(_0x406aed)[_0x284836(0xc8)](0x0),board=new Array(_0x406aed)[_0x284836(0xc8)](0x0),solution=new Array(_0x406aed)[_0x284836(0xc8)](0x0);}function makeBaseSolved(_0x1b26ce,_0x4f5e05,_0x495973){const _0x305fb0=_0x46cd4d,_0x5804f2=new Array(_0x1b26ce*_0x1b26ce);for(let _0x1daa7e=0x0;_0x1daa7e<_0x1b26ce;_0x1daa7e++){for(let _0x3e4223=0x0;_0x3e4223<_0x1b26ce;_0x3e4223++){const _0x23c6af=(_0x1daa7e*_0x495973+Math[_0x305fb0(0x7c)](_0x1daa7e/_0x4f5e05)+_0x3e4223)%_0x1b26ce+0x1;_0x5804f2[_0x1daa7e*_0x1b26ce+_0x3e4223]=_0x23c6af;}}return _0x5804f2;}function applyPermutations(_0x369a25,_0x8cb9bb,_0x307b0b,_0x21f63d){const _0x3e0353=_0x46cd4d;let _0x2fc5a7=_0x369a25[_0x3e0353(0x10c)]();const _0x5717e3=(_0xbc5d68,_0x2b78b3)=>{for(let _0xc4fdd4=0x0;_0xc4fdd4<_0x8cb9bb;_0xc4fdd4++){const _0x47ce81=_0xbc5d68*_0x8cb9bb+_0xc4fdd4,_0x19a125=_0x2b78b3*_0x8cb9bb+_0xc4fdd4;[_0x2fc5a7[_0x47ce81],_0x2fc5a7[_0x19a125]]=[_0x2fc5a7[_0x19a125],_0x2fc5a7[_0x47ce81]];}},_0x1a5d9f=(_0x43b0ea,_0x1fd2da)=>{for(let _0x529f7e=0x0;_0x529f7e<_0x8cb9bb;_0x529f7e++){const _0x3cbee0=_0x529f7e*_0x8cb9bb+_0x43b0ea,_0x45f33f=_0x529f7e*_0x8cb9bb+_0x1fd2da;[_0x2fc5a7[_0x3cbee0],_0x2fc5a7[_0x45f33f]]=[_0x2fc5a7[_0x45f33f],_0x2fc5a7[_0x3cbee0]];}};for(let _0x1c96af=0x0;_0x1c96af<_0x8cb9bb;_0x1c96af+=_0x307b0b){if(Math[_0x3e0353(0x146)]()<0.5){const _0x4c3d8a=_0x1c96af+rnd(0x0,_0x307b0b-0x1),_0x1bf069=_0x1c96af+rnd(0x0,_0x307b0b-0x1);if(_0x4c3d8a!==_0x1bf069)_0x5717e3(_0x4c3d8a,_0x1bf069);}}for(let _0x5e6f1a=0x0;_0x5e6f1a<_0x8cb9bb;_0x5e6f1a+=_0x21f63d){if(Math[_0x3e0353(0x146)]()<0.5){const _0x4ce47f=_0x5e6f1a+rnd(0x0,_0x21f63d-0x1),_0x4167b6=_0x5e6f1a+rnd(0x0,_0x21f63d-0x1);if(_0x4ce47f!==_0x4167b6)_0x1a5d9f(_0x4ce47f,_0x4167b6);}}if(Math[_0x3e0353(0x146)]()<0.5){const _0x146207=rnd(0x0,_0x8cb9bb/_0x307b0b-0x1),_0x338c02=rnd(0x0,_0x8cb9bb/_0x307b0b-0x1);if(_0x146207!==_0x338c02){for(let _0x109b48=0x0;_0x109b48<_0x307b0b;_0x109b48++)_0x5717e3(_0x146207*_0x307b0b+_0x109b48,_0x338c02*_0x307b0b+_0x109b48);}}if(Math['random']()<0.5){const _0x8a2b6d=rnd(0x0,_0x8cb9bb/_0x21f63d-0x1),_0x2732a1=rnd(0x0,_0x8cb9bb/_0x21f63d-0x1);if(_0x8a2b6d!==_0x2732a1){for(let _0x568039=0x0;_0x568039<_0x21f63d;_0x568039++)_0x1a5d9f(_0x8a2b6d*_0x21f63d+_0x568039,_0x2732a1*_0x21f63d+_0x568039);}}const _0x49211a=[...Array(_0x8cb9bb)['keys']()]['map'](_0x12fc68=>_0x12fc68+0x1);shuffle(_0x49211a);for(let _0x47be9f=0x0;_0x47be9f<_0x8cb9bb*_0x8cb9bb;_0x47be9f++)_0x2fc5a7[_0x47be9f]=_0x49211a[_0x2fc5a7[_0x47be9f]-0x1];return _0x2fc5a7;}function candidatesAt(_0x12fbd1,_0x1908ef){const _0x33b027=_0x46cd4d;if(_0x12fbd1[_0x1908ef]!==0x0)return[];const _0x3d00bd=Math[_0x33b027(0x7c)](_0x1908ef/N),_0x116d89=_0x1908ef%N,_0x5e3d3b=new Set();for(let _0x568518=0x0;_0x568518<N;_0x568518++){_0x5e3d3b[_0x33b027(0xf1)](_0x12fbd1[_0x3d00bd*N+_0x568518]),_0x5e3d3b[_0x33b027(0xf1)](_0x12fbd1[_0x568518*N+_0x116d89]);}const _0x4f83d6=Math[_0x33b027(0x7c)](_0x3d00bd/boxR)*boxR,_0x5f38ac=Math[_0x33b027(0x7c)](_0x116d89/boxC)*boxC;for(let _0x47f2e3=_0x4f83d6;_0x47f2e3<_0x4f83d6+boxR;_0x47f2e3++)for(let _0x2d5656=_0x5f38ac;_0x2d5656<_0x5f38ac+boxC;_0x2d5656++){_0x5e3d3b[_0x33b027(0xf1)](_0x12fbd1[_0x47f2e3*N+_0x2d5656]);}const _0x237ee7=[];for(let _0xd1b1a4=0x1;_0xd1b1a4<=N;_0xd1b1a4++)if(!_0x5e3d3b[_0x33b027(0xb6)](_0xd1b1a4))_0x237ee7[_0x33b027(0x140)](_0xd1b1a4);return _0x237ee7;}function countSolutions(_0x14ba2b){const _0x2d20e7=_0x46cd4d,_0x1bcd13=_0x14ba2b['slice']();let _0x438985=0x0;const _0x4b70c9=[...Array(N*N)[_0x2d20e7(0x11a)]()]['filter'](_0x440d18=>_0x1bcd13[_0x440d18]===0x0);_0x4b70c9[_0x2d20e7(0x77)]((_0x4f5f40,_0x4623e1)=>candidatesAt(_0x1bcd13,_0x4f5f40)[_0x2d20e7(0x12b)]-candidatesAt(_0x1bcd13,_0x4623e1)[_0x2d20e7(0x12b)]);function _0x2f063e(_0x241edb){const _0x49a381=_0x2d20e7;if(_0x438985>0x1)return;if(_0x241edb>=_0x4b70c9[_0x49a381(0x12b)]){_0x438985++;return;}const _0x519d3c=_0x4b70c9[_0x241edb],_0x1a5292=candidatesAt(_0x1bcd13,_0x519d3c);for(const _0x44dca4 of _0x1a5292){_0x1bcd13[_0x519d3c]=_0x44dca4,_0x2f063e(_0x241edb+0x1);if(_0x438985>0x1){_0x1bcd13[_0x519d3c]=0x0;return;}_0x1bcd13[_0x519d3c]=0x0;}}return _0x2f063e(0x0),_0x438985;}function makePuzzleByClues(_0x11501e,_0x57301b){const _0x3c7b27=_0x46cd4d;let _0x2d4b47=_0x11501e[_0x3c7b27(0x10c)]();const _0x4e12aa=shuffle([...Array(N*N)[_0x3c7b27(0x11a)]()]);let _0x407686=0x0;const _0x34990a=N*N;for(const _0x34657f of _0x4e12aa){if(_0x34990a-_0x407686<=_0x57301b)break;const _0x4105bd=_0x2d4b47[_0x34657f];_0x2d4b47[_0x34657f]=0x0,countSolutions(_0x2d4b47)!==0x1?_0x2d4b47[_0x34657f]=_0x4105bd:_0x407686++;}return _0x2d4b47;}function generateSudoku(_0x4e4ecd){const _0x14577e=_0x46cd4d,_0x53655c=makeBaseSolved(N,boxR,boxC),_0x46d2cb=applyPermutations(_0x53655c,N,boxR,boxC),_0x2efc16=N===0x4?{'easy':[0x9,0xa],'medium':[0x7,0x8],'hard':[0x5,0x6]}:N===0x6?{'easy':[0x18,0x1a],'medium':[0x14,0x17],'hard':[0x10,0x13]}:{'easy':[0x24,0x28],'medium':[0x1e,0x23],'hard':[0x18,0x1d]},[_0x2914a7,_0x313917]=_0x2efc16[_0x4e4ecd]||_0x2efc16[_0x14577e(0xa4)],_0x5a11eb=rnd(_0x2914a7,_0x313917);let _0x3689a4=makePuzzleByClues(_0x46d2cb,_0x5a11eb);if(countSolutions(_0x3689a4)!==0x1)return generateSudoku(_0x4e4ecd);return{'solution':_0x46d2cb,'puzzle':_0x3689a4};}function cellClasses(_0x3eb713){const _0x33277f=_0x46cd4d,_0x4e2c95=Math['floor'](_0x3eb713/N),_0x2dedc2=_0x3eb713%N,_0x24c576=[_0x33277f(0xc2)];if((_0x2dedc2+0x1)%boxC===0x0&&_0x2dedc2!==N-0x1)_0x24c576[_0x33277f(0x140)]('bR');if((_0x4e2c95+0x1)%boxR===0x0&&_0x4e2c95!==N-0x1)_0x24c576['push']('bB');return _0x24c576[_0x33277f(0x141)]('\x20');}function updateBoardFromState(_0x3dcadf){const _0x490c00=_0x46cd4d;for(let _0x11152d=0x0;_0x11152d<N*N;_0x11152d++){if(board[_0x11152d]!==_0x3dcadf[_0x11152d]){const _0x38cca2=sudokuEl[_0x490c00(0x10e)](_0x490c00(0x122)+_0x11152d+'\x22]');_0x38cca2&&(_0x38cca2[_0x490c00(0x117)]=_0x3dcadf[_0x11152d]?_0x3dcadf[_0x11152d]:'');}}board=_0x3dcadf,markConflictsAll(),updateProgressText();}function renderPicker(){const _0x3a70e4=_0x46cd4d;pickerEl[_0x3a70e4(0x6f)]='';for(let _0x53353b=0x1;_0x53353b<=N;_0x53353b++){const _0x463d4c=document[_0x3a70e4(0xbe)](_0x3a70e4(0x105));_0x463d4c[_0x3a70e4(0xe5)]='pick',_0x463d4c[_0x3a70e4(0xdd)]['n']=_0x53353b,_0x463d4c[_0x3a70e4(0x117)]=_0x53353b,pickerEl['appendChild'](_0x463d4c);}const _0x15ae9f=document[_0x3a70e4(0xbe)](_0x3a70e4(0x105));_0x15ae9f[_0x3a70e4(0xe5)]=_0x3a70e4(0xae),_0x15ae9f[_0x3a70e4(0xdd)]['n']=0x0,_0x15ae9f['title']='ลบ',_0x15ae9f[_0x3a70e4(0x6f)]=_0x3a70e4(0xdb),pickerEl[_0x3a70e4(0xe8)](_0x15ae9f);}function renderSudoku(){const _0x42d0b5=_0x46cd4d;sudokuEl[_0x42d0b5(0xe3)][_0x42d0b5(0x91)]=_0x42d0b5(0xa2)+N+_0x42d0b5(0xd5),sudokuEl[_0x42d0b5(0x6f)]='';for(let _0x421601=0x0;_0x421601<N*N;_0x421601++){const _0x402750=board[_0x421601],_0x10819a=document[_0x42d0b5(0xbe)](_0x42d0b5(0x95));_0x10819a[_0x42d0b5(0xe5)]=cellClasses(_0x421601)+'\x20'+(given[_0x421601]?_0x42d0b5(0x86):''),_0x10819a[_0x42d0b5(0xdd)][_0x42d0b5(0x114)]=_0x421601,_0x10819a[_0x42d0b5(0x117)]=_0x402750?_0x402750:'',!given[_0x421601]&&_0x10819a[_0x42d0b5(0x11c)]('click',()=>selectCell(_0x421601)),sudokuEl[_0x42d0b5(0xe8)](_0x10819a);}if(selectedIdx>=0x0)highlightRelatives(selectedIdx);markConflictsAll(),updateProgressText(),renderPicker();}function selectCell(_0x1833c6){const _0xda9b=_0x46cd4d;selectedIdx=_0x1833c6,$$(_0xda9b(0x136))['forEach'](_0x2201fb=>_0x2201fb['classList'][_0xda9b(0x81)](_0xda9b(0x92),'hl'));const _0x3d67f8=sudokuEl['querySelector'](_0xda9b(0x122)+_0x1833c6+'\x22]');_0x3d67f8&&(_0x3d67f8[_0xda9b(0xfb)][_0xda9b(0xf1)](_0xda9b(0x92)),highlightRelatives(_0x1833c6));}function highlightRelatives(_0x13a89d){const _0x1a7ea1=_0x46cd4d,_0x33e674=Math[_0x1a7ea1(0x7c)](_0x13a89d/N),_0x49a87e=_0x13a89d%N;$$(_0x1a7ea1(0x136))[_0x1a7ea1(0xd0)]((_0x594513,_0x123aaa)=>{const _0x57f5ce=_0x1a7ea1,_0x77a2f7=Math[_0x57f5ce(0x7c)](_0x123aaa/N),_0x2ae6ed=_0x123aaa%N,_0xe51606=Math[_0x57f5ce(0x7c)](_0x77a2f7/boxR)===Math[_0x57f5ce(0x7c)](_0x33e674/boxR)&&Math['floor'](_0x2ae6ed/boxC)===Math[_0x57f5ce(0x7c)](_0x49a87e/boxC);(_0x77a2f7===_0x33e674||_0x2ae6ed===_0x49a87e||_0xe51606)&&_0x594513[_0x57f5ce(0xfb)][_0x57f5ce(0xf1)]('hl');});}function setNumber(_0x3e593a){const _0x48dc3d=_0x46cd4d;if(selectedIdx<0x0||given[selectedIdx])return;const _0x2d6178=sudokuEl[_0x48dc3d(0x10e)](_0x48dc3d(0x122)+selectedIdx+'\x22]');if(!_0x2d6178)return;_0x2d6178[_0x48dc3d(0x117)]=_0x3e593a?_0x3e593a:'',board[selectedIdx]=_0x3e593a;_0x3e593a!==0x0&&causesConflict(selectedIdx)&&(hasMistake=!![]);markConflictsAll(),updateProgressText(),scheduleBoardSync();if(isSolved())tryFinish();}function markConflictsAll(){const _0x15813e=_0x46cd4d;$$('.cell')[_0x15813e(0xd0)]((_0x4f204e,_0x5d32bd)=>{const _0x3649c9=_0x15813e;_0x4f204e[_0x3649c9(0xfb)][_0x3649c9(0x81)]('conflict','ok');if(board[_0x5d32bd]!==0x0&&causesConflict(_0x5d32bd))_0x4f204e[_0x3649c9(0xfb)][_0x3649c9(0xf1)]('conflict');else{if(board[_0x5d32bd]!==0x0)_0x4f204e[_0x3649c9(0xfb)][_0x3649c9(0xf1)]('ok');}});}function causesConflict(_0xd3dca8){const _0xb1802=_0x46cd4d,_0x1133b3=board[_0xd3dca8];if(_0x1133b3===0x0)return![];const _0x3042a9=Math[_0xb1802(0x7c)](_0xd3dca8/N),_0x4e1f38=_0xd3dca8%N;for(let _0x2561ba=0x0;_0x2561ba<N;_0x2561ba++){if(_0x2561ba!==_0x4e1f38&&board[_0x3042a9*N+_0x2561ba]===_0x1133b3)return!![];if(_0x2561ba!==_0x3042a9&&board[_0x2561ba*N+_0x4e1f38]===_0x1133b3)return!![];}const _0x32e67a=Math['floor'](_0x3042a9/boxR)*boxR,_0x21e5de=Math[_0xb1802(0x7c)](_0x4e1f38/boxC)*boxC;for(let _0x3d5b7b=_0x32e67a;_0x3d5b7b<_0x32e67a+boxR;_0x3d5b7b++)for(let _0x2d3dee=_0x21e5de;_0x2d3dee<_0x21e5de+boxC;_0x2d3dee++){const _0x56a75c=_0x3d5b7b*N+_0x2d3dee;if(_0x56a75c!==_0xd3dca8&&board[_0x56a75c]===_0x1133b3)return!![];}return![];}function isSolved(){for(let _0x56b05c=0x0;_0x56b05c<N*N;_0x56b05c++)if(board[_0x56b05c]!==solution[_0x56b05c])return![];return!![];}function _0x9007(_0x68e660,_0x4c2472){const _0x695b9d=_0x695b();return _0x9007=function(_0x900798,_0x1353ef){_0x900798=_0x900798-0x64;let _0xf4f1f2=_0x695b9d[_0x900798];return _0xf4f1f2;},_0x9007(_0x68e660,_0x4c2472);}function updateProgressText(){const _0x5743a3=_0x46cd4d,_0x31ca17=board['filter'](_0x1f6325=>_0x1f6325!==0x0)[_0x5743a3(0x12b)];puzzleProgressEl[_0x5743a3(0x117)]=_0x5743a3(0xdf)+_0x31ca17+'/'+N*N;}pickerEl[_0x46cd4d(0x11c)]('click',_0x3ea26c=>{const _0x3b21cd=_0x46cd4d,_0x15d02d=_0x3ea26c[_0x3b21cd(0xd7)][_0x3b21cd(0xcf)](_0x3b21cd(0xb2));if(!_0x15d02d)return;setNumber(parseInt(_0x15d02d['dataset']['n'],0xa));}),document['addEventListener'](_0x46cd4d(0x85),_0x433235=>{const _0x4b3ce7=_0x46cd4d;if(selectedIdx<0x0)return;const _0x5a19f1=parseInt(_0x433235[_0x4b3ce7(0x7d)],0xa);if(!isNaN(_0x5a19f1)&&_0x5a19f1>=0x1&&_0x5a19f1<=N)setNumber(_0x5a19f1);(_0x433235['key']==='Backspace'||_0x433235[_0x4b3ce7(0x7d)]==='Delete'||_0x433235[_0x4b3ce7(0x7d)]==='0')&&setNumber(0x0);const _0x175311=Math[_0x4b3ce7(0x7c)](selectedIdx/N),_0x1073ea=selectedIdx%N;if(_0x433235[_0x4b3ce7(0x7d)]===_0x4b3ce7(0x120))selectCell(_0x175311*N+Math[_0x4b3ce7(0x9a)](_0x1073ea+0x1,N-0x1));if(_0x433235[_0x4b3ce7(0x7d)]===_0x4b3ce7(0xaf))selectCell(_0x175311*N+Math[_0x4b3ce7(0x80)](_0x1073ea-0x1,0x0));if(_0x433235[_0x4b3ce7(0x7d)]===_0x4b3ce7(0x131))selectCell(Math['min']((_0x175311+0x1)*N+_0x1073ea,N*N-0x1));if(_0x433235[_0x4b3ce7(0x7d)]===_0x4b3ce7(0x130))selectCell(Math[_0x4b3ce7(0x80)]((_0x175311-0x1)*N+_0x1073ea,0x0));});async function initialize(){const _0xaf323f=_0x46cd4d;try{const _0x698e83=initializeApp(firebaseConfig);db=getFirestore(_0x698e83),auth=getAuth(_0x698e83),onAuthStateChanged(auth,async _0x32c625=>{!_0x32c625&&await signInAnonymously(auth);});}catch(_0x1754c){console[_0xaf323f(0xbb)](_0xaf323f(0x13a),_0x1754c),toast('การเชื่อมต่อล้มเหลว');}}function showView(_0x5305a3){const _0x3b6bed=_0x46cd4d;[playerJoinView,playerWaitView,adminLoginModal,adminLobbyView,gameView,gameOverView,adminSettingsModal]['forEach'](_0x34729a=>_0x34729a[_0x3b6bed(0xfb)][_0x3b6bed(0xf1)](_0x3b6bed(0xfc)));const _0x494916=$('#admin-icon-btn');if(_0x5305a3===_0x3b6bed(0x104)||_0x5305a3===_0x3b6bed(0x147))_0x494916[_0x3b6bed(0xfb)]['remove'](_0x3b6bed(0xfc));else isHost?_0x494916[_0x3b6bed(0xfb)]['remove']('hidden'):_0x494916[_0x3b6bed(0xfb)]['add'](_0x3b6bed(0xfc));if(_0x5305a3===_0x3b6bed(0x104))playerJoinView['classList'][_0x3b6bed(0x81)](_0x3b6bed(0xfc));else{if(_0x5305a3==='player-wait')playerWaitView[_0x3b6bed(0xfb)][_0x3b6bed(0x81)]('hidden');else{if(_0x5305a3==='admin-login')adminLoginModal[_0x3b6bed(0xfb)][_0x3b6bed(0x81)](_0x3b6bed(0xfc));else{if(_0x5305a3===_0x3b6bed(0xad))adminLobbyView[_0x3b6bed(0xfb)][_0x3b6bed(0x81)]('hidden');else{if(_0x5305a3===_0x3b6bed(0x124))adminSettingsModal['classList']['remove']('hidden');else{if(_0x5305a3===_0x3b6bed(0x75))gameView[_0x3b6bed(0xfb)][_0x3b6bed(0x81)](_0x3b6bed(0xfc));else{if(_0x5305a3===_0x3b6bed(0xda))gameOverView[_0x3b6bed(0xfb)][_0x3b6bed(0x81)](_0x3b6bed(0xfc));}}}}}}}async function createGameRoom(){const _0x3120ca=_0x46cd4d;isHost=!![],document[_0x3120ca(0xe4)][_0x3120ca(0xfb)][_0x3120ca(0x81)](_0x3120ca(0x12c)),showView(_0x3120ca(0xad)),gameCodeDisplay['textContent']=_0x3120ca(0x12d);const _0x520bb5=rnd(0xa,0x63)[_0x3120ca(0x110)]();currentGameId=_0x520bb5;const _0x108893={'hostId':auth[_0x3120ca(0x13d)][_0x3120ca(0x70)],'status':_0x3120ca(0x87),'players':{},'createdAt':serverTimestamp()};await setDoc(doc(db,_0x3120ca(0xff),currentGameId),_0x108893),gameCodeDisplay[_0x3120ca(0x117)]=currentGameId,listenForGameUpdates(currentGameId);}async function handleStartGame(){const _0x5a7add=_0x46cd4d;if(!isHost||!currentGameId)return;gameSettings[_0x5a7add(0x65)]=parseInt($(_0x5a7add(0x107))[_0x5a7add(0x119)],0xa),gameSettings[_0x5a7add(0x82)]=document[_0x5a7add(0x10e)](_0x5a7add(0xee))[_0x5a7add(0x119)],gameSettings[_0x5a7add(0x9b)]=Math[_0x5a7add(0x80)](0xa,parseInt($('#time-limit-input')['value']||'60',0xa)),gameSettings[_0x5a7add(0x139)]=$('#difficulty-select')['value'],setBoardSize(gameSettings[_0x5a7add(0x65)]);const _0xaf238f=doc(db,_0x5a7add(0xff),currentGameId);try{await runTransaction(db,async _0x500cb0=>{const _0x586296=_0x5a7add,_0x25da05=await _0x500cb0[_0x586296(0x99)](_0xaf238f);if(!_0x25da05[_0x586296(0xc4)]())throw _0x586296(0x13e);const _0x3d2884={'status':'playing','startTime':serverTimestamp(),'gameMode':gameSettings,'sudoku':generateSudoku(gameSettings['difficulty'])},_0x5090bc=_0x3d2884['sudoku'][_0x586296(0xc6)],_0x519e9b=_0x25da05[_0x586296(0x118)]()[_0x586296(0x90)]||{};for(const _0x3849e2 in _0x519e9b){_0x3d2884[_0x586296(0x10b)+_0x3849e2+_0x586296(0x132)]=0x0,_0x3d2884[_0x586296(0x10b)+_0x3849e2+_0x586296(0xf0)]=null,_0x3d2884['players.'+_0x3849e2+_0x586296(0xef)]=_0x5090bc[_0x586296(0x6c)](_0x30915b=>_0x30915b!==0x0)[_0x586296(0x12b)];const _0x39abde=doc(db,_0x586296(0xff),currentGameId,_0x586296(0x9c),_0x3849e2),_0x39a264={'board':_0x5090bc['join'](','),'hasMistake':![]};_0x500cb0['set'](_0x39abde,_0x39a264);}_0x500cb0[_0x586296(0xbf)](_0xaf238f,_0x3d2884);}),showView(_0x5a7add(0x75));}catch(_0x28e750){console[_0x5a7add(0xbb)]('Error\x20starting\x20game:',_0x28e750),toast(_0x5a7add(0xce));}}function startPracticeGame(){const _0x147243=_0x46cd4d;isPracticeMode=!![],gameSettings['boardSize']=parseInt($(_0x147243(0x107))[_0x147243(0x119)],0xa),gameSettings[_0x147243(0x9b)]=Math[_0x147243(0x80)](0xa,parseInt($(_0x147243(0x137))[_0x147243(0x119)]||'60',0xa)),gameSettings['difficulty']=$(_0x147243(0x84))[_0x147243(0x119)],setBoardSize(gameSettings[_0x147243(0x65)]),document[_0x147243(0xe4)][_0x147243(0xfb)][_0x147243(0xf1)](_0x147243(0x12c)),hostControls[_0x147243(0xfb)][_0x147243(0xf1)]('hidden'),playerScoreDisplay[_0x147243(0xfb)][_0x147243(0xf1)](_0x147243(0xfc)),$(_0x147243(0x125))[_0x147243(0xfb)][_0x147243(0xf1)]('hidden'),practicePuzzles=null,currentPracticeLevel=gameSettings[_0x147243(0x139)];const _0x21613c=generateSudoku(gameSettings['difficulty']);given=_0x21613c[_0x147243(0xc6)][_0x147243(0x10c)](),board=_0x21613c[_0x147243(0xc6)][_0x147243(0x10c)](),solution=_0x21613c['solution'][_0x147243(0x10c)](),targetNumberDisplay[_0x147243(0x117)]=_0x147243(0xcd)+N+'×'+N,hasMistake=![],selectedIdx=board[_0x147243(0xc5)]((_0x40ca0d,_0x349e2f)=>!given[_0x349e2f]);if(selectedIdx<0x0)selectedIdx=0x0;showView(_0x147243(0x75)),gameBoard['classList'][_0x147243(0x81)]('hidden'),playerFinishedView['classList'][_0x147243(0xf1)](_0x147243(0xfc)),pickerEl[_0x147243(0xfb)][_0x147243(0x81)](_0x147243(0xfc)),$(_0x147243(0xd3))[_0x147243(0xfb)]['remove']('hidden'),$(_0x147243(0xb3))[_0x147243(0xfb)][_0x147243(0x81)](_0x147243(0xfc)),renderSudoku(),startPracticeTimer();}function startPracticeTimer(){const _0x55594b=_0x46cd4d;if(timerInterval)clearInterval(timerInterval);let _0x556550=gameSettings[_0x55594b(0x9b)];const _0x15ecb4=()=>{const _0x3a1651=_0x55594b,_0x3d6d92=String(Math[_0x3a1651(0x7c)](_0x556550/0x3c))[_0x3a1651(0x67)](0x2,'0'),_0x59447b=String(_0x556550%0x3c)[_0x3a1651(0x67)](0x2,'0');gameTimerEl[_0x3a1651(0x117)]='เวลา:\x20'+_0x3d6d92+':'+_0x59447b;};_0x15ecb4(),timerInterval=setInterval(()=>{const _0x278838=_0x55594b;_0x556550--,_0x15ecb4(),_0x556550<=0x0&&(clearInterval(timerInterval),gameBoard['classList'][_0x278838(0xf1)](_0x278838(0xfc)),playerFinishedView['classList'][_0x278838(0x81)](_0x278838(0xfc)),$(_0x278838(0x9f))[_0x278838(0x117)]=_0x278838(0x108),$(_0x278838(0x73))[_0x278838(0x117)]=_0x278838(0xe6));},0x3e8);}async function forceEndGame(){const _0x4eb460=_0x46cd4d;if(!isHost||!currentGameId)return;const _0x35e27b=doc(db,_0x4eb460(0xff),currentGameId),_0x5852d6=await getDoc(_0x35e27b);_0x5852d6[_0x4eb460(0xc4)]()&&_0x5852d6[_0x4eb460(0x118)]()[_0x4eb460(0xd2)]===_0x4eb460(0xc7)&&await updateDoc(_0x35e27b,{'status':_0x4eb460(0xf7),'winner':null});}async function returnToLobby(){const _0x31d9e=_0x46cd4d;if(!isHost||!currentGameId)return;const _0x3b40e7=doc(db,_0x31d9e(0xff),currentGameId);try{await updateDoc(_0x3b40e7,{'status':_0x31d9e(0x87),'players':{},'winner':deleteField(),'sudoku':deleteField(),'puzzles':deleteField(),'startTime':deleteField(),'gameMode':deleteField()}),showView(_0x31d9e(0xad));}catch(_0x6ff562){console[_0x31d9e(0xbb)](_0x31d9e(0xa8),_0x6ff562),toast(_0x31d9e(0x98));}}async function handleJoinGame(){const _0x36e51e=_0x46cd4d,_0x7d2d72=$(_0x36e51e(0x68))[_0x36e51e(0x119)],_0x986b4b=$(_0x36e51e(0x111))[_0x36e51e(0x119)][_0x36e51e(0xb7)]();if(!_0x7d2d72||!_0x986b4b)return toast(_0x36e51e(0x89));currentGameId=_0x7d2d72,currentPlayerName=_0x986b4b;const _0x670dc2=doc(db,_0x36e51e(0xff),currentGameId);try{await runTransaction(db,async _0x3171c1=>{const _0x4d51f4=_0x36e51e,_0xd41ff7=await _0x3171c1['get'](_0x670dc2);if(!_0xd41ff7[_0x4d51f4(0xc4)]())throw new Error(_0x4d51f4(0x97));const _0x444ba6=_0xd41ff7[_0x4d51f4(0x118)]();if(_0x444ba6['status']!==_0x4d51f4(0x87))throw new Error(_0x4d51f4(0x115));let _0xcdfca0=_0x986b4b;_0x444ba6[_0x4d51f4(0x90)]&&_0x444ba6['players'][_0xcdfca0]&&(_0xcdfca0=''+_0x986b4b+rnd(0xa,0x63),toast(_0x4d51f4(0x76)+_0xcdfca0+_0x4d51f4(0x126))),currentPlayerName=_0xcdfca0,_0x3171c1[_0x4d51f4(0xbf)](_0x670dc2,{[_0x4d51f4(0x10b)+_0xcdfca0]:{'joined':!![]}});}),isHost=![],document[_0x36e51e(0xe4)]['classList'][_0x36e51e(0xf1)](_0x36e51e(0x12c)),toast(_0x36e51e(0x112)),listenForGameUpdates(currentGameId);}catch(_0x609ea2){console[_0x36e51e(0xbb)](_0x36e51e(0x13b),_0x609ea2),toast(_0x609ea2['message']);}}function listenForGameUpdates(_0x192637){const _0x232d31=_0x46cd4d;if(unsubscribeGameListener)unsubscribeGameListener();const _0x5d49b8=doc(db,_0x232d31(0xff),_0x192637);unsubscribeGameListener=onSnapshot(_0x5d49b8,_0x2abb9b=>{const _0x35ba9b=_0x232d31;if(!_0x2abb9b[_0x35ba9b(0xc4)]()){toast(_0x35ba9b(0x143));if(unsubscribeGameListener)unsubscribeGameListener();if(unsubscribePlayerStateListener)unsubscribePlayerStateListener();if(unsubscribeAllPlayerStates)unsubscribeAllPlayerStates();timerInterval&&(clearInterval(timerInterval),timerInterval=null);isHost=![],document[_0x35ba9b(0xe4)][_0x35ba9b(0xfb)]['remove'](_0x35ba9b(0x12c)),showView(_0x35ba9b(0x104));return;}const _0x49978e=_0x2abb9b[_0x35ba9b(0x118)]();latestGameData=_0x49978e;const _0x476c21=_0x49978e[_0x35ba9b(0xd2)];previousGameStatus===_0x35ba9b(0xc7)&&_0x476c21!==_0x35ba9b(0xc7)&&isHost&&(unsubscribeAllPlayerStates&&(unsubscribeAllPlayerStates(),unsubscribeAllPlayerStates=null));if(!isHost&&previousGameStatus===_0x35ba9b(0xf7)&&_0x476c21==='lobby'){if(unsubscribeGameListener)unsubscribeGameListener();if(unsubscribePlayerStateListener)unsubscribePlayerStateListener();unsubscribePlayerStateListener=null;if(timerInterval)clearInterval(timerInterval);currentGameId=null,currentPlayerName=null,toast(_0x35ba9b(0xed)),document[_0x35ba9b(0xe4)][_0x35ba9b(0xfb)][_0x35ba9b(0x81)]('player-view'),showView(_0x35ba9b(0x104)),previousGameStatus=null;return;}previousGameStatus=_0x476c21;if(_0x476c21==='lobby'){timerInterval&&(clearInterval(timerInterval),timerInterval=null);if(unsubscribePlayerStateListener)unsubscribePlayerStateListener();unsubscribePlayerStateListener=null;if(isHost)showView('admin-lobby'),renderLobbyPlayers(_0x49978e[_0x35ba9b(0x90)]);else showView(_0x35ba9b(0xeb));}else{if(_0x476c21===_0x35ba9b(0xc7)){startOrUpdateTimer(_0x49978e),showView(_0x35ba9b(0x75));if(isHost){if(!unsubscribeAllPlayerStates){const _0x348168=collection(db,_0x35ba9b(0xff),_0x192637,_0x35ba9b(0x9c));unsubscribeAllPlayerStates=onSnapshot(_0x348168,_0x195d70=>{const _0xf95f38=_0x35ba9b;_0x195d70[_0xf95f38(0x113)][_0xf95f38(0xd0)](_0x4fbbd7=>{const _0x4ebbb5=_0xf95f38;allPlayerStates[_0x4fbbd7['id']]=_0x4fbbd7[_0x4ebbb5(0x118)]();}),renderAdminGameView();});}renderAdminGameView();if(_0x49978e[_0x35ba9b(0x145)][_0x35ba9b(0x82)]===_0x35ba9b(0x123)){const _0x3c49d5=Object['values'](_0x49978e[_0x35ba9b(0x90)]||{});_0x3c49d5[_0x35ba9b(0x12b)]>0x0&&_0x3c49d5['every'](_0x4d952d=>_0x4d952d[_0x35ba9b(0x149)])&&forceEndGame();}}else renderPlayerGameView(_0x49978e),listenForPlayerState(_0x192637,currentPlayerName);}else{if(_0x476c21==='finished'){timerInterval&&(clearInterval(timerInterval),timerInterval=null);if(unsubscribePlayerStateListener)unsubscribePlayerStateListener();renderGameOverView(_0x49978e);}}}});}function listenForPlayerState(_0xe3e7a6,_0x31c29b){const _0x22ae5c=_0x46cd4d;if(unsubscribePlayerStateListener)return;const _0x1857ee=doc(db,'games',_0xe3e7a6,_0x22ae5c(0x9c),_0x31c29b);unsubscribePlayerStateListener=onSnapshot(_0x1857ee,_0x808a2f=>{const _0x5a38bd=_0x22ae5c;if(_0x808a2f[_0x5a38bd(0xc4)]()){const _0x421fda=_0x808a2f['data'](),_0x46ad54=(_0x421fda[_0x5a38bd(0x8e)]||'')[_0x5a38bd(0xfa)](',')[_0x5a38bd(0x78)](_0x1ab8da=>parseInt(_0x1ab8da,0xa)||0x0);hasMistake=!!_0x421fda['hasMistake'],updateBoardFromState(_0x46ad54);}});}function renderLobbyPlayers(_0x4d9ca8){const _0xb594c2=_0x46cd4d,_0x16c2cd=Object['keys'](_0x4d9ca8||{});lobbyPlayerCount[_0xb594c2(0x117)]=_0x16c2cd[_0xb594c2(0x12b)],lobbyPlayerNameList[_0xb594c2(0x6f)]=_0x16c2cd[_0xb594c2(0x12b)]===0x0?_0xb594c2(0x135):_0x16c2cd['map'](_0x3363b4=>_0xb594c2(0x12e)+_0x3363b4+_0xb594c2(0xb8))['join']('');}function startOrUpdateTimer(_0x236598){const _0x513e8e=_0x46cd4d;if(timerInterval)clearInterval(timerInterval);const _0x331dae=_0x236598[_0x513e8e(0x145)]||gameSettings,_0x280102=_0x236598[_0x513e8e(0x13c)]['toMillis']();timerInterval=setInterval(()=>{const _0x1d4126=_0x513e8e,_0x3d6701=Math[_0x1d4126(0x7c)]((Date['now']()-_0x280102)/0x3e8),_0x176d08=_0x331dae[_0x1d4126(0x9b)]-_0x3d6701;if(_0x176d08<=0x0){clearInterval(timerInterval),gameTimerEl[_0x1d4126(0x117)]='เวลา:\x2000:00';if(isHost)forceEndGame();}else{const _0x4d30d9=String(Math[_0x1d4126(0x7c)](_0x176d08/0x3c))[_0x1d4126(0x67)](0x2,'0'),_0x2fc664=String(_0x176d08%0x3c)[_0x1d4126(0x67)](0x2,'0');gameTimerEl['textContent']='เวลา:\x20'+_0x4d30d9+':'+_0x2fc664;}},0x1f4);}function renderAdminGameView(){const _0xd6e0b6=_0x46cd4d,_0x369be2=latestGameData;if(!_0x369be2||!_0x369be2[_0xd6e0b6(0x90)])return;setBoardSize(_0x369be2['gameMode'][_0xd6e0b6(0x65)]),targetNumberDisplay['textContent']=_0xd6e0b6(0x88)+N+'×'+N,$(_0xd6e0b6(0x125))[_0xd6e0b6(0xfb)][_0xd6e0b6(0x81)](_0xd6e0b6(0xfc)),hostControls['classList'][_0xd6e0b6(0x81)](_0xd6e0b6(0xfc));const _0x31b9c9=_0x369be2[_0xd6e0b6(0x90)]||{},_0x524aa4=Object[_0xd6e0b6(0xd1)](_0x31b9c9)[_0xd6e0b6(0x77)]((_0xb28ecf,_0x1f1c66)=>{const _0x23db6c=_0xd6e0b6,_0x4e733b=_0xb28ecf[0x1],_0xecf37c=_0x1f1c66[0x1];if((_0x4e733b['finishTime']?0x1:0x0)!==(_0xecf37c[_0x23db6c(0x149)]?0x1:0x0))return(_0xecf37c[_0x23db6c(0x149)]?0x1:0x0)-(_0x4e733b[_0x23db6c(0x149)]?0x1:0x0);if((_0x4e733b['score']||0x0)!==(_0xecf37c[_0x23db6c(0x101)]||0x0))return(_0xecf37c[_0x23db6c(0x101)]||0x0)-(_0x4e733b['score']||0x0);const _0x8c40c0=(allPlayerStates?.[_0xb28ecf[0x0]]?.[_0x23db6c(0x8e)]||'')[_0x23db6c(0xfa)](',')[_0x23db6c(0x6c)](_0x500805=>_0x500805!=='0')['length'],_0x2151de=(allPlayerStates?.[_0x1f1c66[0x0]]?.[_0x23db6c(0x8e)]||'')[_0x23db6c(0xfa)](',')[_0x23db6c(0x6c)](_0x90c357=>_0x90c357!=='0')[_0x23db6c(0x12b)];return _0x2151de-_0x8c40c0;});playerList[_0xd6e0b6(0x6f)]=_0x524aa4[_0xd6e0b6(0x78)](([_0x513ac6,_0x572ea7])=>{const _0x51de2d=_0xd6e0b6,_0x33726a=allPlayerStates?.[_0x513ac6]?.[_0x51de2d(0x8e)]||'',_0x2f7f2b=_0x33726a?_0x33726a[_0x51de2d(0xfa)](',')['filter'](_0x2f4096=>_0x2f4096!=='0'&&_0x2f4096!=='')[_0x51de2d(0x12b)]:0x0;let _0x3be3d1=_0x572ea7[_0x51de2d(0x149)]?_0x51de2d(0x7e):_0x2f7f2b+'/'+N*N;return _0x51de2d(0x66)+_0x513ac6+_0x51de2d(0x6d)+(_0x572ea7[_0x51de2d(0x101)]||0x0)+_0x51de2d(0x11b)+_0x3be3d1+_0x51de2d(0x6a);})[_0xd6e0b6(0x141)]('');const _0x5f2047=_0x369be2[_0xd6e0b6(0x142)];if(!_0x5f2047)return;given=(_0x5f2047[_0xd6e0b6(0xc6)]||[])[_0xd6e0b6(0x10c)](),board=given['slice'](),solution=(_0x5f2047[_0xd6e0b6(0xdc)]||[])[_0xd6e0b6(0x10c)](),selectedIdx=-0x1,renderSudoku(),$$(_0xd6e0b6(0xa0))[_0xd6e0b6(0xd0)](_0x4220ea=>_0x4220ea['style'][_0xd6e0b6(0xb9)]='none'),pickerEl[_0xd6e0b6(0xfb)][_0xd6e0b6(0xf1)]('hidden'),$(_0xd6e0b6(0xd3))['classList'][_0xd6e0b6(0xf1)]('hidden'),$(_0xd6e0b6(0xb3))[_0xd6e0b6(0xfb)]['add'](_0xd6e0b6(0xfc));}function renderPlayerGameView(_0x5b3744){const _0x5040b1=_0x46cd4d;$(_0x5040b1(0x125))[_0x5040b1(0xfb)][_0x5040b1(0xf1)]('hidden');const _0x55f06e=(_0x5b3744[_0x5040b1(0x90)]||{})[currentPlayerName];if(!_0x55f06e)return;setBoardSize(_0x5b3744[_0x5040b1(0x145)][_0x5040b1(0x65)]),targetNumberDisplay[_0x5040b1(0x117)]='Sudoku\x20'+N+'×'+N,playerScoreDisplay[_0x5040b1(0x117)]='คะแนน:\x20'+(_0x55f06e[_0x5040b1(0x101)]||0x0),playerScoreDisplay[_0x5040b1(0xfb)][_0x5040b1(0x81)](_0x5040b1(0xfc));const _0x503d5b=_0x5b3744[_0x5040b1(0x142)];if(!_0x503d5b)return;given=(_0x503d5b[_0x5040b1(0xc6)]||[])[_0x5040b1(0x10c)](),solution=(_0x503d5b[_0x5040b1(0xdc)]||[])[_0x5040b1(0x10c)](),board=given[_0x5040b1(0x10c)](),selectedIdx=board['findIndex']((_0xbfb9ff,_0x495215)=>!given[_0x495215]);if(selectedIdx<0x0)selectedIdx=0x0;_0x55f06e[_0x5040b1(0x149)]?(gameBoard['classList'][_0x5040b1(0xf1)](_0x5040b1(0xfc)),playerFinishedView[_0x5040b1(0xfb)]['remove'](_0x5040b1(0xfc))):(gameBoard[_0x5040b1(0xfb)]['remove'](_0x5040b1(0xfc)),playerFinishedView[_0x5040b1(0xfb)]['add']('hidden'),renderSudoku());}function renderGameOverView(_0x56d2bb){const _0xecc82=_0x46cd4d,_0x2b7c27=_0x56d2bb[_0xecc82(0xf2)],_0x50a3db=$('#results-header');_0x2b7c27?_0x50a3db[_0xecc82(0x6f)]=_0xecc82(0xf4)+_0x2b7c27+'!':_0x50a3db[_0xecc82(0x6f)]=_0xecc82(0xab);const _0x235b21=_0x56d2bb[_0xecc82(0x90)]||{},_0x15349a=Object['entries'](_0x235b21)[_0xecc82(0x77)](([,_0x32eb3a],[,_0x284696])=>{const _0x1bba2a=_0xecc82;if((_0x32eb3a[_0x1bba2a(0x101)]||0x0)!==(_0x284696[_0x1bba2a(0x101)]||0x0))return(_0x284696[_0x1bba2a(0x101)]||0x0)-(_0x32eb3a[_0x1bba2a(0x101)]||0x0);if(_0x284696['finishTime']&&_0x32eb3a[_0x1bba2a(0x149)])return _0x32eb3a[_0x1bba2a(0x149)][_0x1bba2a(0xc0)]()-_0x284696[_0x1bba2a(0x149)][_0x1bba2a(0xc0)]();if(_0x284696[_0x1bba2a(0x149)])return 0x1;if(_0x32eb3a[_0x1bba2a(0x149)])return-0x1;return(_0x284696['filled']||0x0)-(_0x32eb3a[_0x1bba2a(0x8b)]||0x0);});podiumContainer[_0xecc82(0x6f)]='',otherRankingsList[_0xecc82(0x6f)]='';const _0x56301e=_0x15349a[_0xecc82(0x10c)](0x0,0x3),_0x5d19be=_0x15349a[_0xecc82(0x10c)](0x3);_0x56301e[_0xecc82(0xd0)](([_0x1a6f2b,_0x163c80],_0x24b08d)=>{const _0x1adc5f=_0xecc82,_0x184a41=_0x24b08d+0x1,_0x4cb412=document[_0x1adc5f(0xbe)](_0x1adc5f(0x95));_0x4cb412[_0x1adc5f(0xe5)]=_0x1adc5f(0xd6)+_0x184a41,_0x4cb412[_0x1adc5f(0x6f)]=(_0x184a41===0x1&&_0x2b7c27?_0x1adc5f(0x11f):'')+_0x1adc5f(0xcb)+_0x1a6f2b+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22player-score\x22>'+(_0x163c80[_0x1adc5f(0x101)]||0x0)+'\x20คะแนน</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22rank\x22>'+_0x184a41+_0x1adc5f(0xb8),podiumContainer[_0x1adc5f(0xe8)](_0x4cb412);});for(let _0x3d070d=_0x15349a[_0xecc82(0x12b)];_0x3d070d<0x3;_0x3d070d++){const _0x433fbb=_0x3d070d+0x1,_0x3398cd=document[_0xecc82(0xbe)]('div');_0x3398cd[_0xecc82(0xe5)]=_0xecc82(0xd6)+_0x433fbb,podiumContainer[_0xecc82(0xe8)](_0x3398cd);}if(_0x5d19be[_0xecc82(0x12b)]>0x0)otherRankingsContainer[_0xecc82(0xfb)][_0xecc82(0x81)](_0xecc82(0xfc)),otherRankingsList[_0xecc82(0x6f)]=_0x5d19be[_0xecc82(0x78)](([_0x39ea00,_0x5ba8fb],_0x4710b7)=>'<li><span>'+(_0x4710b7+0x4)+'.\x20'+_0x39ea00+_0xecc82(0xcc)+(_0x5ba8fb[_0xecc82(0x101)]||0x0)+_0xecc82(0xe9))[_0xecc82(0x141)]('');else otherRankingsContainer[_0xecc82(0xfb)]['add'](_0xecc82(0xfc));if(isHost)$(_0xecc82(0x6b))[_0xecc82(0xfb)][_0xecc82(0x81)](_0xecc82(0xfc));else $(_0xecc82(0x6b))['classList']['add'](_0xecc82(0xfc));showView(_0xecc82(0xda));}function renderPracticeGameOverView(){const _0x53fa62=_0x46cd4d,_0x1edb22=gameTimerEl[_0x53fa62(0x117)][_0x53fa62(0xca)](_0x53fa62(0x129),''),_0x5614a8=_0x1edb22[_0x53fa62(0xfa)](':'),_0x56e93d=parseInt(_0x5614a8[0x0],0xa)*0x3c+parseInt(_0x5614a8[0x1],0xa),_0x16cc1d=gameSettings[_0x53fa62(0x9b)]-_0x56e93d,_0x2f4769=String(Math[_0x53fa62(0x7c)](_0x16cc1d/0x3c))['padStart'](0x2,'0'),_0x20bb4d=String(_0x16cc1d%0x3c)[_0x53fa62(0x67)](0x2,'0'),_0x105ca0=_0x2f4769+':'+_0x20bb4d;resultsHeader['innerHTML']=_0x53fa62(0xf3),podiumContainer[_0x53fa62(0x6f)]=_0x53fa62(0xc1)+N+'×'+N+'</strong></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>ความยาก:\x20<strong\x20class=\x22text-xl\x22\x20style=\x22color:\x20var(--accent);\x22>'+gameSettings[_0x53fa62(0x139)]+_0x53fa62(0xf6)+_0x105ca0+'</strong></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',otherRankingsContainer['classList']['add']('hidden');const _0x29620e=$('#back-to-lobby-btn');_0x29620e[_0x53fa62(0x117)]=_0x53fa62(0x7b),_0x29620e['classList']['remove'](_0x53fa62(0xfc)),_0x29620e[_0x53fa62(0xb4)]=()=>$(_0x53fa62(0xb3))[_0x53fa62(0x8a)](),showView('game-over');}let syncTimer=null;function scheduleBoardSync(){if(isPracticeMode||!currentGameId||!currentPlayerName)return;if(syncTimer)clearTimeout(syncTimer);syncTimer=setTimeout(async()=>{const _0x1009a1=_0x9007;try{const _0x2cd51c=doc(db,_0x1009a1(0xff),currentGameId,_0x1009a1(0x9c),currentPlayerName);await updateDoc(_0x2cd51c,{'board':board[_0x1009a1(0x141)](','),'hasMistake':hasMistake});}catch(_0x34a099){console[_0x1009a1(0xf5)](_0x1009a1(0xe2),_0x34a099);}},0x12c);}async function tryFinish(){const _0xf857b7=_0x46cd4d;if(!isSolved())return;if(isPracticeMode){if(timerInterval)clearInterval(timerInterval);const _0x1d86e8=gameTimerEl[_0xf857b7(0x117)][_0xf857b7(0xca)](_0xf857b7(0x129),''),_0x41d90a=_0x1d86e8['split'](':'),_0x5939f4=parseInt(_0x41d90a[0x0],0xa)*0x3c+parseInt(_0x41d90a[0x1],0xa),_0x4f6d9f=0x64+_0x5939f4+(hasMistake?0x0:0x32);gameBoard[_0xf857b7(0xfb)]['add'](_0xf857b7(0xfc)),playerFinishedView[_0xf857b7(0xfb)][_0xf857b7(0x81)](_0xf857b7(0xfc)),$(_0xf857b7(0x9f))[_0xf857b7(0x117)]=_0xf857b7(0x148),$(_0xf857b7(0x73))['textContent']=_0xf857b7(0xe1),$(_0xf857b7(0x69))[_0xf857b7(0x6f)]=_0xf857b7(0x8d)+_0x4f6d9f+_0xf857b7(0xb8),setTimeout(renderPracticeGameOverView,0x7d0);return;}if(syncTimer)clearTimeout(syncTimer);const _0x14b409=doc(db,_0xf857b7(0xff),currentGameId);try{await runTransaction(db,async _0x2f676d=>{const _0x484773=_0xf857b7,_0x399121=await _0x2f676d[_0x484773(0x99)](_0x14b409);if(!_0x399121['exists']())throw new Error(_0x484773(0x102));const _0x66ca0c=_0x399121[_0x484773(0x118)]();if(_0x66ca0c[_0x484773(0xd2)]!==_0x484773(0xc7))return;const _0x4f77bd=(_0x66ca0c['players']||{})[currentPlayerName];if(!_0x4f77bd||_0x4f77bd[_0x484773(0x149)])return;const _0xd2c742=_0x66ca0c[_0x484773(0x13c)]['toMillis'](),_0x35827f=Math[_0x484773(0x7c)]((Date[_0x484773(0xd8)]()-_0xd2c742)/0x3e8),_0x15db17=Math['max'](0x0,_0x66ca0c[_0x484773(0x145)]['timeLimit']-_0x35827f),_0x192a86=0x64+_0x15db17+(hasMistake?0x0:0x32),_0xbf9930={};_0xbf9930[_0x484773(0x10b)+currentPlayerName+_0x484773(0x132)]=increment(_0x192a86),_0xbf9930[_0x484773(0x10b)+currentPlayerName+'.finishTime']=serverTimestamp(),_0x66ca0c[_0x484773(0x145)]['resultDisplayMode']===_0x484773(0xb0)&&(_0xbf9930[_0x484773(0xd2)]=_0x484773(0xf7),_0xbf9930[_0x484773(0xf2)]=currentPlayerName),_0x2f676d[_0x484773(0xbf)](_0x14b409,_0xbf9930);});}catch(_0x32d265){_0x32d265[_0xf857b7(0xfe)][_0xf857b7(0xd4)](_0xf857b7(0x10f))?toast(_0xf857b7(0xf9)):(console[_0xf857b7(0xbb)]('Finish\x20attempt\x20failed:',_0x32d265),toast('เกิดข้อผิดพลาดในการจบเกม'));}}function _0x695b(){const _0x641e46=['<i\x20class=\x22fas\x20fa-crown\x20mr-2\x22></i>ผู้ชนะคือ\x20','warn','</strong></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>เวลาที่ใช้:\x20<strong\x20class=\x22text-xl\x22\x20style=\x22color:\x20var(--accent);\x22>','finished','show','เกมจบแล้ว\x20มีผู้ชนะแล้ว!','split','classList','hidden','#podium-container','message','games','#end-game-btn','score','Game\x20not\x20found','toggle','player-join','button','989271279576','#board-size-select','หมดเวลา!','#admin-settings-modal','#host-controls','players.','slice','8989','querySelector','aborted','toString','#player-name-input','เข้าร่วมสำเร็จ!\x20รอสักครู่...','docs','idx','ไม่สามารถเข้าร่วมได้\x20เกมเริ่มไปแล้ว','#player-score-display','textContent','data','value','keys','\x20คะแนน\x20(','addEventListener','#other-rankings-container','22590iSNyrW','<i\x20class=\x22fas\x20fa-crown\x22></i>','ArrowRight','data-theme','[data-idx=\x22','wait','admin-settings','#toggle-sidebar-btn','\x20แทน','13805SEDIIi','#lobby-player-count','เวลา:\x20','#puzzle-progress','length','player-view','...','<div\x20class=\x22lobby-player-tag\x22>','#admin-back-btn','ArrowUp','ArrowDown','.score','querySelectorAll','#game-timer','<p\x20class=\x22text-gray-500\x20text-center\x20w-full\x22>ยังไม่มีใครเข้าร่วม...</p>','.cell','#time-limit-input','1816QSYKYM','difficulty','Firebase\x20init\x20failed:','Error\x20joining\x20game:','startTime','currentUser','Game\x20does\x20not\x20exist!','change','push','join','sudoku','ห้องเกมถูกปิดแล้ว','setAttribute','gameMode','random','admin-login','เยี่ยมมาก!','finishTime','รหัสผ่านไม่ถูกต้อง','boardSize','<div\x20class=\x22player-row\x22><span\x20class=\x22player-name\x22>','padStart','#game-code-input','#practice-score-display',')</span></div>','#back-to-lobby-btn','filter','</span><span\x20class=\x22player-progress\x22>','#start-practice-btn','innerHTML','uid','291948hHxwcW','60htBTOj','#player-finished-view\x20p','#admin-lobby-view','game','ชื่อซ้ำ,\x20เปลี่ยนเป็น\x20','sort','map','#open-settings-btn','AIzaSyAJsk4l8I8uCYpJY8jZLAlRW1w2qLWN-2o','กลับไปหน้าแรก','floor','key','เสร็จแล้ว','setItem','max','remove','resultDisplayMode','documentElement','#difficulty-select','keydown','given','lobby','Sudoku\x20','กรุณากรอกข้อมูลให้ครบถ้วน','click','filled','#join-game-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22text-lg\x20mt-4\x22>คะแนนรอบนี้:</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22text-4xl\x20font-bold\x22\x20style=\x22color:\x20var(--accent);\x22>','board','112PYSpxM','players','gridTemplateColumns','selected','#player-join-view','323RlpWdJ','div','#other-rankings-list','ไม่พบห้องเกมนี้','เกิดข้อผิดพลาดในการกลับสู่ล็อบบี้','get','min','timeLimit','playerStates','#toast','3133144TqAKDY','#player-finished-view\x20h2','#sudoku\x20.cell','#admin-login-btn','repeat(','#lobby-player-name-list','medium','1:989271279576:web:43115bbaeeae31160954ad','board-size-','.app','Error\x20returning\x20to\x20lobby:','#game-over-view','#game-code-display','<i\x20class=\x22fas\x20fa-trophy\x20mr-2\x22></i>หมดเวลา!','#sudoku','admin-lobby','pick\x20erase','ArrowLeft','immediate','#start-game-btn','.pick','#home-btn','onclick','#competition-settings','has','trim','</div>','pointerEvents','893550CyckyQ','error','229085dIeSxy','รอผลการแข่งขันสักครู่...','createElement','update','toMillis','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22text-center\x20text-lg\x20space-y-4\x20my-8\x20p-6\x20rounded-lg\x22\x20style=\x22background:\x20var(--card-bg);\x20border:\x202px\x20solid\x20var(--card-border);\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>ขนาด:\x20<strong\x20class=\x22text-xl\x22\x20style=\x22color:\x20var(--accent);\x22>','cell','board-size-6','exists','findIndex','puzzle','playing','fill','3153789STKBGP','replace','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22player-name\x22>','</span><span>','ฝึกซ้อม\x20','เกิดข้อผิดพลาดในการเริ่มเกม','closest','forEach','entries','status','#reset-btn','includes',',\x201fr)','podium-stand\x20podium-','target','now','#player-finished-view','game-over','<i\x20class=\x22fa-solid\x20fa-eraser\x22></i>','solution','dataset','#player-list','เติมแล้ว\x20','G-B1ZTE90SGG','คุณไขปริศนาสำเร็จ','board\x20sync\x20failed','style','body','className','ลองใหม่อีกครั้งนะ','game24-69666','appendChild','\x20คะแนน</span></li>','#admin-password-input','player-wait','#admin-login-modal','แอดมินได้สร้างห้องใหม่แล้ว','input[name=\x22resultDisplayMode\x22]:checked','.filled','.finishTime','add','winner','<i\x20class=\x22fas\x20fa-check-circle\x20mr-2\x22></i>ฝึกซ้อมสำเร็จ!'];_0x695b=function(){return _0x641e46;};return _0x695b();}$('#admin-icon-btn')[_0x46cd4d(0x11c)](_0x46cd4d(0x8a),()=>showView('admin-login')),$(_0x46cd4d(0x12f))[_0x46cd4d(0x11c)]('click',()=>showView(_0x46cd4d(0x104))),$(_0x46cd4d(0xa1))['addEventListener']('click',async()=>{const _0x583acf=_0x46cd4d;if($(_0x583acf(0xea))['value']===_0x583acf(0x10d))await createGameRoom();else toast(_0x583acf(0x64));}),$(_0x46cd4d(0x8c))[_0x46cd4d(0x11c)](_0x46cd4d(0x8a),handleJoinGame),$(_0x46cd4d(0x6e))[_0x46cd4d(0x11c)](_0x46cd4d(0x8a),()=>{const _0x2bec0c=_0x46cd4d;isPracticeMode=!![],isHost=!![],showView('admin-settings'),$(_0x2bec0c(0xb5))['classList']['add'](_0x2bec0c(0xfc)),$(_0x2bec0c(0xb1))[_0x2bec0c(0x6f)]='<i\x20class=\x22fas\x20fa-play\x20mr-2\x22></i>เริ่มฝึกซ้อม';}),$(_0x46cd4d(0x79))['addEventListener']('click',()=>{const _0x4d4402=_0x46cd4d;isPracticeMode=![],showView('admin-settings'),$(_0x4d4402(0xb5))[_0x4d4402(0xfb)]['remove'](_0x4d4402(0xfc)),$(_0x4d4402(0xb1))[_0x4d4402(0x6f)]='<i\x20class=\x22fas\x20fa-play\x20mr-2\x22></i>เริ่มแข่งขัน';}),$('#cancel-settings-btn')['addEventListener'](_0x46cd4d(0x8a),()=>{const _0x88d03a=_0x46cd4d;isHost&&!currentGameId&&isPracticeMode?(isPracticeMode=![],isHost=![],showView(_0x88d03a(0x104))):showView('admin-lobby');}),$(_0x46cd4d(0xb1))[_0x46cd4d(0x11c)](_0x46cd4d(0x8a),()=>{isPracticeMode?startPracticeGame():handleStartGame();}),$(_0x46cd4d(0x100))['addEventListener'](_0x46cd4d(0x8a),forceEndGame),$(_0x46cd4d(0x6b))[_0x46cd4d(0x11c)]('click',returnToLobby),$(_0x46cd4d(0xb3))[_0x46cd4d(0x11c)](_0x46cd4d(0x8a),()=>{const _0x50108c=_0x46cd4d;if(unsubscribeGameListener)unsubscribeGameListener();unsubscribePlayerStateListener&&(unsubscribePlayerStateListener(),unsubscribePlayerStateListener=null);if(timerInterval)clearInterval(timerInterval);currentGameId=null,currentPlayerName=null,isHost=![],isPracticeMode=![],practicePuzzles=null,currentPracticeLevel=null,document[_0x50108c(0xe4)][_0x50108c(0xfb)][_0x50108c(0x81)](_0x50108c(0x12c)),showView(_0x50108c(0x104)),$('#player-finished-view\x20h2')[_0x50108c(0x117)]='เสร็จแล้ว!',$(_0x50108c(0x73))['textContent']=_0x50108c(0xbd);}),$(_0x46cd4d(0xd3))[_0x46cd4d(0x11c)](_0x46cd4d(0x8a),()=>{for(let _0x3803db=0x0;_0x3803db<N*N;_0x3803db++)board[_0x3803db]=given[_0x3803db];hasMistake=![],renderSudoku(),scheduleBoardSync();}),sudokuEl[_0x46cd4d(0x11c)](_0x46cd4d(0x8a),_0x1577e9=>{const _0x10175d=_0x46cd4d,_0x14713e=_0x1577e9[_0x10175d(0xd7)]['closest'](_0x10175d(0x136));if(!_0x14713e)return;const _0x178ea4=parseInt(_0x14713e[_0x10175d(0xdd)][_0x10175d(0x114)],0xa);if(!given[_0x178ea4])selectCell(_0x178ea4);}),$(_0x46cd4d(0x125))[_0x46cd4d(0x11c)](_0x46cd4d(0x8a),()=>{const _0x4ec31d=_0x46cd4d;$(_0x4ec31d(0xa7))[_0x4ec31d(0xfb)][_0x4ec31d(0x103)]('sidebar-hidden');});const boardSizeSelect=$(_0x46cd4d(0x107)),difficultySelect=$(_0x46cd4d(0x84)),timeLimitInput=$(_0x46cd4d(0x137));function updateDefaultTime(){const _0x4af139=_0x46cd4d,_0x13eb70=boardSizeSelect[_0x4af139(0x119)],_0xa109e2=difficultySelect[_0x4af139(0x119)];let _0x185bfd=0x3c;const _0x263d36={'4':{'easy':0x2d,'medium':0x3c,'hard':0x5a},'6':{'easy':0x78,'medium':0xb4,'hard':0xf0},'9':{'easy':0x168,'medium':0x258,'hard':0x384}};_0x263d36[_0x13eb70]&&_0x263d36[_0x13eb70][_0xa109e2]&&(_0x185bfd=_0x263d36[_0x13eb70][_0xa109e2]),timeLimitInput[_0x4af139(0x119)]=_0x185bfd;}boardSizeSelect[_0x46cd4d(0x11c)]('change',updateDefaultTime),difficultySelect[_0x46cd4d(0x11c)](_0x46cd4d(0x13f),updateDefaultTime),window['addEventListener']('beforeunload',()=>{isHost&&currentGameId&&deleteDoc(doc(db,'games',currentGameId));}),setBoardSize(0x4),initialize(),showView(_0x46cd4d(0x104));
